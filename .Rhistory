xlab = "x")
ggqqplot(sample)
ggdensity(sample,
main = "Density plot of sample",
xlab = "x")
shapiro.test(sample)
ks.test(sample, "pnorm")
library(MASS)
#create data
y=c(1, 1, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3, 6, 7, 8)
x=c(7, 7, 8, 3, 2, 4, 4, 6, 6, 7, 5, 3, 3, 5, 8)
#fit linear regression model
model <- lm(y~x)
model
boxcox(y ~ x)
(lambda <- bc$x[which.max(bc$y)])
#find optimal lambda for Box-Cox transformation
bc <- boxcox(y ~ x)
bc$x[which.max(bc$y)]
#fit new linear regression model using the Box-Cox transformation
new_model <- lm(((y^lambda-1)/lambda) ~ x)
(lambda <- bc$x[which.max(bc$y)])
#fit new linear regression model using the Box-Cox transformation
new_model <- lm(((y^lambda-1)/lambda) ~ x)
new_model
#define plotting area
op <- par(pty = "s", mfrow = c(1, 2))
#Q-Q plot for original model
qqnorm(model$residuals)
qqline(model$residuals)
#Q-Q plot for Box-Cox transformed model
qqnorm(new_model$residuals)
qqline(new_model$residuals)
#display both Q-Q plots
par(op)
#find optimal lambda for Box-Cox transformation
bc <- boxcox(y ~ x)
#fit new linear regression model using the Box-Cox transformation
(y^lambda-1)/lambda
#create data
y=c(1, 1, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3, 6, 7, 8)
#fit new linear regression model using the Box-Cox transformation
y %>%
ggdensity(main = "Density plot of sample", xlab = "x")
y %>%
ggqqplot()
boxcox(y)
bc <- boxcox(y ~ 1)
bc
bc <- boxcox(y ~ 1)
lambda <- bc$x[which.max(bc$y)]
lambda
y_new <- (y^lambda-1)/lambda
y_new
y_new %>%
ggdensity(main = "Density plot of sample", xlab = "x")
y_new %>%
ggqqplot()
y %>%
ggqqplot()
y_new %>%
ggqqplot()
y_new %>%
ggdensity(main = "Density plot of sample", xlab = "x")
y_new
install.packages("geoR")
library("geoR")
?boxcoxfit
boxcoxfit(y)
lambda
boxcoxfit(y)
boxcoxfit(y)$lambda
boxcoxfit(y)$lambda
lambda <- boxcoxfit(y)$lambda
lambda
lambda <- boxcoxfit(y)$lambda
y_new <- (y^lambda-1)/lambda
library("geoR")
lambda <- boxcoxfit(y)$lambda
y_new <- (y^lambda-1)/lambda
y_new %>%
ggdensity(main = "Density plot of sample", xlab = "x")
y_new <- log(y)
y_new %>%
ggdensity(main = "Density plot of sample", xlab = "x")
y_new %>%
ggqqplot()
lambda <- boxcoxfit(y)$lambda
y_new <- (y^lambda-1)/lambda
#y_new <- log(y)
y_new %>%
ggdensity(main = "Density plot of sample", xlab = "x")
y_new %>%
ggqqplot()
y <- exp(sample)
lambda <- boxcoxfit(y)$lambda
lambda
y_new <- (y^lambda-1)/lambda
#y_new <- log(y)
y_new %>%
ggdensity(main = "Density plot of sample", xlab = "x")
y_new %>%
ggqqplot()
#y_new <- log(y)
y_new %>%
ggdensity(main = "Density plot of sample", xlab = "x")
y
ggdensity(y,main = "Density plot of sample", xlab = "x")
y <- exp(sample)+2
ggdensity(y,main = "Density plot of sample", xlab = "x")
y <- exp(sample)+sample
ggdensity(y,main = "Density plot of sample", xlab = "x")
sample
y <- exp(sample)-sample
ggdensity(y,main = "Density plot of sample", xlab = "x")
lambda <- boxcoxfit(y)$lambda
y_new <- (y^lambda-1)/lambda
#y_new <- log(y)
y_new %>%
ggdensity(main = "Density plot of sample", xlab = "x")
y_new %>%
ggqqplot()
ggdensity(y,main = "Density plot of sample", xlab = "x")
ggqqplot(y)
y <- 1/sample
ggdensity(y,main = "Density plot of sample", xlab = "x")
ggqqplot(y)
y <- 1/(sample+1)
ggdensity(y,main = "Density plot of sample", xlab = "x")
ggqqplot(y)
lambda <- boxcoxfit(y)$lambda
y <- c(1, 1, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3, 6, 7, 8)
ggdensity(y,main = "Density plot of sample", xlab = "x")
ggqqplot(y)
lambda <- boxcoxfit(y)$lambda
y_new <- (y^lambda-1)/lambda
#y_new <- log(y)
y_new %>%
ggdensity(main = "Density plot of sample", xlab = "x")
y_new %>%
ggqqplot()
y <- c(7, 7, 8, 3, 2, 4, 4, 6, 6, 7, 5, 3, 3, 5, 8)
ggdensity(y,main = "Density plot of sample", xlab = "x")
ggqqplot(y)
y <- c(1, 1, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3, 5, 5, 6)
ggdensity(y,main = "Density plot of sample", xlab = "x")
ggqqplot(y)
lambda <- boxcoxfit(y)$lambda
y_new <- (y^lambda-1)/lambda
#y_new <- log(y)
y_new %>%
ggdensity(main = "Density plot of sample", xlab = "x")
y_new %>%
ggqqplot()
y <- c(1, 1, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3, 4, 5, 5)
ggdensity(y,main = "Density plot of sample", xlab = "x")
ggqqplot(y)
lambda <- boxcoxfit(y)$lambda
y_new <- (y^lambda-1)/lambda
#y_new <- log(y)
y_new %>%
ggdensity(main = "Density plot of sample", xlab = "x")
y_new %>%
ggqqplot()
ggqqplot(y)
y <- runif(15,0,1)
ggdensity(y,main = "Density plot of sample", xlab = "x")
ggqqplot(y)
y
y <- runif(15,0,10)
ggdensity(y,main = "Density plot of sample", xlab = "x")
ggqqplot(y)
y <- runif(30,0,10)
ggdensity(y,main = "Density plot of sample", xlab = "x")
ggqqplot(y)
lambda <- boxcoxfit(y)$lambda
y_new <- (y^lambda-1)/lambda
#y_new <- log(y)
y_new %>%
ggdensity(main = "Density plot of sample", xlab = "x")
y_new %>%
ggqqplot()
y <- runif(30,0,10)
library("geoR")
y <- runif(20,0,10)
y <- y/(y+10)
ggdensity(y,main = "Density plot of sample", xlab = "x")
ggqqplot(y)
y
lambda <- boxcoxfit(y)$lambda
y_new <- (y^lambda-1)/lambda
#y_new <- log(y)
y_new %>%
ggdensity(main = "Density plot of sample", xlab = "x")
y_new %>%
ggqqplot()
y <- runif(20,0,10)/(runif(20,0,10)+5)
ggdensity(y,main = "Density plot of sample", xlab = "x")
ggqqplot(y)
lambda <- boxcoxfit(y)$lambda
y_new <- (y^lambda-1)/lambda
#y_new <- log(y)
y_new %>%
ggdensity(main = "Density plot of sample", xlab = "x")
y_new %>%
ggqqplot()
y <- sqrt(runif(20,0,10)+5)
ggdensity(y,main = "Density plot of sample", xlab = "x")
ggqqplot(y)
lambda <- boxcoxfit(y)$lambda
y_new <- (y^lambda-1)/lambda
#y_new <- log(y)
y_new %>%
ggdensity(main = "Density plot of sample", xlab = "x")
y_new %>%
ggqqplot()
y <- sqrt(rnorm(20,0,1)+0.5)
y <- sqrt(rnorm(20,0,1)+10)
ggdensity(y,main = "Density plot of sample", xlab = "x")
ggqqplot(y)
ggdensity(y,main = "Density plot of sample", xlab = "x")
y <- rbinom(n = 20,prob = 0.5)
y <- rbinom(n = 10,prob = 0.5,size = 20)
y
ggdensity(y,main = "Density plot of sample", xlab = "x")
ggqqplot(y)
y <- rbinom(n = 20,prob = 0.5,size = 100)
ggdensity(y,main = "Density plot of sample", xlab = "x")
ggqqplot(y)
y <- rbinom(n = 20,prob = 0.5,size = 1000)
ggdensity(y,main = "Density plot of sample", xlab = "x")
ggqqplot(y)
y <- rbinom(n = 30,prob = 0.5,size = 50)
ggdensity(y,main = "Density plot of sample", xlab = "x")
ggqqplot(y)
y <- rbinom(n = 30,prob = 0.2,size = 50)
ggdensity(y,main = "Density plot of sample", xlab = "x")
ggqqplot(y)
lambda <- boxcoxfit(y)$lambda
y_new <- (y^lambda-1)/lambda
#y_new <- log(y)
y_new %>%
ggdensity(main = "Density plot of sample", xlab = "x")
y_new %>%
ggqqplot()
lambda
y <- rpois(20,0.3)
y
ggdensity(y,main = "Density plot of sample", xlab = "x")
ggqqplot(y)
lambda <- boxcoxfit(y)$lambda
y <- rpois(20,0.3)+1
ggdensity(y,main = "Density plot of sample", xlab = "x")
ggqqplot(y)
lambda <- boxcoxfit(y)$lambda
y_new <- (y^lambda-1)/lambda
lambda
#y_new <- log(y)
y_new %>%
ggdensity(main = "Density plot of sample", xlab = "x")
y_new %>%
ggqqplot()
y <- rpois(20,0.5)+1
y
ggdensity(y,main = "Density plot of sample", xlab = "x")
ggqqplot(y)
lambda <- boxcoxfit(y)$lambda
y_new <- (y^lambda-1)/lambda
#y_new <- log(y)
y_new %>%
ggdensity(main = "Density plot of sample", xlab = "x")
y_new %>%
ggqqplot()
y <- runif(30,100,200)
ggdensity(y,main = "Density plot of sample", xlab = "x")
ggqqplot(y)
ggdensity(y,main = "Density plot of sample", xlab = "x")
ggqqplot(y)
lambda <- boxcoxfit(y)$lambda
lambda
y_new <- (y^lambda-1)/lambda
#y_new <- log(y)
y_new %>%
ggdensity(main = "Density plot of sample", xlab = "x")
y_new %>%
ggqqplot()
ggdensity(y,main = "Density plot of sample", xlab = "x")
y_new %>%
ggdensity(main = "Density plot of sample", xlab = "x")
y <- log(runif(30,100,200))
ggdensity(y,main = "Density plot of sample", xlab = "x")
ggqqplot(y)
lambda <- boxcoxfit(y)$lambda
y_new <- (y^lambda-1)/lambda
#y_new <- log(y)
y_new %>%
ggdensity(main = "Density plot of sample", xlab = "x")
y_new %>%
ggqqplot()
lambda
y <- log(runif(30,100,200)*runif(30,100,200))
ggdensity(y,main = "Density plot of sample", xlab = "x")
ggqqplot(y)
lambda <- boxcoxfit(y)$lambda
y_new <- (y^lambda-1)/lambda
#y_new <- log(y)
y_new %>%
ggdensity(main = "Density plot of sample", xlab = "x")
y_new %>%
ggqqplot()
y <- exp(runif(30,0,1))
ggdensity(y,main = "Density plot of sample", xlab = "x")
ggqqplot(y)
lambda <- boxcoxfit(y)$lambda
y_new <- (y^lambda-1)/lambda
#y_new <- log(y)
y_new %>%
ggdensity(main = "Density plot of sample", xlab = "x")
y_new %>%
ggqqplot()
lambda
y <- exp(runif(30,0,1)+runif(30,0,1))
ggdensity(y,main = "Density plot of sample", xlab = "x")
ggqqplot(y)
lambda <- boxcoxfit(y)$lambda
y_new <- (y^lambda-1)/lambda
#y_new <- log(y)
y_new %>%
ggdensity(main = "Density plot of sample", xlab = "x")
y_new %>%
ggqqplot()
y <- exp(runif(30,0,1)+runif(30,0,1)++runif(30,0,1))
ggdensity(y,main = "Density plot of sample", xlab = "x")
ggqqplot(y)
lambda <- boxcoxfit(y)$lambda
y_new <- (y^lambda-1)/lambda
#y_new <- log(y)
y_new %>%
ggdensity(main = "Density plot of sample", xlab = "x")
y_new %>%
ggqqplot()
sample1  <- rnorm(20,0,1)
sample2   <- runif(20,0,1)
ggdensity(sample1, main = "Density plot of sample", xlab = "x")
ggdensity(sample2, main = "Density plot of sample", xlab = "x")
sample1  <- rnorm(200,0,1)
sample2  <- runif(200,0,1)
ggdensity(sample1, main = "Density plot of sample", xlab = "x")
ggdensity(sample2, main = "Density plot of sample", xlab = "x")
ggdensity(sample1, main = "Density plot of sample", xlab = "x")
ggdensity(sample2, main = "Density plot of sample", xlab = "x", add=T)
lilliefors()
?lilliefors
??lilliefors
install.packages("nortest")
library("nortest")
x <- c(1202.6, 830.1, 372.4, 345.5, 321.2, 244.3,
163.0, 147.8, 95.0, 87.0, 81.2, 68.5, 47.3,
41.1, 36.6, 29.0, 28.6, 26.3, 26.0, 24.4, 21.4,
17.3, 11.5, 4.9, 4.9, 1.0)
x %>%
ggdensity(main = "Density plot of sample", xlab = "x")
x %>%
ggqqplot()
shapiro_test(x)
shapiro.test(x)
x <- c(1202.6, 830.1, 372.4, 345.5, 321.2, 244.3,
163.0, 147.8, 95.0, 87.0, 81.2, 68.5, 47.3,
41.1, 36.6, 29.0, 28.6, 26.3, 26.0, 24.4, 21.4,
17.3, 11.5, 4.9, 4.9, 1.0)
log(x) %>%
ggdensity(main = "Density plot of sample", xlab = "x")
log(x) %>%
ggqqplot()
shapiro.test(log(x))
setwd("D://ese335")
rmarkdown::render_site()
rmarkdown::render_site()
airquality
# Make a vector from -5 to 5, with a step of 0.01
x        <- seq(-5.0, 5.0, by=0.01)
# Compute the density for each element in x
density1 <- dnorm(x, 0, 1)
# Plot Density
plot(x, density1, col="black", xlab="", ylab="Density",
type="l", lwd=3, cex=2,
xlim=c(-5.0, 5.0),
main="PDF of normal distributions")
# Make a vector from -5 to 5, with a step of 0.01
x        <- seq(-5.0, 5.0, by=0.01)
# Compute the density for each element in x
density1 <- dnorm(x, 0, 1)
# Plot Density
plot(x, density1, col="black", xlab="", ylab="Density",
type="l", lwd=3, cex=2,
xlim=c(-5.0, 5.0),
main="PDF of normal distributions")
# Compute and plot the density from another normal
density2  <- dnorm(x, 1, 1)
lines(x, density2, col="blue", xlab="", ylab="Density",
type="l", lwd=3, cex=2)
# Compute and plot the density from another normal
density3  <- dnorm(x, 0, 3)
lines(x, density3, col="red", xlab="", ylab="Density",
type="l", lwd=3, cex=2)
# Add legends
text(-4, 0.35, "N(0,1)", col="black",   cex=2)
text(-4, 0.30, "N(1,1)", col="blue",  cex=2)
text(-4, 0.25, "N(0,3)", col="red", cex=2)
# Sample 1 is from a normal distribution
sample1  <- rnorm(200, 0, 1)
sample1
hist(sample1)
# Sample 1 is from a normal distribution
sample1  <- rnorm(200, 0, 1)
hist(sample1)
ggdensity(sample1, main = "Density plot of sample 1",
xlab = "x", color ="blue", lwd=1.5)
# Sample 2 is from a uniform distribution
sample2  <- runif(200, 0, 1)
# Plot density function of sample 1
ggdensity(sample2, main = "Density plot of sample 2",
xlab = "x", color ="blue", lwd=1.5)
# QQ plot of sample1
ggqqplot(sample1)
# QQ plot of sample2
ggqqplot(sample2)
# QQ plot of sample2
ggqqplot(sample2)
# Shapiro-Wilk test of sample 3
shapiro.test(sample3)
# Shapiro-Wilk test of sample 4
shapiro.test(sample4)
# Lilliefors test of sample 1
lillie.test(sample1)
lillie.test(sample2)
sample5  <- exp(rnorm(200, 0, 1))
# Plot density function of sample 1
ggdensity(sample5, main = "Density plot of sample 5",
xlab = "x", color ="blue", lwd=1.5)
sample5  <- exp(rnorm(200, 0, 1))
sample6  <- log(sample5)
# Plot density function of sample 1
ggdensity(sample6, main = "Density plot of sample 6",
xlab = "x", color ="blue", lwd=1.5)
lillie.test(sample6)
boxcoxfit(y)
y
boxcoxfit(y+10)
boxcoxfit(y+10)$lambda
S1 <- c(0.6, -1.0, -0.5, 0.9, -0.4, 0.9,
0.6, -0.2, 0.1, 0.7, 0.4, -0.5,
1.2, 0.1, 0.6, -1.3, 0.9, 1.1, 0.2, 0.1)
ggdensity(S1, main = "Density plot of S1",
xlab = "x", color ="blue", lwd=1.5)
ggqqplot(S1)
shapiro.test(S1)
ggdensity(S2, main = "Density plot of S2",
xlab = "x", color ="blue", lwd=1.5)
ggqqplot(S2)
S2 <- c(1202.6, 830.1, 372.4, 345.5, 321.2, 244.3,
163.0, 147.8, 95.0, 87.0,
81.2, 68.5, 47.3, 41.1, 36.6, 29.0, 28.6,
26.3, 26.0, 24.4,
21.4, 17.3, 11.5, 4.9, 4.9, 1.0)
ggdensity(S2, main = "Density plot of S2",
xlab = "x", color ="blue", lwd=1.5)
ggqqplot(S2)
# Make a log transformation
S2_new <- log(S2)
ggdensity(S2_new, main = "Density plot of S2_new",
xlab = "x", color ="blue", lwd=1.5)
ggqqplot(S2_new)
shapiro.test(S2)
shapiro.test(S2_new)
y <- c(rnorm(10,0,1), rnorm(10,10,1))
ggdensity(y, main = "Density plot of y",
xlab = "x", color ="blue", lwd=1.5)
ggqqplot(y)
shapiro.test(y)
ggqqplot(y)
ggdensity(y, main = "Density plot of y",
xlab = "x", color ="blue", lwd=1.5)
S1 <- c(0.6, -1.0, -0.5, 0.9, -0.4, 0.9,
0.6, -0.2, 0.1, 0.7, 0.4, -0.5,
1.2, 0.1, 0.6, -1.3, 0.9, 1.1, 0.2, 0.1)
ggdensity(S1, main = "Density plot of S1",
xlab = "x", color ="blue", lwd=1.5)
ggqqplot(S1)
shapiro.test(S1)
# E2
S2 <- c(1202.6, 830.1, 372.4, 345.5, 321.2, 244.3,
163.0, 147.8, 95.0, 87.0,
81.2, 68.5, 47.3, 41.1, 36.6, 29.0, 28.6,
26.3, 26.0, 24.4,
21.4, 17.3, 11.5, 4.9, 4.9, 1.0)
ggdensity(S2, main = "Density plot of S2",
xlab = "x", color ="blue", lwd=1.5)
ggqqplot(S2)
shapiro.test(S2)
# Make a log transformation
S2_new <- log(S2)
ggdensity(S2_new, main = "Density plot of S2_new",
xlab = "x", color ="blue", lwd=1.5)
ggqqplot(S2_new)
shapiro.test(S2_new)
# E4 Generate a sample
y <- c(rnorm(10,0,1), rnorm(10,10,1))
ggdensity(y, main = "Density plot of y",
xlab = "x", color ="blue", lwd=1.5)
ggqqplot(y)
shapiro.test(y)

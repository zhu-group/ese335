250/375*700+350/750*300
250/375*700+350/750*300
7665*12
7665*13
5509+489
(44-72)/72
(167-139)/139
52*(1+3.8/12)+6+32
library(ggpubr)
library(nortest)
library(ggplot2)
# PM2.5 in 2019 Feb.
PM2.5_2019  <- c(53, 41, 26, 19, 26, 48, 64, 46, 42, 65, 53, 81, 51, 32, 44)
# PM2.5 in 2020 Feb.
PM2.5_2020  <- c(63, 33, 24, 19, 33, 49, 38, 28, 41, 36, 41, 43, 43, 23, 35)
# Sample difference
Diff        <- PM2.5_2020 - PM2.5_2019
# Get sample size, degrees of freedom, and sd
n           <- length(Diff)
df          <- n - 1
sd          <- sd(Diff)
# Make data frame
PM2.5_data <- data.frame(PM2.5 = c(PM2.5_2019, PM2.5_2020),
Year = c(rep("2019-02",n),rep("2020-02",n)))
# Compare boxplots
PM2.5_data %>%
ggplot(aes(x=as.character(Year), y=PM2.5)) +
geom_boxplot(fill="steelblue") +
labs(title="PM2.5 Distribution by Year", x="Year", y="ug/m3")
ggqqplot(Diff)
# Check normality, Shapiro-Wilk test
shapiro.test(Diff)
# Check normality, Shapiro-Wilk test
shapiro.test(Diff)
# SE of the difference
SE          <- sd/sqrt(n)
# Get t-ratio
t           <- mean(Diff)/SE
t
P_value     <- (1-pt(abs(t), df=df))*2
print(P_value)
##
t.test(PM2.5_2020, PM2.5_2019, alternative ="two-sided", paired = T)
##
t.test(PM2.5_2020, PM2.5_2019, alternative ="two.sided", paired = T)
# Make a vector from -5 to 5, with a step of 0.01
x        <- seq(-5.0, 5.0, by=0.01)
# Compute the density for each element in x
# Set the degrees of freedom to be 14
density <- dt(x, df=14)
# Plot Density
plot(x, density, col="black", xlab="", ylab="Density",
type="l", lwd=3, cex=2,
xlim=c(-5.0, 5.0),
main="PDF of t (d.f. = 14) distribution")
# Get the 2.5th percentile
p_2.5th  <- qt(0.025,df=14)
# Get the 97.5th percentile
p_97.5th <- qt(0.975,df=14)
# Add vertical lines
abline(v=p_2.5th,  col="red", lwd=2, lty=2)
text(p_2.5th-1, 0.1, as.character(round(p_2.5th,2)), col="red", cex=1.5)
abline(v=p_97.5th, col="red", lwd=2, lty=2)
text(p_97.5th+1, 0.1, as.character(round(p_97.5th,2)), col="red", cex=1.5)
# Get the 2.5th percentile
p_2.5th  <- qt(0.025,df=14)
# Get the 97.5th percentile
p_97.5th <- qt(0.975,df=14)
?t.test()
#--------------
# EX1
#--------------
B_R <- c(51, 48, 52, 62, 64, 51, 55, 60)
A_R <- c(46, 45, 53, 48, 57, 55, 42, 50)
# Since the observations are form the same sites,
# this is the classic paired sample t-test
# H0: mu_D = 0
# The question is to examine whether the regulation
# reduces noise level, so we should use the one-sided p-value
# Check normal
shapiro.test(A_R-B_R)
t.test(A_R, B_R, alternative = "less", paired = T)
CO2_RS <- c(415, 385, 378, 398, 413, 359, 391, 410, 390, 402)
CO2_IS <- c(412, 361, 401, 432, 413, 385, 378, 412, 420, 400)
# Since the observations are form the same population
# we want to test the observations from two different methods
# It's paired sample t-test
# Check normal
shapiro.test(CO2_RS - CO2_IS)
t.test(CO2_RS, CO2_IS, alternative = "two.sided", paired = T)
#--------------
# EX1
#--------------
B_R <- c(51, 48, 52, 62, 64, 51, 55, 60)
A_R <- c(46, 45, 53, 48, 57, 55, 42, 50)
# Since the observations are form the same sites,
# this is the classic paired sample t-test
# H0: mu_D = 0
# The question is to examine whether the regulation
# reduces noise level, so we should use the one-sided p-value
# Check normal
shapiro.test(A_R-B_R)
t.test(A_R, B_R, alternative = "less", paired = T)
#--------------
# EX2
#--------------
CO2_RS <- c(415, 385, 378, 398, 413, 359, 391, 410, 390, 402)
CO2_IS <- c(412, 361, 401, 432, 413, 385, 378, 412, 420, 400)
# Since the observations are form the same population
# we want to test the observations from two different methods
# It's paired sample t-test
# Check normal
shapiro.test(CO2_RS - CO2_IS)
t.test(CO2_RS, CO2_IS, alternative = "two.sided", paired = T)
100*10*12
12*2000*1024/100
12*200*1024/100
T    <- rnorm(100, 280, 5)
HCHO <- exp(0.02*T-4)
plot(T, HCHO, type="l")
plot(T, HCHO, type="o")
T    <- rnorm(100, 280, 5)
HCHO <- exp(0.02*T-4)
HCHO
plot(T, HCHO, type="p")
T    <- rnorm(100, 280, 5)
HCHO <- exp(0.2*T-4)
plot(T, HCHO, type="p")
T    <- rnorm(100, 280, 5)
HCHO <- exp(0.2*T-4)*runif(100,0.95,1.05)
plot(T, HCHO, type="p")
T    <- rnorm(100, 280, 5)
HCHO <- exp(0.2*T-4)*runif(100,0.95,1.05)
plot(T, HCHO, type="p")
HCHO_ave <- mean(HCHO)
T_ave <- mean(T)
delta_HCHO <- HCHO/HCHO_ave
delta_T <- T- T_ave
plot(delta_T, log(delta_HCHO))
abline(h=0)
abline(v=0)
T    <- rnorm(100, 280, 5)
HCHO <- exp(0.2*T-4)
plot(T, HCHO, type="p")
HCHO_ave <- mean(HCHO)
T_ave <- mean(T)
delta_HCHO <- HCHO/HCHO_ave
delta_T <- T- T_ave
plot(delta_T, log(delta_HCHO))
abline(h=0)
abline(v=0)
T    <- rnorm(100, 280, 5)
HCHO <- exp(0.20*T-4)*runif(100,0.95,1.05)
plot(T, HCHO, type="p")
HCHO_ave <- mean(HCHO)
T_ave <- mean(T)
delta_HCHO <- HCHO/HCHO_ave
delta_T <- T- T_ave
plot(delta_T, log(delta_HCHO))
abline(h=0)
abline(v=0)
T    <- rnorm(100, 280, 5)
HCHO <- exp(0.02*T-4)*runif(100,0.95,1.05)
plot(T, HCHO, type="p")
HCHO_ave <- mean(HCHO)
T_ave <- mean(T)
delta_HCHO <- HCHO/HCHO_ave
delta_T <- T- T_ave
plot(delta_T, log(delta_HCHO))
abline(h=0)
abline(v=0)
T    <- rnorm(100, 280, 5)
HCHO <- exp(0.02*T-4)
plot(T, HCHO, type="p")
HCHO_ave <- mean(HCHO)
T_ave <- mean(T)
delta_HCHO <- HCHO/HCHO_ave
delta_T <- T- T_ave
plot(delta_T, log(delta_HCHO))
abline(h=0)
abline(v=0)
T    <- rnorm(100, 280, 5)
HCHO <- exp(0.02*T-4)
plot(T, HCHO, type="p")
HCHO_ave <- mean(HCHO)
T_ave <- mean(T)
delta_HCHO <- HCHO/HCHO_ave
delta_T <- T- T_ave
plot(delta_T, log(delta_HCHO))
abline(h=0)
abline(v=0)
T    <- rnorm(100, 280, 5)
HCHO <- exp(0.02*T-4)*runif(100,0.9,1.1)
plot(T, HCHO, type="p")
HCHO_ave <- mean(HCHO)
T_ave <- mean(T)
delta_HCHO <- HCHO/HCHO_ave
delta_T <- T- T_ave
plot(delta_T, log(delta_HCHO))
abline(h=0)
abline(v=0)
T    <- rnorm(100, 280, 5)
HCHO <- exp(0.2*T-4)
plot(T, HCHO, type="p")
HCHO_ave <- mean(HCHO)
T_ave <- mean(T)
delta_HCHO <- HCHO/HCHO_ave
delta_T <- T- T_ave
plot(delta_T, log(delta_HCHO))
abline(h=0)
abline(v=0)
lm <- reg(log(delta_HCHO) ~ delta_T)
summary(lm)
T    <- rnorm(100, 280, 5)
HCHO <- exp(0.2*T-4)
plot(T, HCHO, type="p")
HCHO_ave <- mean(HCHO)
T_ave <- mean(T)
delta_HCHO <- HCHO/HCHO_ave
delta_T <- T- T_ave
plot(delta_T, log(delta_HCHO))
abline(h=0)
abline(v=0)
reg <- lm(log(delta_HCHO) ~ delta_T)
summary(lm)
reg
summary(reg)
delta_T
T    <- rnorm(100, 280, 5)
HCHO <- exp(0.02*T-4)
plot(T, HCHO, type="p")
HCHO_ave <- mean(HCHO)
T_ave <- mean(T)
delta_HCHO <- HCHO/HCHO_ave
delta_T     <- T- T_ave
plot(delta_T, log(delta_HCHO))
abline(h=0)
abline(v=0)
reg <- lm(log(delta_HCHO) ~ delta_T)
summary(reg)
T    <- rnorm(100, 280, 5)
HCHO <- exp(2*T-4)
plot(T, HCHO, type="p")
HCHO_ave <- mean(HCHO)
T_ave <- mean(T)
delta_HCHO <- HCHO/HCHO_ave
delta_T     <- T- T_ave
plot(delta_T, log(delta_HCHO))
abline(h=0)
abline(v=0)
reg <- lm(log(delta_HCHO) ~ delta_T)
summary(reg)
T    <- rnorm(100, 280, 5)
HCHO <- exp(0.8*T-4)
plot(T, HCHO, type="p")
HCHO_ave <- mean(HCHO)
T_ave <- mean(T)
delta_HCHO <- HCHO/HCHO_ave
delta_T     <- T- T_ave
plot(delta_T, log(delta_HCHO))
abline(h=0)
abline(v=0)
reg <- lm(log(delta_HCHO) ~ delta_T)
summary(reg)
T    <- rnorm(100, 280, 5)
HCHO <- exp(0.02*T-4)
plot(T, HCHO, type="p")
HCHO_ave <- mean(HCHO)
T_ave <- mean(T)
delta_log_HCHO <- log(HCHO)-mean(log(HCHO))
delta_T     <- T- T_ave
plot(delta_T, delta_log_HCHO)
abline(h=0)
abline(v=0)
reg <- lm(delta_log_HCHO ~ delta_T)
summary(reg)
T    <- rnorm(100, 280, 5)
HCHO <- exp(0.2*T-4)
plot(T, HCHO, type="p")
HCHO_ave <- mean(HCHO)
T_ave <- mean(T)
delta_log_HCHO <- log(HCHO)-mean(log(HCHO))
delta_T     <- T- T_ave
plot(delta_T, delta_log_HCHO)
abline(h=0)
abline(v=0)
reg <- lm(delta_log_HCHO ~ delta_T)
summary(reg)
HCHO <- exp(0.2*T-4)*runif(100,0.9,1.2)
HCHO
T    <- rnorm(100, 280, 5)
HCHO <- exp(0.2*T-4)*runif(100,0.9,1.2)
plot(T, HCHO)
reg <- lm(log(HCHO) ~ T)
summary(reg)
plot(T, HCHO, type="p")
HCHO_ave <- mean(HCHO)
T_ave <- mean(T)
delta_log_HCHO <- log(HCHO)-mean(log(HCHO))
delta_T     <- T- T_ave
plot(delta_T, delta_log_HCHO)
abline(h=0)
abline(v=0)
reg <- lm(delta_log_HCHO ~ delta_T)
summary(reg)
T    <- rnorm(100, 280, 5)
HCHO <- exp(0.2*T-4)*runif(100,0.8,1.3)
plot(T, HCHO)
reg <- lm(log(HCHO) ~ T)
summary(reg)
T    <- rnorm(100, 280, 5)
HCHO <- exp(0.02*T-4)*runif(100,0.8,1.3)
plot(T, HCHO)
reg <- lm(log(HCHO) ~ T)
summary(reg)
plot(T, HCHO, type="p")
HCHO_ave <- mean(HCHO)
T_ave <- mean(T)
delta_log_HCHO <- log(HCHO)-mean(log(HCHO))
delta_T     <- T- T_ave
plot(delta_T, delta_log_HCHO)
abline(h=0)
abline(v=0)
reg <- lm(delta_log_HCHO ~ delta_T)
summary(reg)
plot(T, HCHO, type="p")
(283)^2.03*exp(636/283)/(413)^2.03*exp(636/413)
(283)^2.03*exp(636/283)/((413)^2.03*exp(636/413))
exp(0.11*303)/exp(0.11*302)
1/(283)^2.03*exp(636/283)/((413)^2.03*exp(636/413))
1/0.9418181
log(0.9)
T <- rnorm(100, 20, 30)
HCHO <- 1.5E16 + 9.0E14*T
plot(T, HCHO)
plot(T, log(HCHO))
HCHO
T
T <- runif(100, 20, 30)
HCHO <- 1.5E16 + 9.0E14*T
plot(T, HCHO)
plot(T, log(HCHO))
reg <- lm(log(HCHO) ~ T)
summary(reg)
1.88e-17*8.85e-12*1e-6^2*300e3
3*pi*6/8*8.85e-12*1e-12*300*1e3
3*pi*6/8*8.85e-2*1.0e-12*300*1e3
1/1.6022e-19
3*pi*6/8*8.85e-2*1.0e-12*300*1e3*1/1.6022e-19
3*pi*6/8*8.85e-12*1.0e-12*300*1e3*1/1.6022e-19
log(0.1)/log(0.01)
500*50*12/1e4
400*50*12/1e4
350*50*12/1e4
300*50*12/1e4
300*55*12/1e4
2500*2*4*2
300*60*12/1e4
300*750*12/1e4
300*70*12/1e4
2000*2*4*2
6/8*8.85e-12*10e-6*(300e3)^2*10e-6/1.8e-5
6/8*8.85e-12*10e-6*(300e3)^2/1.8e-5
1-exp(-1*400*0.033/10)
log(1-0.95)/log(1-0.73)
log10
log(10)
log(1-0.95)/log(1-0.73)*400
ln(1-0.99)/ln(1-0.90)
log(1-0.99)/log(1-0.90)
SUSTEch <- c(42.33,39.53,44.23,42.67,40.63,39.30,40.33,38.77)
Otehr <- c(45.33,42.40,44.37,42.70,41.80,39.87,41.07,42.73,39.40,42.13,
38.93,37.70,37.63,36.60,35.73,32.27)
t.test(SUSTEch,Otehr)
t.test(SUSTEch-7,Otehr-7)
52*1.04
55*1.04
52*1.04*1.04*1.04
52*1.04*1.04*1.04*1.04
55*1.04*1.04*1.04*1.04
x <- rnorm(20,0,1)
y <- rnorm(20,0,1)
cor.test(x,y)
cor(x,y)
cor.test(x,y,method=c"pearson")
cor.test(x,y,method="pearson")
x <- rnorm(5,0,1)
y <- rnorm(5,0,1)
cor.test(x,y,method="pearson")
cor(x,y)
x <- rnorm(50,0,1)
y <- rnorm(50,0,1)
cor.test(x,y,method="pearson")
cov(x,y)
x
sum((x-mean(x))*(y-mean(y)))
x <- rnorm(50,0,1)
y <- rnorm(50,0,1)
cor.test(x,y,method="pearson")
cor(x,y)
cov(x,y)
cov
sum((x-mean(x))*(y-mean(y)))
cov(x,y)
cor.test(x,y,method="pearson")
sd(x)
sd(y)
sd(x)*sd(y)
sd(x)*sd(y)*cor(x,y)
cov(x,y)
sum((x-mean(x))*(y-mean(y)))/(50-1)
cov
my_data <- data.frame(x,y)
my_data
my_data <- data.frame(x,y)
library("ggpubr")
ggscatter(my_data, x = "x", y = "y",
add = "reg.line", conf.int = TRUE,
cor.coef = TRUE, cor.method = "pearson",
xlab = "x", ylab = "y")
sr <- sqrt((1-cor(x,y)^2)/(50-2))
t <- cor(x,y)/sr
t
cor.test(x,y,method="pearson")
x <- rnorm(10,0,1)
y <- rnorm(10,0,1)
plot(x,y)
cov(x,y)
plot(2*x,2*y)
cov(2*x,2*y)
x <- rnorm(10,0,1)
y <- 2*x+rnorm(10,0.2,0.5)
plot(2*x,2*y)
cov(2*x,2*y)
x <- rnorm(10,0,1)
y <- 2*x+rnorm(10,0.2,0.5)
par(mrow=c(1,2))
plot(x,y)
plot(2*x,2*y)
par(mfrow=c(1,2))
plot(x,y)
plot(2*x,2*y)
rnorm(10,0,1)
round(rnorm(10,0,1),1)
round(rnorm(10,0,0.5),1)
setwd("D://ese335")
rmarkdown::render_site()
rmarkdown::render_site()
# Make up some random values
x <- rnorm(10,0,1)
y <- 10*x+rnorm(10,0.2,0.5)
# Plot
# 1 row 2 cols plot
par(mfrow=c(1,2))
# Plot original data
plot(x,y)
# Double x and y
plot(2*x,2*y)
cov(x,y)
cov(2x,2y)
cov(2*x,2*y)
cor.test(x, y, method="pearson", alternative="two.sided", conf.level=0.95)
cor.test(x, y)
x <- c(0.1, -1.6, -2.3,  0.1,  0.1,  0.5, -0.3, -0.3, 1.4,  0.3)
y <- 2*x+c(-0.4, -0.4, -0.4,  0.2, -1.6,  0.2,  0.2,  0.6,  0.2, 1.1)
# Add one outlier
x <- c(x, -20)
y <- c(y, 30)
plot(x,y)
cor(x,y)
cor.test(x,y)
# Uncomment the following lines to remove the outlier
x <- x[- 11]
y <- y[- 11]
plot(x,y)
cor(x,y)
cov(x,y)
cor.test(x,y)
# Make up samples
x1 <- c(0.1, -1.6, -2.3,  0.1,  0.1,  0.5, -0.3, -0.3, 1.4,  0.3)
y1 <- 2*x1+c(-0.4, -0.4, -0.4,  0.2, -1.6,  0.2,  0.2,  0.6,  0.2, 1.1)
x2 <- x1-5.0
y2 <- -1.0*y1
x <- c(x1,x2)
y <- c(y1,y2)
plot(x,y)
par(mfrow=c(1,1))
# Make up samples
x1 <- c(0.1, -1.6, -2.3,  0.1,  0.1,  0.5, -0.3, -0.3, 1.4,  0.3)
y1 <- 2*x1+c(-0.4, -0.4, -0.4,  0.2, -1.6,  0.2,  0.2,  0.6,  0.2, 1.1)
x2 <- x1-5.0
y2 <- -1.0*y1
x <- c(x1,x2)
y <- c(y1,y2)
plot(x,y)
TOC <- c(1.59, 1.79, 1.00, 0.45, 3.84, 2.30, 1.00,
3.20, 0.80, 2.20, 3.20, 2.10)
UV <- c(0.144, 0.152, 0.113, 0.025, 0.227, 0.149,
0.014, 0.158, 0.042, 0.154, 0.173, 0.095)
runs.test(TOC)
runs.test(UV)
shapiro.test(TOC)
shapiro.test(UV)
plot(TOC, UV)
cor.test(TOC, UV, alternative = "greater", conf.level = 0.95)
TOC <- c(1.59, 1.79, 1.00, 0.45, 3.84, 2.30, 1.00,
3.20, 0.80, 2.20, 3.20, 2.10)
UV <- c(0.144, 0.152, 0.113, 0.025, 0.227, 0.149,
0.014, 0.158, 0.042, 0.154, 0.173, 0.095)
plot(TOC, UV)
cor(TOC,UV)
rmarkdown::render_site()

0,     1,    0,   0,     1,
0,     0,    1,   0,     0)
PM_data <- cbind(Pop, PM)
PM_data
PM_data <- cbind(Pop, PM)
logistic <- glm( PM ~ Pop, data = PM_data, family = binomial)
summary(logistic)
PM_data <- data.frame(Pop, PM)
PM_data
str(PM_data)
logistic <- glm( PM ~ Pop, data = PM_data, family = binomial)
summary(logistic)
PM_data <- data.frame(Pop, as.factor(PM))
str(PM_data)
logistic <- glm( PM ~ Pop, data = PM_data, family = binomial)
summary(logistic)
round(runif(30,100,9000),0)
# population per km2
Pop <- c(5137, 2095, 6019, 1187, 3498,
7055, 3533, 1595, 6534, 2016,
8848, 6725, 3477, 7931, 6733,
3265, 7264, 6575, 3280, 2240,
7756, 2040, 2840, 6233, 6890,
6381, 6752,  398, 6304, 5811)
PM  <- c( 1,     0,    1,   0,     0,
1,     0,    0,   1,     0,
1,     1,    0,   1,     1,
0,     1,    1,   0,     0,
1,     0,    0,   1,     1,
1,     1,    0,   1,     0)
PM_data <- data.frame(Pop, as.factor(PM))
str(PM_data)
PM_data
str(PM_data)
logistic <- glm( PM ~ Pop, data = PM_data, family = binomial)
summary(logistic)
plot(Pop, PM)
# population per km2
Pop <- c(5137, 2095, 6019, 1187, 3498,
7055, 3533, 1595, 6534, 2016,
8848, 6725, 3477, 7931, 6733,
3265, 7264, 6575, 3280, 2240,
7756, 2040, 2840, 6233, 6890,
6381, 6752,  398, 6304, 5811)
PM  <- c( 1,     0,    1,   0,     0,
1,     0,    0,   0,     0,
1,     1,    0,   1,     1,
0,     1,    1,   0,     0,
1,     0,    0,   1,     1,
1,     1,    0,   1,     1)
PM_data <- data.frame(Pop, as.factor(PM))
str(PM_data)
logistic <- glm( PM ~ Pop, data = PM_data, family = binomial)
summary(logistic)
plot(Pop, PM)
# population per km2
Pop <- c(5137, 2095, 6019, 1187, 3498,
7055, 3533, 1595, 6534, 2016,
8848, 6725, 3477, 7931, 6733,
3265, 7264, 6575, 3280, 2240,
7756, 2040, 2840, 6233, 6890,
6381, 6752,  398, 6304, 5811)
PM  <- c( 1,     0,    1,   0,     0,
1,     0,    0,   0,     0,
1,     1,    0,   1,     1,
0,     1,    1,   0,     0,
1,     0,    0,   1,     1,
0,     1,    0,   1,     1)
PM_data <- data.frame(Pop, as.factor(PM))
str(PM_data)
logistic <- glm( PM ~ Pop, data = PM_data, family = binomial)
summary(logistic)
plot(Pop, PM)
# population per km2
Pop <- c(5137, 2095, 6019, 1187, 3498,
7055, 3533, 1595, 6534, 2016,
8848, 6725, 3477, 7931, 6733,
3265, 7264, 6575, 3280, 2240,
7756, 2040, 2840, 6233, 6890,
6381, 6752,  398, 6304, 5811)
PM  <- c( 1,     0,    1,   0,     0,
1,     0,    0,   0,     0,
1,     1,    0,   1,     1,
0,     1,    1,   0,     0,
1,     0,    0,   1,     1,
0,     0,    0,   1,     1)
PM_data <- data.frame(Pop, as.factor(PM))
str(PM_data)
logistic <- glm( PM ~ Pop, data = PM_data, family = binomial)
summary(logistic)
plot(Pop, PM)
# population per km2
Pop <- c(5137, 2095, 6019, 1187, 3498,
7055, 3533, 1595, 6534, 2016,
8848, 6725, 3477, 7931, 6733,
3265, 7264, 6575, 3280, 2240,
7756, 2040, 2840, 6233, 6890,
6381, 6752,  398, 6304, 5811)
PM  <- c( 1,     0,    1,   0,     0,
1,     0,    0,   0,     0,
1,     1,    1,   1,     1,
0,     1,    1,   0,     0,
1,     0,    0,   1,     1,
0,     0,    0,   1,     1)
PM_data <- data.frame(Pop, as.factor(PM))
str(PM_data)
logistic <- glm( PM ~ Pop, data = PM_data, family = binomial)
summary(logistic)
plot(Pop, PM)
# population per km2
Pop <- c(5137, 2095, 5019, 1187, 3498,
7055, 3533, 1595, 6534, 2016,
8848, 6725, 3477, 7931, 6733,
3265, 7264, 6575, 3280, 2240,
7756, 2040, 2840, 6233, 6890,
6381, 6752,  398, 6304, 5811)
PM  <- c( 1,     0,    0,   0,     0,
1,     0,    0,   0,     0,
1,     1,    1,   1,     1,
0,     1,    1,   0,     0,
1,     0,    0,   1,     1,
0,     0,    0,   1,     1)
PM_data <- data.frame(Pop, as.factor(PM))
str(PM_data)
logistic <- glm( PM ~ Pop, data = PM_data, family = binomial)
summary(logistic)
plot(Pop, PM)
# population per km2
Pop <- c(5137, 2095, 5019, 1187, 3498,
7055, 3533, 1595, 6534, 2016,
8848, 6725, 3477, 7931, 6733,
3265, 7264, 6575, 3280, 2240)
#         7756, 2040, 2840, 6233, 6890,
#         6381, 6752,  398, 6304, 5811)
PM  <- c( 1,     0,    0,   0,     0,
1,     0,    0,   0,     0,
1,     1,    1,   1,     1,
0,     1,    1,   0,     0)
#          1,     0,    0,   1,     1,
#          0,     0,    0,   1,     1)
PM_data <- data.frame(Pop, as.factor(PM))
str(PM_data)
logistic <- glm( PM ~ Pop, data = PM_data, family = binomial)
summary(logistic)
plot(Pop, PM)
# population per km2
Pop <- c(5137, 2095, 5019, 1187, 3498,
7055, 3533, 1595, 6534, 2016)
#         8848, 6725, 3477, 7931, 6733,
#         3265, 7264, 6575, 3280, 2240)
#         7756, 2040, 2840, 6233, 6890,
#         6381, 6752,  398, 6304, 5811)
PM  <- c( 1,     0,    0,   0,     0,
1,     0,    0,   0,     0)
#          1,     1,    1,   1,     1,
#          0,     1,    1,   0,     0)
#          1,     0,    0,   1,     1,
#          0,     0,    0,   1,     1)
PM_data <- data.frame(Pop, as.factor(PM))
str(PM_data)
logistic <- glm( PM ~ Pop, data = PM_data, family = binomial)
summary(logistic)
plot(Pop, PM)
# population per km2
Pop <- c(5137, 2095, 5019, 1187, 3498,
7055, 3533, 1595, 6534, 2016,
8848, 6725, 3477, 7931, 6733,
3265, 7264, 6575, 3280, 2240)
#         7756, 2040, 2840, 6233, 6890,
#         6381, 6752,  398, 6304, 5811)
PM  <- c( 1,     0,    0,   0,     0,
1,     0,    0,   0,     0,
1,     1,    1,   1,     1,
0,     1,    1,   0,     0)
#          1,     0,    0,   1,     1,
#          0,     0,    0,   1,     1)
PM_data <- data.frame(Pop, as.factor(PM))
str(PM_data)
logistic <- glm( PM ~ Pop, data = PM_data, family = binomial)
summary(logistic)
plot(Pop, PM)
# population per km2
Pop <- c(5100, 2100, 5000, 1200, 3500,
100, 3600, 1600, 6500, 2000,
8800, 4700, 3500, 7900, 6700,
3300, 7300, 3600, 3300, 2200,
7800, 2000, 2800, 2200, 6900,
6400, 6800,  400, 6300, 5800)
PM  <- c( 1,     0,    0,   0,     0,
0,     0,    0,   0,     0,
1,     1,    1,   1,     1,
0,     1,    0,   0,     0,
1,     0,    0,   0,     1,
0,     0,    0,   1,     1)
PM_data <- data.frame(Pop, as.factor(PM))
str(PM_data)
logistic <- glm( PM ~ Pop, data = PM_data, family = binomial)
summary(logistic)
plot(Pop, PM)
rlnorm(20,2000,2000)
rlnorm(20,2000,2)
rlnorm(20,meanlog = log(2000),2)
rlnorm(20,meanlog = log(2000),3)
rlnorm(20,meanlog = log(2000),2)
rlnorm(20,meanlog = log(2000),1)
rlnorm(20,meanlog = log(1500),1)
round(rlnorm(20,meanlog = log(1500),1),0)
round(rlnorm(20,meanlog = log(2000),1),0)
# population per km2
Pop <- c(797,  3652,   384,   876,  1156,
5282,  3602,  4305,  8451, 939,
2725,   296,  1187,  4819,  7856,
1074,  1444,  4620,   417,  3232)
PM  <- c( 0,     1,    0,   0,     0,
1,     0,    1,   1,     0,
1,     0,    0,   1,     1,
0,     0,    1,   0,     1)
PM_data <- data.frame(Pop, as.factor(PM))
str(PM_data)
logistic <- glm( PM ~ Pop, data = PM_data, family = binomial)
summary(logistic)
plot(Pop, PM)
# population per km2
Pop <- c(797,  3652,   384,   876,  1156,
5282,  3602,  4305,  8451, 939,
2725,   296,  1187,  4819,  7856,
1074,  1444,  4620,   417,  3232)
PM  <- c( 0,     1,    0,   0,     0,
1,     0,    1,   1,     0,
0,     0,    0,   1,     1,
0,     0,    1,   0,     1)
PM_data <- data.frame(Pop, as.factor(PM))
str(PM_data)
logistic <- glm( PM ~ Pop, data = PM_data, family = binomial)
summary(logistic)
plot(Pop, PM)
# population per km2
Pop <- c(797,  3652,   384,   876,  1156,
5282,  3602,  4305,  8451, 939,
2725,   296,  1187,  4819,  7856,
1074,  1444,  4620,   417,  3232)
PM  <- c( 0,     1,    0,   0,     0,
1,     0,    1,   1,     0,
1,     0,    0,   1,     1,
0,     0,    1,   0,     1)
PM_data <- data.frame(Pop, as.factor(PM))
str(PM_data)
logistic <- glm( PM ~ Pop, data = PM_data, family = binomial)
summary(logistic)
plot(Pop, PM)
# population per km2
Pop <- c(797,  3652,   384,   876,  1156,
5282,  3602,  4305,  8451, 939,
2725,   296,  1187,  4819,  7856,
1074,  1444,  4620,   417,  3232)
PM  <- c( 1,     1,    0,   0,     0,
1,     0,    1,   1,     0,
1,     0,    0,   1,     1,
0,     0,    1,   0,     1)
PM_data <- data.frame(Pop, as.factor(PM))
str(PM_data)
logistic <- glm( PM ~ Pop, data = PM_data, family = binomial)
summary(logistic)
plot(Pop, PM)
# population per km2
Pop <- c(797,  3652,   384,   876,  1156,
5282,  3602,  4305,  8451, 939,
2725,   296,  1187,  4819,  7856,
1074,  1444,  4620,   417,  3232)
PM  <- c( 0,     1,    0,   0,     0,
1,     0,    1,   1,     1,
1,     0,    0,   1,     1,
0,     0,    1,   0,     1)
PM_data <- data.frame(Pop, as.factor(PM))
str(PM_data)
logistic <- glm( PM ~ Pop, data = PM_data, family = binomial)
summary(logistic)
plot(Pop, PM)
# population per km2
Pop <- c(797,  3652,   384,   876,  1156,
5282,  3602,  4305,  8451, 939,
2725,   296,  1187,  4819,  7856,
1074,  1444,  4620,   417,  3232)
PM  <- c( 0,     1,    0,   0,     0,
1,     0,    1,   1,     1,
1,     0,    0,   1,     1,
0,     0,    0,   0,     1)
PM_data <- data.frame(Pop, as.factor(PM))
str(PM_data)
logistic <- glm( PM ~ Pop, data = PM_data, family = binomial)
summary(logistic)
plot(Pop, PM)
# population per km2
Pop <- c(797,  3652,   384,   876,  1156,
5282,  3602,  4305,  8451, 939,
2725,   296,  1187,  4819,  7856,
1074,  1444,  4620,   417,  3232)
PM  <- c( 0,     1,    0,   0,     0,
1,     0,    1,   1,     1,
1,     0,    0,   1,     1,
0,     0,    1,   0,     1)
PM_data <- data.frame(Pop, as.factor(PM))
str(PM_data)
logistic <- glm( PM ~ Pop, data = PM_data, family = binomial)
summary(logistic)
plot(Pop, PM)
hist(Pop)
# population per km2
Pop <- c(797,  3652,   384,   876,  1156,
5282,  3602,  4305,  8451, 939,
2725,   296,  1187,  4819,  7856,
1074,  1444,  2620,   417,  3232)
PM  <- c( 0,     1,    0,   0,     0,
1,     0,    1,   1,     1,
1,     0,    0,   1,     1,
0,     0,    1,   0,     1)
PM_data <- data.frame(Pop, as.factor(PM))
str(PM_data)
logistic <- glm( PM ~ Pop, data = PM_data, family = binomial)
summary(logistic)
plot(Pop, PM)
hist(Pop)
# population per km2
Pop <- c(797,  3652,   384,   876,  1156,
5282,  3602,  4305,  7451, 939,
2725,   296,  1187,  4819,  7856,
1074,  1444,  2620,   417,  3232)
PM  <- c( 0,     1,    0,   0,     0,
1,     0,    1,   1,     1,
1,     0,    0,   1,     1,
0,     0,    1,   0,     1)
PM_data <- data.frame(Pop, as.factor(PM))
str(PM_data)
logistic <- glm( PM ~ Pop, data = PM_data, family = binomial)
summary(logistic)
plot(Pop, PM)
hist(Pop)
# population per km2
Pop <- c(797,  3652,   384,   876,  1156,
5282,  3602,  4305,  6451, 939,
2725,   296,  1187,  4819,  7856,
1074,  1444,  2620,   417,  3232)
PM  <- c( 0,     1,    0,   0,     0,
1,     0,    1,   1,     1,
1,     0,    0,   1,     1,
0,     0,    1,   0,     1)
PM_data <- data.frame(Pop, as.factor(PM))
str(PM_data)
logistic <- glm( PM ~ Pop, data = PM_data, family = binomial)
summary(logistic)
plot(Pop, PM)
hist(Pop)
# population per km2
Pop <- c(797,  3652,   384,   876,  1156,
5282,  3602,  4305,  6451, 939,
2725,   296,  1187,  4819,  7856,
1074,  1444,  2620,   417,  3232)
PM  <- c( 0,     1,    0,   0,     0,
1,     0,    1,   1,     1,
1,     0,    0,   1,     0,
0,     0,    1,   0,     1)
PM_data <- data.frame(Pop, as.factor(PM))
str(PM_data)
logistic <- glm( PM ~ Pop, data = PM_data, family = binomial)
summary(logistic)
plot(Pop, PM)
# population per km2
Pop <- c(797,  3652,   384,   876,  1156,
5282,  3602,  4305,  6451, 939,
2725,   296,  1187,  4819,  7856,
1074,  1444,  2620,   417,  3232)
PM  <- c( 0,     1,    0,   0,     0,
1,     0,    1,   1,     1,
1,     0,    0,   1,     1,
0,     0,    1,   0,     1)
PM_data <- data.frame(Pop, as.factor(PM))
str(PM_data)
logistic <- glm( PM ~ Pop, data = PM_data, family = binomial)
summary(logistic)
plot(Pop, PM)
# population per km2
Pop <- c(797,  3652,   384,   876,  1156,
5282,  3602,  4305,  6451, 939,
2725,   296,  1187,  4819,  7856,
1074,  1444,  2620,   417,  3232)
PM  <- c( 0,     1,    0,   0,     0,
1,     0,    1,   1,     1,
1,     0,    0,   0,     1,
0,     0,    1,   0,     1)
PM_data <- data.frame(Pop, as.factor(PM))
str(PM_data)
logistic <- glm( PM ~ Pop, data = PM_data, family = binomial)
summary(logistic)
plot(Pop, PM)
# population per km2
Pop <- c(797,  3652,   384,   876,  1156,
5282,  3602,  4305,  6451, 939,
2725,   296,  1187,  4819,  7856,
1074,  1444,  2620,   417,  3232)
PM  <- c( 0,     1,    0,   0,     0,
1,     0,    1,   1,     1,
1,     0,    0,   0,     1,
0,     0,    1,   0,     1)
PM_data <- data.frame(Pop, as.factor(PM))
str(PM_data)
logistic <- glm( PM ~ Pop, data = PM_data, family = binomial)
summary(logistic)
plot(Pop, PM)
library(pscl)
logistic$null.deviance/-2
logistic$deviance/-2
ll.null <- logistic$null.deviance/-2
ll.propse <- logistic$deviance/-2
(ll.null-ll.propse)/ll.null
# Define new cities
new <- data.frame(Pop = c(1000, 5000))
new
#predict probability of defaulting
predict(logistic, new, type="response")
install.packages("InformationValue")
library(InformationValue)
optimalCutoff(PM_data$PM, predicted)[1]
PM_data
PM_data$PM
PM <- as.factor(PM)
PM_data <- data.frame(Pop, PM)
PM_data
logistic <- glm( PM ~ Pop, data = PM_data, family = binomial)
summary(logistic)
plot(Pop, PM)
ll.null <- logistic$null.deviance/-2
ll.propse <- logistic$deviance/-2
(ll.null-ll.propse)/ll.null
# Define new cities
new <- data.frame(Pop = c(1000, 5000))
#predict probability of defaulting
predict(logistic, new, type="response")
PM_data$PM
optimalCutoff(PM_data$PM, predicted)[1]
predicted <- predict(logistic, PM_data, type="response")
predicted
optimalCutoff(PM_data$PM, predicted)[1]
optimalCutoff(PM_data$PM, predicted_value)
#find optimal cutoff probability to use to maximize accuracy
predicted_value <- predict(logistic, PM_data, type="response")
optimalCutoff(PM_data$PM, predicted_value)
optimalCutoff(PM_data$PM, predicted)
data(mtcars)
mtcars
data(mtcars)
fraction        <- 0.85
sample_index    <- sample(nrow(mtcars),nrow(mtcars)*fraction)
sample_index
fraction        <- 0.85
sample_index    <- sample(nrow(mtcars),nrow(mtcars)*fraction)
mtcars_training   <- mtcars[sample_index,]
mtcars_validation <- mtcars[-sample_index,]
mtcars_training
mtcars_validation
mtcars_training
logistic <- glm( am ~ cyl + hp + wt, data = mtcars_training, family = binomial)
summary(logistic)
mtcars_training
mtcars_training
logistic <- glm( am ~ cyl + hp + wt, data = mtcars_training, family = binomial)
summary(logistic)
logistic <- glm( am ~ cyl + hp + wt, data = mtcars, family = binomial)
summary(logistic)
data(mtcars)
logistic <- glm( am ~ cyl + hp + wt, data = mtcars, family = binomial)
summary(logistic)
logistic <- glm( am ~ hp + wt, data = mtcars, family = binomial)
summary(logistic)
predicted_value <- predict(logistic, mtcars, type="response")
predicted_value
logistic <- glm( am ~ hp + wt, data = input, family = binomial)
summary(logistic)
summary(logistic)
input <- mtcars[,c("am","cyl","hp","wt")]
logistic <- glm( am ~ hp + wt, data = input, family = binomial)
summary(logistic)
predicted_value <- predict(logistic, input, type="response")
predicted_value
input
input
optimalCutoff(input$am, predicted_value)[1]
logistic <- glm( am ~ hp + wt, data = input, family = binomial)
summary(logistic)
predicted_value <- predict(logistic, input, type="response")
optimalCutoff(input$am, predicted_value)[1]
logistic <- glm( am ~ hp + wt, data = mtcars, family = binomial)
summary(logistic)
predicted_value <- predict(logistic, mtcars, type="response")
optimalCutoff(mtcars$am, predicted_value)[1]
mtcars
new <- data.frame(cyl = c(4,6,8), wt = c(3.0,2.0,5.0))
predict(logistic, new, type="response")
logistic <- glm( am ~ hp + wt, data = mtcars, family = binomial)
summary(logistic)
predicted_value <- predict(logistic, mtcars, type="response")
optimalCutoff(mtcars$am, predicted_value)[1]
new <- data.frame(cyl = c(4,6,8), wt = c(3.0,2.0,5.0))
predict(logistic, new, type="response")
new <- data.frame(hp = c(140,60,120), wt = c(3.0,2.0,5.0))
predict(logistic, new, type="response")
new <- data.frame(hp = c(140,60,320), wt = c(3.0,2.0,5.0))
predict(logistic, new, type="response")
new <- data.frame(hp = c(140,90,220), wt = c(3.0,2.0,5.0))
predict(logistic, new, type="response")
setwd("D://ese335")
rmarkdown::render_site()
rmarkdown::render_site()

<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Section 11 Post-hoc test and Two-way ANOVA</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 66px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h2 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h3 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h4 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h5 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h6 {
  padding-top: 71px;
  margin-top: -71px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Environmental Data Analysis</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Syllabus.html">
    <span class="fa fa-bell-o"></span>
     
    Syllabus
  </a>
</li>
<li>
  <a href="Schedule.html">
    <span class="fa fa-calendar"></span>
     
    Schedule
  </a>
</li>
<li>
  <a href="Resource.html">
    <span class="fa fa-wrench"></span>
     
    Resource
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-laptop"></span>
     
    Assignments
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="A01.html">Assignment 01</a>
    </li>
    <li>
      <a href="A02.html">Assignment 02</a>
    </li>
    <li>
      <a href="A03.html">Assignment 03</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Section 11 Post-hoc test and Two-way ANOVA</h1>

</div>


<hr />
<div id="prerequisites" class="section level1">
<h1>Prerequisites</h1>
<p>Load the libraries with R:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(tidyr)</span></code></pre></div>
<pre><code>## Warning: package &#39;tidyr&#39; was built under R version 4.0.5</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">library</span>(dplyr)</span></code></pre></div>
<pre><code>## Warning: package &#39;dplyr&#39; was built under R version 4.0.5</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="kw">library</span>(randtests)</span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="kw">library</span>(moments)</span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="kw">library</span>(outliers)</span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="kw">library</span>(nortest)</span></code></pre></div>
<hr />
</div>
<div id="post-hoc-test-after-one-way-anova" class="section level1">
<h1>Post-hoc test after one-way ANOVA</h1>
<p>We saw from <a href="https://zhu-group.github.io/ese335/S10.html">the last section</a> that one-way ANOVA is used to test whether means among populations are the same. Once a one-way ANOVA is done, and significant differences are identified, one would be more interested in finding out <strong>which specific groups’s means (compared with each other) are different</strong>. The test compares all possible pairs of means. And this is so-called the <em>post-hoc test</em> of one-way ANOVA.</p>
<p>There are a great number of different post hoc tests that you can use. Here we introduce the <em>Tukey’s Test</em> (or Tukey procedure), also called <em>Tukey’s Honest Significant Difference</em> (Tukey’s HSD) test, which is the most common and widely accepted method. See [RS] ch. 6 (p.149-170) and <a href="https://pure.aston.ac.uk/ws/files/14501361/Statnote_6.pdf">post hoc ANOVA tests</a> for other tests and when to use those.</p>
<p>Let’s use the <a href="https://zhu-group.github.io/ese335/S10.html#Section_Example:_Removal_of_cadmium_from_soil_by_plants">Cd example from the last section</a> for the one-way ANOVA and its Tukey’s test.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># Sub-samples</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>Control  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.64</span>, <span class="fl">0.91</span>, <span class="fl">0.84</span>, <span class="fl">0.41</span>, <span class="fl">1.58</span>, <span class="fl">0.48</span>, <span class="fl">0.88</span>, <span class="fl">0.74</span>, <span class="fl">1.09</span>, <span class="fl">1.28</span>)</span>
<span id="cb9-3"><a href="#cb9-3"></a>P1       &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.20</span>, <span class="fl">1.17</span>, <span class="fl">0.76</span>, <span class="fl">0.92</span>, <span class="fl">0.65</span>, <span class="fl">1.14</span>, <span class="fl">1.05</span>, <span class="fl">1.28</span>, <span class="fl">0.89</span>, <span class="fl">1.06</span>)</span>
<span id="cb9-4"><a href="#cb9-4"></a>P2       &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">1.31</span>, <span class="fl">0.43</span>, <span class="fl">1.18</span>, <span class="fl">1.02</span>, <span class="fl">0.83</span>, <span class="fl">1.02</span>, <span class="fl">0.66</span>, <span class="fl">0.70</span>, <span class="fl">0.83</span>)</span>
<span id="cb9-5"><a href="#cb9-5"></a>P3       &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.63</span>, <span class="fl">0.30</span>, <span class="fl">0.49</span>, <span class="fl">0.01</span>, <span class="fl">0.63</span>, <span class="fl">0.69</span>, <span class="fl">0.68</span>, <span class="fl">0.34</span>, <span class="fl">1.09</span>, <span class="fl">0.42</span>)</span>
<span id="cb9-6"><a href="#cb9-6"></a></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co"># Make data frame</span></span>
<span id="cb9-8"><a href="#cb9-8"></a>Cd_data  &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Cd=</span><span class="kw">c</span>(Control, P1, P2, P3),</span>
<span id="cb9-9"><a href="#cb9-9"></a>                       <span class="dt">group=</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;Control&quot;</span>, <span class="kw">length</span>(Control)),</span>
<span id="cb9-10"><a href="#cb9-10"></a>                              <span class="kw">rep</span>(<span class="st">&quot;Plant 1&quot;</span>, <span class="kw">length</span>(P1)),</span>
<span id="cb9-11"><a href="#cb9-11"></a>                              <span class="kw">rep</span>(<span class="st">&quot;Plant 2&quot;</span>, <span class="kw">length</span>(P2)),</span>
<span id="cb9-12"><a href="#cb9-12"></a>                              <span class="kw">rep</span>(<span class="st">&quot;Plant 3&quot;</span>, <span class="kw">length</span>(P3)) ))</span>
<span id="cb9-13"><a href="#cb9-13"></a></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="co"># Compare boxplots</span></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="kw">ggplot</span>(Cd_data, <span class="kw">aes</span>(<span class="dt">x=</span>group, <span class="dt">y=</span>Cd, <span class="dt">fill=</span>group)) <span class="op">+</span></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Soil Cd concentrations under different conditions&quot;</span>, </span>
<span id="cb9-18"><a href="#cb9-18"></a>       <span class="dt">x=</span><span class="st">&quot;Group&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Cd concentration [mg/kg]&quot;</span>) <span class="op">+</span></span>
<span id="cb9-19"><a href="#cb9-19"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<p><img src="S11_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># Perform the one-way ANOVA</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>res_aov &lt;-<span class="st"> </span><span class="kw">aov</span>(Cd <span class="op">~</span><span class="st"> </span>group, <span class="dt">data=</span>Cd_data)</span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="kw">summary</span>(res_aov)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## group        3  1.261  0.4204   4.662 0.00748 **
## Residuals   36  3.246  0.0902                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># Post-hoc test with the Hukey test</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="kw">TukeyHSD</span>(res_aov)</span></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = Cd ~ group, data = Cd_data)
## 
## $group
##                   diff        lwr          upr     p adj
## Plant 1-Control  0.127 -0.2346788  0.488678783 0.7805407
## Plant 2-Control -0.062 -0.4236788  0.299678783 0.9668827
## Plant 3-Control -0.357 -0.7186788  0.004678783 0.0541363
## Plant 2-Plant 1 -0.189 -0.5506788  0.172678783 0.5030839
## Plant 3-Plant 1 -0.484 -0.8456788 -0.122321217 0.0049798
## Plant 3-Plant 2 -0.295 -0.6566788  0.066678783 0.1435130</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># Plot the 95% (default) CI of the difference</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="kw">plot</span>(<span class="kw">TukeyHSD</span>(res_aov))</span></code></pre></div>
<p><img src="S11_files/figure-html/unnamed-chunk-3-1.png" width="768" /></p>
<p>Tukey’s test shows a significant difference in mean Cd concentration in the field with Plant #1 and field with Plant #3, and no significant difference between other pairs.</p>
<hr />
</div>
<div id="section-example-removal-of-cadmium-from-the-soil-by-multiple-approaches" class="section level1">
<h1>Section Example: Removal of cadmium from the soil by multiple approaches</h1>
<p>Now suppose we would like to test whether other approaches could have an impact on soil Cd concentration. Instead of using plants (#1, #2, and #3) alone, we also try physical (with chemical #1 and #2) and chemical (#1, #2, #3, and #4) treatment method. We measure Cd concentration from each combination.</p>
<p>The results are list in the <a href="https://zhu-group.github.io/ese335/download/cd_data.csv">Cd dataset</a>, which contains <code>96</code> rows and <code>4</code> variables:</p>
<ul>
<li>Physical: type of chemical used: factor level: 1 and 2</li>
<li>Chemical: type of physical method used: factor level: 1, 2, 3, and 4</li>
<li>Plant: type of Plant used: factor level: 1, 2, and 3</li>
<li>Cd: soil Cd concentration</li>
</ul>
<p>In R import the data:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># Read csv</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>cd_data &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;cd_data.csv&quot;</span>, <span class="dt">header=</span>T)</span>
<span id="cb15-3"><a href="#cb15-3"></a></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="co"># Change to factor type using tibble</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>cd_data_tbl &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(cd_data) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Chemical =</span> <span class="kw">factor</span>(Chemical, <span class="dt">ordered =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Physical =</span> <span class="kw">factor</span>(Physical, <span class="dt">ordered =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Plant    =</span> <span class="kw">factor</span>(Plant   , <span class="dt">ordered =</span> <span class="ot">TRUE</span>))   </span>
<span id="cb15-9"><a href="#cb15-9"></a></span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="co"># Quick check</span></span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="kw">glimpse</span>(cd_data_tbl)</span></code></pre></div>
<pre><code>## Rows: 96
## Columns: 4
## $ Physical &lt;ord&gt; 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1,~
## $ Chemical &lt;ord&gt; 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 1,~
## $ Plant    &lt;ord&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3,~
## $ Cd       &lt;dbl&gt; 1.71, 2.04, 0.90, 2.19, 1.62, 1.27, 1.24, 1.55, 0.76, 2.45, 1.09, 1.52, 1.97, 1.37, 0.61, 0.49, 0.58, 2.81, 1.74, 1.40, 0.71, 1.04, 0.50, 1.26, 0.60, 1.66, 0.37, 1.58, 0.20, 1.67, 0.34, 0.26, 0.83, 0.39, 1.74, 1.69, 1.~</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># Boxplot - Physical</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="kw">ggplot</span>(cd_data_tbl, <span class="kw">aes</span>(<span class="dt">x =</span> Physical, <span class="dt">y =</span> Cd, <span class="dt">fill =</span> Physical)) <span class="op">+</span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<p><img src="S11_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># Boxplot - Chemical</span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="kw">ggplot</span>(cd_data_tbl, <span class="kw">aes</span>(<span class="dt">x =</span> Chemical, <span class="dt">y =</span> Cd, <span class="dt">fill =</span> Chemical)) <span class="op">+</span></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<p><img src="S11_files/figure-html/unnamed-chunk-4-2.png" width="672" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># Boxplot - Plant</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="kw">ggplot</span>(cd_data_tbl, <span class="kw">aes</span>(<span class="dt">x =</span> Plant, <span class="dt">y =</span> Cd, <span class="dt">fill =</span> Plant)) <span class="op">+</span></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<p><img src="S11_files/figure-html/unnamed-chunk-4-3.png" width="672" /></p>
<p>Here we convert <code>cd_data</code> to <code>cd_data_tbl</code>, which has a new format <code>tibble</code>. See <a href="https://zhu-group.github.io/ese335/Sup01.html">Supplement 01 Data wrangling and quick plots</a> for more.</p>
<hr />
</div>
<div id="two-way-anova-with-r" class="section level1">
<h1>Two-way ANOVA with R</h1>
<p>A two-way ANOVA is used to estimate how the mean of a quantitative variable changes according to the levels of <strong>two factors</strong>. Use a two-way ANOVA when you want to know how two independent variables, in combination, affect a dependent variable.</p>
<p>In the proceeding example, we can use a two-way ANOVA to find out if the chemical type and plant type have an effect on average Cd concentration.</p>
<p>A two-way ANOVA with <em>interaction</em> tests three null hypotheses (H0) at the same time:</p>
<ul>
<li><p>There is no difference in group means at any level of the first independent variable.</p></li>
<li><p>There is no difference in group means at any level of the second independent variable.</p></li>
<li><p>The effect of one independent variable does not depend on the effect of the other independent variable (a.k.a. no interaction effect).</p></li>
</ul>
<p>A two-way ANOVA without interaction (a.k.a. an <strong>additive</strong> two-way ANOVA) only tests the first two of these hypotheses.</p>
<p>Here for our example, we use the two-way ANOVA will test whether the independent variables (chemical type and plant type) have an effect on the dependent variable (average Cd concentration). We also want to check if there is an interaction effect between two independent variables – for example, it’s possible that plant treatment affects the soil’ ability to take up chemical compounds.</p>
<p>In this setup, H0 are:</p>
<ul>
<li><p>There is no difference in mean Cd concentration at any level of the chemical type.</p></li>
<li><p>There is no difference in mean Cd concentration at any level of the plant type.</p></li>
<li><p>The effect of chemical type does not depend on the effect of plant type (a.k.a. no interaction effect between chemical and plant treatment).</p></li>
</ul>
<p>And the corresponding H1 are:</p>
<ul>
<li><p>There is a difference in mean Cd concentration by chemical type</p></li>
<li><p>There is a difference in mean Cd concentration by plant type</p></li>
<li><p>There is an interaction effect between chemical type and plant type on average Cd concentration</p></li>
</ul>
<p>To test the hypotheses in R:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># Test the interaction term</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>two_way_interaction &lt;-<span class="st"> </span><span class="kw">aov</span>(Cd <span class="op">~</span><span class="st"> </span>Chemical <span class="op">*</span><span class="st"> </span>Plant, <span class="dt">data =</span> cd_data_tbl)</span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="kw">summary</span>(two_way_interaction)</span></code></pre></div>
<pre><code>##                Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## Chemical        3  5.323  1.7745   5.467 0.00176 **
## Plant           2  0.714  0.3569   1.100 0.33776   
## Chemical:Plant  6  1.259  0.2098   0.647 0.69270   
## Residuals      84 27.264  0.3246                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># Additive two-way ANOVA</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>two_way_additive &lt;-<span class="st"> </span><span class="kw">aov</span>(Cd <span class="op">~</span><span class="st"> </span>Chemical <span class="op">+</span><span class="st"> </span>Plant, <span class="dt">data =</span> cd_data_tbl)</span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="kw">summary</span>(two_way_additive)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## Chemical     3  5.323  1.7745   5.599 0.00145 **
## Plant        2  0.714  0.3569   1.126 0.32882   
## Residuals   90 28.523  0.3169                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>To test whether two variables have an interaction effect in ANOVA, simply use an asterisk (<code>*</code>) instead of a plus-sign (<code>+</code>) in the model.</p>
<p>In the output table, the <code>Chemical:Plant</code> variable has a low sum-of-squares value and a high p-value, which means there is not much variation that can be explained by the interaction between chemical and plant type.</p>
<p>Similar to the one-way ANOVA, we can use the Tukey’s test lets us see which groups are different from one another.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw">TukeyHSD</span>(two_way_additive)</span></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = Cd ~ Chemical + Plant, data = cd_data_tbl)
## 
## $Chemical
##           diff         lwr        upr     p adj
## 2-1  0.4404167  0.01501008  0.8658233 0.0395318
## 3-1 -0.1545833 -0.57998992  0.2708233 0.7772589
## 4-1  0.2991667 -0.12623992  0.7245733 0.2612190
## 3-2 -0.5950000 -1.02040659 -0.1695934 0.0023526
## 4-2 -0.1412500 -0.56665659  0.2841566 0.8207323
## 4-3  0.4537500  0.02834341  0.8791566 0.0318855
## 
## $Plant
##          diff        lwr       upr     p adj
## 2-1 -0.022500 -0.3578973 0.3128973 0.9860108
## 3-1  0.170625 -0.1647723 0.5060223 0.4490216
## 3-2  0.193125 -0.1422723 0.5285223 0.3597295</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="kw">plot</span>(<span class="kw">TukeyHSD</span>(two_way_additive))</span></code></pre></div>
<p><img src="S11_files/figure-html/unnamed-chunk-6-1.png" width="672" /><img src="S11_files/figure-html/unnamed-chunk-6-2.png" width="672" /></p>
<p>This output shows the pairwise differences between the <code>4</code> types of chemical (<code>$Chemical</code>) and between the <code>3</code> types of plants (<code>$Plant</code>), with the average difference (<code>diff</code>), the lower and upper bounds of the <code>95%</code> confidence interval (<code>lwr</code> and <code>uwr</code>) and the p-value of the difference (<code>p-adj</code>).</p>
<p>From the post-hoc test results, we see that there are significant differences (<code>p &lt; 0.05</code>) between:</p>
<ul>
<li><p>Chemical type 4 and 3,</p></li>
<li><p>Chemical type 3 and 2,</p></li>
</ul>
<p>but no difference among plant types.</p>
<hr />
</div>
<div id="anova-procedure" class="section level1">
<h1>ANOVA procedure</h1>
<p>As a parametric method, ANOVA has its assumptions as well:</p>
<ul>
<li><p>Independence of observations</p></li>
<li><p>Normally-distributed dependent variable</p></li>
<li><p>Homogeneity of variance (a.k.a. <em>homoscedasticity</em>)</p></li>
</ul>
<p>The first two assumptions are the same as the t-test. The last one refers that the variation around the mean for each group being compared should be similar among all groups. This is usually checked after running the model by examining the residuals. If the data fail to meet this assumption, we may be able to use a non-parametric alternative.</p>
<p>In the following, we will use the proceeding example to go through each step of ANOVA.</p>
<div id="check-data" class="section level2">
<h2>1 Check data</h2>
<ul>
<li><p>Visual checking</p></li>
<li><p>Statistical test: independence, normality, and outliers</p></li>
</ul>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="co"># Quick plots</span></span>
<span id="cb27-2"><a href="#cb27-2"></a></span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="co"># Boxplot - Chemical</span></span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="kw">ggplot</span>(cd_data_tbl, <span class="kw">aes</span>(<span class="dt">x =</span> Chemical, <span class="dt">y =</span> Cd, <span class="dt">fill =</span> Chemical)) <span class="op">+</span></span>
<span id="cb27-5"><a href="#cb27-5"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb27-6"><a href="#cb27-6"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<p><img src="S11_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="co"># Boxplot - Plant</span></span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="kw">ggplot</span>(cd_data_tbl, <span class="kw">aes</span>(<span class="dt">x =</span> Plant, <span class="dt">y =</span> Cd, <span class="dt">fill =</span> Plant)) <span class="op">+</span></span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb28-4"><a href="#cb28-4"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<p><img src="S11_files/figure-html/unnamed-chunk-7-2.png" width="672" /></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="co"># Check independence of the dependent variable</span></span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="kw">runs.test</span>(cd_data_tbl<span class="op">$</span>Cd)</span></code></pre></div>
<pre><code>## 
##  Runs Test
## 
## data:  cd_data_tbl$Cd
## statistic = 1.037, runs = 53, n1 = 47, n2 = 47, n = 94, p-value = 0.2997
## alternative hypothesis: nonrandomness</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co"># Check normality</span></span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="co"># Sample size &gt; 30, use the Lilliefors test</span></span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="kw">lillie.test</span>(cd_data_tbl<span class="op">$</span>Cd)</span></code></pre></div>
<pre><code>## 
##  Lilliefors (Kolmogorov-Smirnov) normality test
## 
## data:  cd_data_tbl$Cd
## D = 0.069905, p-value = 0.2959</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="co"># Check outliers</span></span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="co"># After examining the data, we decide to keep this value</span></span>
<span id="cb33-3"><a href="#cb33-3"></a><span class="kw">grubbs.test</span>(cd_data_tbl<span class="op">$</span>Cd)</span></code></pre></div>
<pre><code>## 
##  Grubbs test for one outlier
## 
## data:  cd_data_tbl$Cd
## G = 2.87863, U = 0.91186, p-value = 0.1589
## alternative hypothesis: highest value 3.02 is an outlier</code></pre>
</div>
<div id="write-down-h0-and-h1" class="section level2">
<h2>2 Write down H0 and H1</h2>
<p>H0 are:</p>
<ul>
<li><p>There is no difference in mean Cd concentration at any level of the chemical type.</p></li>
<li><p>There is no difference in mean Cd concentration at any level of the plant type.</p></li>
<li><p>The effect of chemical type does not depend on the effect of plant type.</p></li>
</ul>
<p>H1 are:</p>
<ul>
<li><p>There is a difference in mean Cd concentration by chemical type</p></li>
<li><p>There is a difference in mean Cd concentration by plant type</p></li>
<li><p>There is an interaction effect between chemical type and plant type on average Cd concentration</p></li>
</ul>
</div>
<div id="anova-with-r" class="section level2">
<h2>3 ANOVA with R</h2>
<p>Build the ANOVA model with and without the interaction term:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co"># Test the interaction term</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>two_way_interaction &lt;-<span class="st"> </span><span class="kw">aov</span>(Cd <span class="op">~</span><span class="st"> </span>Chemical <span class="op">*</span><span class="st"> </span>Plant, <span class="dt">data =</span> cd_data_tbl)</span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="kw">summary</span>(two_way_interaction)</span></code></pre></div>
<pre><code>##                Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## Chemical        3  5.323  1.7745   5.467 0.00176 **
## Plant           2  0.714  0.3569   1.100 0.33776   
## Chemical:Plant  6  1.259  0.2098   0.647 0.69270   
## Residuals      84 27.264  0.3246                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="co"># Additive two-way ANOVA</span></span>
<span id="cb37-2"><a href="#cb37-2"></a>two_way_additive &lt;-<span class="st"> </span><span class="kw">aov</span>(Cd <span class="op">~</span><span class="st"> </span>Chemical <span class="op">+</span><span class="st"> </span>Plant, <span class="dt">data =</span> cd_data_tbl)</span>
<span id="cb37-3"><a href="#cb37-3"></a><span class="kw">summary</span>(two_way_additive)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## Chemical     3  5.323  1.7745   5.599 0.00145 **
## Plant        2  0.714  0.3569   1.126 0.32882   
## Residuals   90 28.523  0.3169                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="check-homoscedasticity-of-residuals" class="section level2">
<h2>4 Check homoscedasticity of residuals</h2>
<p>To check whether the model fits the assumption of homoscedasticity, look at the model diagnostic plots in R using the <code>plot()</code> function:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="kw">plot</span>(two_way_additive)</span></code></pre></div>
<p><img src="S11_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p>The diagnostic plots show the unexplained variance (<em>residuals</em>) across the range of the observed data.</p>
<p>Each plot gives a specific piece of information about the model fit. Here are things to check:</p>
<ul>
<li><p>The red line representing the mean of the residuals should be <strong>horizontal and centered on zero</strong> (or on one, in the scale-location plot), meaning that there are no large outliers that would cause bias in the model. This means the variance of residuals don’t change too much.</p></li>
<li><p>The normal Q-Q plot plots a regression between the theoretical residuals of a perfectly-heteroscedastic model and the actual residuals of your model, so the <strong>closer to a slope of 1</strong> this is the better.</p></li>
</ul>
<p>If the model fails to fit the assumption of homoscedasticity, we need to use a non-parametric test instead.</p>
</div>
<div id="tukeys-test-with-r" class="section level2">
<h2>5 Tukey’s test with R</h2>
<p>Check pairwise difference:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="kw">TukeyHSD</span>(two_way_additive)</span></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = Cd ~ Chemical + Plant, data = cd_data_tbl)
## 
## $Chemical
##           diff         lwr        upr     p adj
## 2-1  0.4404167  0.01501008  0.8658233 0.0395318
## 3-1 -0.1545833 -0.57998992  0.2708233 0.7772589
## 4-1  0.2991667 -0.12623992  0.7245733 0.2612190
## 3-2 -0.5950000 -1.02040659 -0.1695934 0.0023526
## 4-2 -0.1412500 -0.56665659  0.2841566 0.8207323
## 4-3  0.4537500  0.02834341  0.8791566 0.0318855
## 
## $Plant
##          diff        lwr       upr     p adj
## 2-1 -0.022500 -0.3578973 0.3128973 0.9860108
## 3-1  0.170625 -0.1647723 0.5060223 0.4490216
## 3-2  0.193125 -0.1422723 0.5285223 0.3597295</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="kw">plot</span>(<span class="kw">TukeyHSD</span>(two_way_additive))</span></code></pre></div>
<p><img src="S11_files/figure-html/unnamed-chunk-10-1.png" width="672" /><img src="S11_files/figure-html/unnamed-chunk-10-2.png" width="672" /></p>
</div>
<div id="report-the-results" class="section level2">
<h2>6 Report the results</h2>
<ul>
<li><p>A brief description of the variables you tested</p></li>
<li><p>The <em>F</em>-value, degrees of freedom, and p-values for each independent variable</p></li>
<li><p>What the results mean.</p></li>
</ul>
<p>In our example, we can report the results as:</p>
<p>We found a statistically significant difference in average Cd concentration by chemical type (<code>F(3)=5.5, p &lt; 0.001</code>). Plant type leads to no statistically significant difference in average Cd concentration.</p>
<p>A Tukey post-hoc test revealed that chemical type 3 resulted in a lower Cd concentration on average than chemical type 2 (<code>0.60</code> mg/kg), chemical type 3 resulted in a lower Cd concentration on average than chemical type 4 (<code>0.45</code> mg/kg), chemical type 1 resulted in a lower Cd concentration on average than chemical type 2 (<code>0.44</code> mg/kg).</p>
<hr />
</div>
</div>
<div id="in-class-exercises" class="section level1">
<h1>In-class exercises</h1>
<div id="exercise-1" class="section level2">
<h2>Exercise #1</h2>
<p>Use <code>cd_data_tbl</code> to find out if the physical type and plant type affect average Cd concentration. Follow the ANOVA procedure step 1-6.</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = false;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>

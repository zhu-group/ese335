<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Section 20 Plotting with R (II): making maps</title>

<script src="site_libs/jquery-1.12.4/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/spacelab.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="site_libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="site_libs/leaflet-1.3.1/leaflet.js"></script>
<link href="site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="site_libs/proj4-2.6.2/proj4.min.js"></script>
<script src="site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="site_libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 52px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h2 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h3 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h4 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h5 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h6 {
  padding-top: 57px;
  margin-top: -57px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Environmental Data Analysis</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Syllabus.html">
    <span class="fa fa-bell-o"></span>
     
    Syllabus
  </a>
</li>
<li>
  <a href="Schedule.html">
    <span class="fa fa-calendar"></span>
     
    Schedule
  </a>
</li>
<li>
  <a href="Resource.html">
    <span class="fa fa-wrench"></span>
     
    Resource
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-laptop"></span>
     
    Assignments
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="download/Assignment_01.pdf">Assignment 01</a>
    </li>
    <li>
      <a href="download/Assignment_02.pdf">Assignment 02</a>
    </li>
    <li>
      <a href="download/Assignment_03.pdf">Assignment 03</a>
    </li>
    <li>
      <a href="download/Assignment_04.pdf">Assignment 04</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Section 20 Plotting with R (II): making maps</h1>

</div>


<hr />
<div id="prerequisites" class="section level1">
<h1>Prerequisites</h1>
<p>Load the libraries with R:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(plyr)</span></code></pre></div>
<pre><code>## --------------------------------------------------------------------------------------------------------------</code></pre>
<pre><code>## You have loaded plyr after dplyr - this is likely to cause problems.
## If you need functions from both plyr and dplyr, please load plyr first, then dplyr:
## library(plyr); library(dplyr)</code></pre>
<pre><code>## --------------------------------------------------------------------------------------------------------------</code></pre>
<pre><code>## 
## Attaching package: &#39;plyr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:ggpubr&#39;:
## 
##     mutate</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     arrange, count, desc, failwith, id, mutate, rename, summarise, summarize</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">library</span>(ggsn)</span></code></pre></div>
<pre><code>## Warning: package &#39;ggsn&#39; was built under R version 4.0.5</code></pre>
<pre><code>## Loading required package: grid</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">library</span>(leafletCN)</span></code></pre></div>
<pre><code>## Warning: package &#39;leafletCN&#39; was built under R version 4.0.5</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">library</span>(raster)</span></code></pre></div>
<pre><code>## Warning: package &#39;raster&#39; was built under R version 4.0.3</code></pre>
<pre><code>## Loading required package: sp</code></pre>
<pre><code>## Warning: package &#39;sp&#39; was built under R version 4.0.5</code></pre>
<pre><code>## 
## Attaching package: &#39;raster&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:ggsn&#39;:
## 
##     scalebar</code></pre>
<pre><code>## The following object is masked from &#39;package:EnvStats&#39;:
## 
##     cv</code></pre>
<pre><code>## The following object is masked from &#39;package:ggpubr&#39;:
## 
##     rotate</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     select</code></pre>
<pre><code>## The following object is masked from &#39;package:tidyr&#39;:
## 
##     extract</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">library</span>(ggmap)</span></code></pre></div>
<pre><code>## Warning: package &#39;ggmap&#39; was built under R version 4.0.5</code></pre>
<pre><code>## Google&#39;s Terms of Service: https://cloud.google.com/maps-platform/terms/.</code></pre>
<pre><code>## Please cite ggmap if you use it! See citation(&quot;ggmap&quot;) for details.</code></pre>
<hr />
</div>
<div id="shape-file" class="section level1">
<h1>Shape file</h1>
<p><em>ESRI shapefile</em> (or shape file) is widely used in environmental science and geoscience. A shapefile consists of various files of the same name, but with different extensions. They should all be in one directory. Here we use the shape file of China map as an example, <a href="https://zhu-group.github.io/ese335/download/China_map.zip">download it</a>. Decompress it. Open the folder, you will see there are three files of different formats (<code>.dbf</code>, <code>.shp</code>, <code>.shx</code>). In R, we can read the shape file via:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="co"># Location of the .shp file </span></span>
<span id="cb27-2"><a href="#cb27-2"></a>Local_path &lt;-<span class="st"> &quot;D://China_map/&quot;</span></span>
<span id="cb27-3"><a href="#cb27-3"></a></span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="co"># Read china map, a shape file</span></span>
<span id="cb27-5"><a href="#cb27-5"></a>China_map &lt;-<span class="st"> </span>rgdal<span class="op">::</span><span class="kw">readOGR</span>(<span class="kw">paste0</span>(Local_path, <span class="st">&quot;bou2_4p.shp&quot;</span>))</span></code></pre></div>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;D:\China_map\bou2_4p.shp&quot;, layer: &quot;bou2_4p&quot;
## with 925 features
## It has 7 fields
## Integer64 fields read as strings:  BOU2_4M_ BOU2_4M_ID</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="co"># Check the attributes </span></span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="kw">class</span>(China_map)</span></code></pre></div>
<pre><code>## [1] &quot;SpatialPolygonsDataFrame&quot;
## attr(,&quot;package&quot;)
## [1] &quot;sp&quot;</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">names</span>(China_map)</span></code></pre></div>
<pre><code>## [1] &quot;AREA&quot;       &quot;PERIMETER&quot;  &quot;BOU2_4M_&quot;   &quot;BOU2_4M_ID&quot; &quot;ADCODE93&quot;   &quot;ADCODE99&quot;   &quot;NAME&quot;</code></pre>
<p>From here, we can see that there are <code>925</code> polygons, and R just follows the polygons defined by this object then line them each one up. If you want to see the data hidden in <code>SpatialPolygonsDataFrame</code>, we can use the operator <code>@</code>:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="co"># Check the attributes, use the operator @</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>map_data &lt;-<span class="st"> </span>China_map<span class="op">@</span>data</span>
<span id="cb33-3"><a href="#cb33-3"></a><span class="kw">head</span>(map_data)</span></code></pre></div>
<pre><code>##      AREA PERIMETER BOU2_4M_ BOU2_4M_ID ADCODE93 ADCODE99             NAME
## 0  54.447    68.489        2         23   230000   230000         黑龙江省
## 1 129.113   129.933        3         15   150000   150000     内蒙古自治区
## 2 175.591    84.905        4         65   650000   650000 新疆维吾尔自治区
## 3  21.315    41.186        5         22   220000   220000           吉林省
## 4  15.603    38.379        6         21   210000   210000           辽宁省
## 5  41.508    76.781        7         62   620000   620000           甘肃省</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="kw">tail</span>(map_data)</span></code></pre></div>
<pre><code>##     AREA PERIMETER BOU2_4M_ BOU2_4M_ID ADCODE93 ADCODE99           NAME
## 919    0     0.012      921       3099   810000   810000 香港特别行政区
## 920    0     0.037      922       3110   810000   810000 香港特别行政区
## 921    0     0.018      923       3109   810000   810000 香港特别行政区
## 922    0     0.014      924       3112   810000   810000 香港特别行政区
## 923    0     0.079      925       3114   810000   810000 香港特别行政区
## 924    0     0.011      926       3115   810000   810000 香港特别行政区</code></pre>
<p>Use <code>ggplot()</code> to plot the shape file:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="co"># Quick plot use ggplot</span></span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="kw">ggplot</span>(China_map, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group)) <span class="op">+</span></span>
<span id="cb37-3"><a href="#cb37-3"></a><span class="st">  </span><span class="kw">geom_path</span>(<span class="dt">color =</span> <span class="st">&quot;grey40&quot;</span>) <span class="op">+</span></span>
<span id="cb37-4"><a href="#cb37-4"></a><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">fill =</span> <span class="st">&#39;lightblue&#39;</span>)</span></code></pre></div>
<pre><code>## Regions defined for each Polygons</code></pre>
<p><img src="S20_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>This is certainly not very good-looking. Let’s first assign each province with an id:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="co"># Assign each province with an ID</span></span>
<span id="cb39-2"><a href="#cb39-2"></a>China_map2     &lt;-<span class="st"> </span><span class="kw">data.frame</span>(China_map, <span class="dt">id=</span><span class="kw">seq</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">924</span>)<span class="op">-</span><span class="dv">1</span>) </span>
<span id="cb39-3"><a href="#cb39-3"></a></span>
<span id="cb39-4"><a href="#cb39-4"></a><span class="co"># Join two data sets by NAME</span></span>
<span id="cb39-5"><a href="#cb39-5"></a>China_map_new  &lt;-<span class="st"> </span><span class="kw">join</span>(<span class="kw">fortify</span>(China_map), China_map2, <span class="dt">type =</span> <span class="st">&quot;full&quot;</span>)</span></code></pre></div>
<pre><code>## Regions defined for each Polygons</code></pre>
<pre><code>## Joining by: id</code></pre>
<p>Here we use the <code>fortify()</code> function to include the lat and lon information. Now the new shape file can be plotted as:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="co"># Plot the new shape file</span></span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="kw">ggplot</span>(China_map_new, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> id, <span class="dt">fill =</span> NAME)) <span class="op">+</span></span>
<span id="cb42-3"><a href="#cb42-3"></a><span class="st">  </span><span class="co"># Plot the border</span></span>
<span id="cb42-4"><a href="#cb42-4"></a><span class="st">  </span><span class="kw">geom_path</span>(<span class="dt">color =</span> <span class="st">&#39;grey40&#39;</span>) <span class="op">+</span></span>
<span id="cb42-5"><a href="#cb42-5"></a><span class="st">  </span><span class="kw">geom_polygon</span>() <span class="op">+</span></span>
<span id="cb42-6"><a href="#cb42-6"></a><span class="st">  </span><span class="co"># Using different colors</span></span>
<span id="cb42-7"><a href="#cb42-7"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">rainbow</span>(<span class="dv">33</span>), <span class="dt">guide =</span> F) <span class="op">+</span></span>
<span id="cb42-8"><a href="#cb42-8"></a><span class="st">  </span><span class="kw">coord_map</span>()</span></code></pre></div>
<p><img src="S20_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>We can also edit the original shape file by adding new information. For example, here we want to add both <code>NAME_EN</code> and <code>POP</code> onto the shape file:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="co"># Name in Chinese</span></span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="co"># This is the same as the NAME in the original shape file</span></span>
<span id="cb43-3"><a href="#cb43-3"></a>NAME    &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;北京市&quot;</span>  , <span class="st">&quot;天津市&quot;</span>   , <span class="st">&quot;河北省&quot;</span>      , <span class="st">&quot;山西省&quot;</span>   , <span class="st">&quot;内蒙古自治区&quot;</span>    , </span>
<span id="cb43-4"><a href="#cb43-4"></a>             <span class="st">&quot;辽宁省&quot;</span>  , <span class="st">&quot;吉林省&quot;</span>   , <span class="st">&quot;黑龙江省&quot;</span>    , <span class="st">&quot;上海市&quot;</span>   , <span class="st">&quot;江苏省&quot;</span>          , </span>
<span id="cb43-5"><a href="#cb43-5"></a>             <span class="st">&quot;浙江省&quot;</span>  , <span class="st">&quot;安徽省&quot;</span>   , <span class="st">&quot;福建省&quot;</span>      , <span class="st">&quot;江西省&quot;</span>   , <span class="st">&quot;山东省&quot;</span>          , </span>
<span id="cb43-6"><a href="#cb43-6"></a>             <span class="st">&quot;河南省&quot;</span>  , <span class="st">&quot;湖北省&quot;</span>   , <span class="st">&quot;湖南省&quot;</span>      , <span class="st">&quot;广东省&quot;</span>   , <span class="st">&quot;广西壮族自治区&quot;</span>  , </span>
<span id="cb43-7"><a href="#cb43-7"></a>             <span class="st">&quot;海南省&quot;</span>  , <span class="st">&quot;重庆市&quot;</span>   , <span class="st">&quot;四川省&quot;</span>      , <span class="st">&quot;贵州省&quot;</span>   , <span class="st">&quot;云南省&quot;</span>          , </span>
<span id="cb43-8"><a href="#cb43-8"></a>             <span class="st">&quot;西藏自治区&quot;</span>, <span class="st">&quot;陕西省&quot;</span> , <span class="st">&quot;甘肃省&quot;</span>      , <span class="st">&quot;青海省&quot;</span>   , <span class="st">&quot;宁夏回族自治区&quot;</span>  , </span>
<span id="cb43-9"><a href="#cb43-9"></a>             <span class="st">&quot;新疆维吾尔自治区&quot;</span>     , <span class="st">&quot;台湾省&quot;</span>      , <span class="st">&quot;香港特别行政区&quot;</span>)</span>
<span id="cb43-10"><a href="#cb43-10"></a></span>
<span id="cb43-11"><a href="#cb43-11"></a><span class="co"># Name in English accordingly</span></span>
<span id="cb43-12"><a href="#cb43-12"></a>NAME_EN &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Beijing&quot;</span> , <span class="st">&quot;Tianjin&quot;</span>  , <span class="st">&quot;Hebei&quot;</span>       , <span class="st">&quot;Shanxi&quot;</span>   , <span class="st">&quot;Inner Mongolia&quot;</span>  ,</span>
<span id="cb43-13"><a href="#cb43-13"></a>             <span class="st">&quot;Liaoning&quot;</span>, <span class="st">&quot;Jilin&quot;</span>    , <span class="st">&quot;Heilongjiang&quot;</span>, <span class="st">&quot;Shanghai&quot;</span> , <span class="st">&quot;Jiangsu&quot;</span>         ,</span>
<span id="cb43-14"><a href="#cb43-14"></a>             <span class="st">&quot;Zhejiang&quot;</span>, <span class="st">&quot;Anhui&quot;</span>    , <span class="st">&quot;Fujian&quot;</span>      , <span class="st">&quot;Jiangxi&quot;</span>  , <span class="st">&quot;Shandong&quot;</span>        ,</span>
<span id="cb43-15"><a href="#cb43-15"></a>             <span class="st">&quot;Henan&quot;</span>   , <span class="st">&quot;Hubei&quot;</span>    , <span class="st">&quot;Hunan&quot;</span>       , <span class="st">&quot;Guangdong&quot;</span>, <span class="st">&quot;Guangxi&quot;</span>         ,</span>
<span id="cb43-16"><a href="#cb43-16"></a>             <span class="st">&quot;Hainan&quot;</span>  , <span class="st">&quot;Chongqing&quot;</span>, <span class="st">&quot;Sichuan&quot;</span>     , <span class="st">&quot;Guizhou&quot;</span>  , <span class="st">&quot;Yunnan&quot;</span>          ,</span>
<span id="cb43-17"><a href="#cb43-17"></a>             <span class="st">&quot;Tibet&quot;</span>   , <span class="st">&quot;Shaanxi&quot;</span>  , <span class="st">&quot;Gansu&quot;</span>       , <span class="st">&quot;Qinghai&quot;</span>  , <span class="st">&quot;Ningxia&quot;</span>         ,</span>
<span id="cb43-18"><a href="#cb43-18"></a>             <span class="st">&quot;Xinjiang&quot;</span>             , <span class="st">&quot;Taiwan&quot;</span>      , <span class="st">&quot;Hong Kong&quot;</span>     )</span>
<span id="cb43-19"><a href="#cb43-19"></a></span>
<span id="cb43-20"><a href="#cb43-20"></a><span class="co"># Population of each province, from the 2021 census</span></span>
<span id="cb43-21"><a href="#cb43-21"></a>Pop     &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">21893095</span>  , <span class="dv">13866009</span>   , <span class="dv">74610235</span>      ,  <span class="dv">34915616</span>  ,  <span class="dv">24049155</span>         , </span>
<span id="cb43-22"><a href="#cb43-22"></a>             <span class="dv">42591407</span>  , <span class="dv">24073453</span>   , <span class="dv">31850088</span>      ,  <span class="dv">24870895</span>  ,  <span class="dv">84748016</span>         , </span>
<span id="cb43-23"><a href="#cb43-23"></a>             <span class="dv">64567588</span>  , <span class="dv">61027171</span>   , <span class="dv">41540086</span>      ,  <span class="dv">45188635</span>  , <span class="dv">101527453</span>         , </span>
<span id="cb43-24"><a href="#cb43-24"></a>             <span class="dv">99365519</span>  , <span class="dv">57752557</span>   , <span class="dv">66444864</span>      , <span class="dv">126012510</span>  ,  <span class="dv">50126804</span>         , </span>
<span id="cb43-25"><a href="#cb43-25"></a>             <span class="dv">10081232</span>  , <span class="dv">32054159</span>   , <span class="dv">83674866</span>      ,  <span class="dv">38562148</span>  ,  <span class="dv">47209277</span>         , </span>
<span id="cb43-26"><a href="#cb43-26"></a>              <span class="dv">3648100</span>  , <span class="dv">39528999</span>   , <span class="dv">25019831</span>      ,   <span class="dv">5923957</span>  ,   <span class="dv">7202654</span>         , </span>
<span id="cb43-27"><a href="#cb43-27"></a>             <span class="dv">25852345</span>               , <span class="dv">23561236</span>      ,   <span class="dv">7474200</span>       )</span>
<span id="cb43-28"><a href="#cb43-28"></a></span>
<span id="cb43-29"><a href="#cb43-29"></a><span class="co"># Make data frame</span></span>
<span id="cb43-30"><a href="#cb43-30"></a>Popdata &lt;-<span class="st"> </span><span class="kw">data.frame</span>(NAME, NAME_EN, Pop)</span>
<span id="cb43-31"><a href="#cb43-31"></a></span>
<span id="cb43-32"><a href="#cb43-32"></a><span class="co"># Joint the data by NAME</span></span>
<span id="cb43-33"><a href="#cb43-33"></a>China_map_pop &lt;-<span class="st"> </span><span class="kw">join</span>(China_map_new, Popdata, <span class="dt">type =</span> <span class="st">&quot;full&quot;</span>)</span></code></pre></div>
<pre><code>## Joining by: NAME</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="co"># Plot</span></span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="kw">ggplot</span>(China_map_pop, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> id, <span class="dt">fill =</span> Pop)) <span class="op">+</span></span>
<span id="cb45-3"><a href="#cb45-3"></a><span class="st">  </span><span class="kw">geom_polygon</span>() <span class="op">+</span></span>
<span id="cb45-4"><a href="#cb45-4"></a><span class="st">  </span><span class="kw">geom_path</span>(<span class="dt">color =</span> <span class="st">&quot;grey40&quot;</span>) <span class="op">+</span></span>
<span id="cb45-5"><a href="#cb45-5"></a><span class="st">  </span><span class="kw">coord_map</span>()</span></code></pre></div>
<p><img src="S20_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>With some efforts, this can plot can be made much better:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="kw">ggplot</span>(China_map_pop, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group, <span class="dt">fill=</span>Pop)) <span class="op">+</span></span>
<span id="cb46-2"><a href="#cb46-2"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;Population&quot;</span>)<span class="op">+</span></span>
<span id="cb46-3"><a href="#cb46-3"></a><span class="st">  </span><span class="kw">geom_polygon</span>()<span class="op">+</span></span>
<span id="cb46-4"><a href="#cb46-4"></a><span class="st">  </span><span class="kw">geom_path</span>(<span class="dt">color =</span> <span class="st">&quot;grey40&quot;</span>)<span class="op">+</span></span>
<span id="cb46-5"><a href="#cb46-5"></a><span class="st">  </span><span class="co"># Try a different color theme</span></span>
<span id="cb46-6"><a href="#cb46-6"></a><span class="st">  </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours=</span><span class="kw">rev</span>(<span class="kw">heat.colors</span>(<span class="dv">20</span>)),<span class="dt">na.value=</span><span class="st">&quot;grey90&quot;</span>,</span>
<span id="cb46-7"><a href="#cb46-7"></a>                       <span class="dt">guide =</span> <span class="kw">guide_colourbar</span>(<span class="dt">barwidth =</span> <span class="fl">0.8</span>, <span class="dt">barheight =</span> <span class="dv">10</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb46-8"><a href="#cb46-8"></a><span class="st">  </span><span class="co"># Projects a portion of the earth</span></span>
<span id="cb46-9"><a href="#cb46-9"></a><span class="st">  </span><span class="kw">coord_map</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb46-10"><a href="#cb46-10"></a><span class="st">  </span><span class="co"># Change theme</span></span>
<span id="cb46-11"><a href="#cb46-11"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb46-12"><a href="#cb46-12"></a><span class="st">  </span><span class="co"># Change labels</span></span>
<span id="cb46-13"><a href="#cb46-13"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;Population&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Longitude&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Latitude&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb46-14"><a href="#cb46-14"></a><span class="st">  </span><span class="co"># Add map scale</span></span>
<span id="cb46-15"><a href="#cb46-15"></a><span class="st">  </span>ggsn<span class="op">::</span><span class="kw">scalebar</span>(<span class="dt">data =</span> China_map_pop, <span class="dt">dist =</span> <span class="dv">500</span>, <span class="dt">dist_unit =</span> <span class="st">&quot;km&quot;</span>,</span>
<span id="cb46-16"><a href="#cb46-16"></a>                 <span class="dt">border.size =</span> <span class="fl">0.4</span>, <span class="dt">st.size =</span> <span class="dv">2</span>,</span>
<span id="cb46-17"><a href="#cb46-17"></a>                 <span class="dt">box.fill =</span> <span class="kw">c</span>(<span class="st">&#39;black&#39;</span>,<span class="st">&#39;white&#39;</span>),</span>
<span id="cb46-18"><a href="#cb46-18"></a>                 <span class="dt">transform =</span> <span class="ot">TRUE</span>, <span class="dt">model =</span> <span class="st">&quot;WGS84&quot;</span>) </span></code></pre></div>
<p><img src="S20_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>You can only select one (or more) province and add one point to the plot:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="co">## Extract Guangdong and Hong Kong from the data</span></span>
<span id="cb47-2"><a href="#cb47-2"></a>GD_HK &lt;-<span class="st"> </span><span class="kw">subset</span>(China_map_pop, NAME <span class="op">==</span><span class="st"> &quot;广东省&quot;</span> <span class="op">|</span><span class="st"> </span>NAME <span class="op">==</span><span class="st"> &quot;香港特别行政区&quot;</span>) </span>
<span id="cb47-3"><a href="#cb47-3"></a></span>
<span id="cb47-4"><a href="#cb47-4"></a><span class="co"># Plot</span></span>
<span id="cb47-5"><a href="#cb47-5"></a><span class="kw">ggplot</span>(GD_HK,<span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> id)) <span class="op">+</span></span>
<span id="cb47-6"><a href="#cb47-6"></a><span class="st">  </span><span class="co"># Polygon</span></span>
<span id="cb47-7"><a href="#cb47-7"></a><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="op">+</span></span>
<span id="cb47-8"><a href="#cb47-8"></a><span class="st">  </span><span class="co"># Border</span></span>
<span id="cb47-9"><a href="#cb47-9"></a><span class="st">  </span><span class="kw">geom_path</span>(<span class="dt">color =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="op">+</span></span>
<span id="cb47-10"><a href="#cb47-10"></a><span class="st">  </span><span class="co"># Add one point: SUSTech (lat:22.59670, lon:113.98201)</span></span>
<span id="cb47-11"><a href="#cb47-11"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">x =</span> <span class="fl">113.98201</span>, <span class="dt">y =</span> <span class="fl">22.59670</span>, <span class="dt">fill =</span> <span class="ot">NA</span>) <span class="op">+</span></span>
<span id="cb47-12"><a href="#cb47-12"></a><span class="st">  </span><span class="co"># Add label</span></span>
<span id="cb47-13"><a href="#cb47-13"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">113.98201</span>, <span class="dt">y =</span> <span class="fl">22.59670+0.25</span>, <span class="dt">label =</span> <span class="st">&quot;SUSTech&quot;</span>) <span class="op">+</span></span>
<span id="cb47-14"><a href="#cb47-14"></a><span class="st">  </span><span class="co"># Projects a portion of the earth</span></span>
<span id="cb47-15"><a href="#cb47-15"></a><span class="st">  </span><span class="kw">coord_map</span>()</span></code></pre></div>
<p><img src="S20_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<hr />
</div>
<div id="interactive-maps" class="section level1">
<h1>Interactive maps</h1>
<p>There are many ways of plotting an interactive map. Here we show you how to do this with the <code>leafletCN</code> package, you are welcome to explore other tools.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="co"># Change to a data frame, as required by the next step</span></span>
<span id="cb48-2"><a href="#cb48-2"></a>China_map_pop2 &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(China_map_pop)</span>
<span id="cb48-3"><a href="#cb48-3"></a></span>
<span id="cb48-4"><a href="#cb48-4"></a><span class="co"># Make a interactive map</span></span>
<span id="cb48-5"><a href="#cb48-5"></a><span class="kw">geojsonMap</span>(<span class="dt">dat =</span> China_map_pop2, <span class="dt">mapName =</span> <span class="st">&quot;China&quot;</span>,</span>
<span id="cb48-6"><a href="#cb48-6"></a>           <span class="co"># Use name and population as the key information</span></span>
<span id="cb48-7"><a href="#cb48-7"></a>           <span class="dt">namevar =</span> <span class="op">~</span><span class="st"> </span>NAME, <span class="dt">valuevar =</span> <span class="op">~</span><span class="st"> </span>Pop, </span>
<span id="cb48-8"><a href="#cb48-8"></a>           <span class="co"># Pop up information</span></span>
<span id="cb48-9"><a href="#cb48-9"></a>           <span class="dt">popup =</span>  <span class="kw">paste0</span>(China_map_pop2<span class="op">$</span>NAME, <span class="st">&quot;: &quot;</span>, China_map_pop2<span class="op">$</span>Pop),</span>
<span id="cb48-10"><a href="#cb48-10"></a>           <span class="co"># Colors</span></span>
<span id="cb48-11"><a href="#cb48-11"></a>           <span class="dt">palette =</span> <span class="st">&quot;Reds&quot;</span>, </span>
<span id="cb48-12"><a href="#cb48-12"></a>           <span class="co"># Add legend</span></span>
<span id="cb48-13"><a href="#cb48-13"></a>           <span class="dt">legendTitle =</span> <span class="st">&quot;Population&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-3512f15d2169f3cc1ac5" style="width:672px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-3512f15d2169f3cc1ac5">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["http://webrd02.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=8&x={x}&y={y}&z={z}",{"minZoom":3,"maxZoom":17,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false},null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://amap.com\">amp.com<\/a >"}]},{"method":"addPolygons","args":[[[[{"lng":[96.416,96.416,95.9766,96.0645,96.2402,95.9766,95.2734,95.1855,94.5703,94.043,93.8672,93.0762,92.6367,92.373,92.373,92.373,90.1758,90.3516,90.6152,90.5273,91.0547,91.3184,90.7031,90.791,91.0547,91.0547,90.8789,90,89.9121,89.7363,89.209,88.7695,88.5938,87.3633,86.2207,86.1328,85.6055,85.0781,84.1992,83.1445,82.8809,82.4414,82.002,81.6504,80.4199,80.2441,80.332,80.2441,79.8926,79.8047,79.1016,79.0137,78.2227,78.0469,78.0469,77.4316,76.8164,76.5527,76.2012,75.9375,76.0254,75.8496,75.498,75.4102,75.0586,74.8828,74.7949,74.5313,74.5313,74.8828,75.1465,74.8828,74.9707,74.8828,74.3555,74.1797,74.0918,73.8281,73.7402,73.8281,73.4766,73.916,73.916,73.8281,74.0039,74.8828,74.7949,75.2344,75.5859,75.7617,76.377,76.9043,77.6074,78.1348,78.1348,80.1563,80.2441,80.1563,80.2441,80.5078,80.4199,80.7715,80.4199,80.4199,79.9805,79.9805,81.7383,82.0898,82.5293,82.2656,83.0566,83.6719,84.7266,84.9023,85.5176,85.6934,85.5176,85.7813,86.5723,86.8359,86.748,86.8359,87.8027,87.8906,87.7148,88.0664,87.9785,88.5059,88.6816,89.1211,89.5605,89.7363,90.0879,90.3516,90.5273,90.8789,91.0547,90.8789,91.0547,90.7031,90.7031,90.8789,91.582,93.5156,94.7461,95.3613,95.3613,95.5371,95.8887,96.3281,96.416],"lat":[42.7588,42.7148,42.4951,42.3193,42.2314,41.9238,41.6162,41.792,41.4844,41.0889,40.6934,40.6494,39.6387,39.3311,39.1113,39.0234,38.4961,38.2324,38.3203,37.8369,37.4414,37.0898,36.7822,36.6064,36.5186,36.0791,36.0352,36.2549,36.0791,36.0791,36.2988,36.3428,36.4746,36.4307,36.167,35.8594,35.6836,35.7275,35.376,35.4199,35.6836,35.7275,35.332,35.2441,35.4199,35.2881,35.1563,35.2002,34.8047,34.4971,34.4531,34.3213,34.7168,35.2441,35.5078,35.4639,35.6396,35.8594,35.8154,36.0352,36.4746,36.6943,36.7383,36.958,37.002,36.9141,37.0459,37.0898,37.2217,37.2217,37.4414,37.5732,37.749,38.4521,38.6719,38.6719,38.54,38.584,38.8477,38.9795,39.375,39.5068,39.6826,39.7705,40.0342,40.3418,40.5176,40.4297,40.6494,40.2979,40.3857,41.001,41.001,41.2207,41.3965,42.0557,42.2754,42.627,42.8467,42.8906,43.0664,43.1982,44.165,44.6045,44.8242,44.9561,45.3955,45.2197,45.2197,45.6592,47.2412,47.0215,47.0215,46.8896,47.0654,47.2852,48.1201,48.4277,48.5596,48.8232,48.9551,49.1309,49.1748,48.999,48.9111,48.7354,48.6035,48.3838,48.1641,47.9883,48.0322,47.8564,47.8564,47.6807,47.2412,46.9775,46.582,46.3184,46.0107,45.7471,45.5273,45.2197,45.0879,44.9561,44.3408,44.2969,44.0332,43.9014,43.2422,42.9346,42.7588]}]],[[{"lng":[79.0137,79.1016,79.8047,79.8926,80.2441,80.332,80.2441,80.4199,81.6504,82.002,82.4414,82.8809,83.1445,84.1992,85.0781,85.6055,86.1328,86.2207,87.3633,88.5938,88.7695,89.209,89.7363,89.3848,89.4727,89.7363,89.7363,89.4727,89.4727,89.5605,89.8242,89.7363,89.8242,89.6484,90.0879,90.7031,91.4063,91.9336,92.1973,92.2852,92.9883,93.5156,93.7793,94.1309,94.6582,95.1855,95.0098,95.1855,95.2734,95.3613,95.3613,95.4492,95.8008,95.9766,96.1523,96.2402,96.5039,96.8555,96.7676,97.2949,97.3828,97.7344,98.1738,98.4375,98.877,98.6133,98.9648,99.1406,98.9648,98.9648,98.7891,98.7891,98.7012,98.6133,98.7891,98.7012,98.3496,98.2617,98.1738,97.5586,97.2949,97.3828,97.0313,96.5039,95.7129,95.3613,95.2734,94.2188,93.8672,93.6035,92.1094,92.0215,91.582,91.582,91.4063,91.0547,90.7031,89.8242,89.6484,89.1211,89.1211,89.0332,88.7695,88.8574,88.6816,88.1543,87.8906,87.7148,87.0996,86.748,86.5723,86.4844,86.1328,86.0449,85.6934,85.6055,85.166,85.166,84.9023,84.4629,84.2871,84.1992,84.1113,83.584,83.2324,82.1777,82.0898,81.3867,81.2109,81.0352,80.0684,79.7168,79.0137,78.75,78.8379,78.6621,78.75,78.4863,78.3984,78.75,78.9258,79.2773,79.1016,78.6621,78.6621,78.9258,79.0137],"lat":[34.3213,34.4531,34.4971,34.8047,35.2002,35.1563,35.2881,35.4199,35.2441,35.332,35.7275,35.6836,35.4199,35.376,35.7275,35.6836,35.8594,36.167,36.4307,36.4746,36.3428,36.2988,36.0791,36.0352,35.9033,35.7715,35.4199,35.376,35.2441,34.8926,34.8486,34.6729,34.3652,34.0137,33.4863,33.1348,33.1348,32.8271,32.8271,32.7393,32.7393,32.4756,32.5635,32.4316,32.6074,32.4316,32.2998,32.3438,32.2119,32.168,31.9922,31.8164,31.6846,31.8164,31.5967,31.9482,31.7285,31.6846,31.9922,32.0801,32.5635,32.5195,32.3438,31.8604,31.4209,31.2012,30.7617,29.2676,29.1357,28.8281,28.8721,29.0039,28.916,28.5205,28.3447,28.2129,28.125,28.3887,28.125,28.5205,28.0811,27.9053,27.7295,28.125,28.2568,28.125,27.9492,27.5537,27.0264,26.9385,26.8506,27.4658,27.5537,27.9053,28.0371,27.8613,28.0811,28.2129,28.1689,27.5977,27.334,27.2021,27.4219,27.9932,28.125,27.9053,27.9492,27.8174,27.8174,28.125,28.125,27.9053,28.125,27.9053,28.3447,28.2568,28.3447,28.6523,28.5645,28.7402,28.8721,29.2236,29.2676,29.1797,29.5752,30.0586,30.3223,30.3662,30.0146,30.2344,30.5859,30.9375,31.0693,31.333,31.5967,31.8164,31.9043,32.124,32.5195,32.6953,32.3438,32.5635,33.1787,33.6621,34.1016,34.1455,34.3213]}]],[[{"lng":[97.207,99.4922,100.8105,101.7773,102.041,102.7441,103.3594,103.8867,104.502,104.502,105.0293,105.7324,107.4023,109.4238,110.3906,111.0059,111.9727,111.9727,111.4453,111.7969,111.9727,113.6426,114.1699,114.5215,115.6641,116.1914,116.2793,116.543,117.334,117.4219,117.7734,118.3008,118.7402,118.916,119.0918,119.707,119.9707,119.707,118.4766,117.8613,117.334,116.8066,116.1914,115.9277,115.5762,115.4883,115.8398,115.8398,116.7188,117.7734,118.5645,119.2676,119.3555,119.1797,119.5313,119.5313,119.707,120.1465,120.6738,120.7617,120.7617,120.5859,120.6738,120.4102,120.0586,120.0586,120.8496,121.4648,121.8164,121.2012,121.6406,121.7285,121.9922,122.168,122.6953,122.6074,122.959,123.3105,123.6621,124.3652,124.541,124.8926,125.0684,125.332,126.0352,125.7715,125.7715,125.332,125.1563,125.2441,124.8047,124.4531,124.2773,122.4316,123.0469,123.3984,123.3984,123.4863,123.5742,123.5742,123.5742,123.0469,123.2227,122.7832,122.6953,122.4316,122.2559,121.8164,121.7285,121.9043,122.2559,122.0801,122.3438,123.1348,123.4863,123.3105,123.6621,123.5742,123.3105,123.1348,122.7832,122.3438,122.3438,121.9922,121.7285,121.4648,120.498,120.1465,119.8828,119.5313,119.3555,119.2676,119.4434,119.2676,118.3887,118.125,118.3008,118.3008,118.125,117.9492,118.0371,117.7734,117.5098,117.334,116.8945,116.8066,116.2793,116.0156,115.9277,115.2246,114.9609,114.873,114.5215,114.1699,114.2578,113.9063,113.9941,113.9063,114.082,114.082,113.8184,113.5547,113.2031,112.7637,112.3242,111.9727,111.4453,111.3574,111.0938,111.0938,110.6543,110.127,110.2148,109.8633,109.9512,108.9844,109.0723,108.8965,108.8086,108.7207,108.1934,107.666,107.3145,106.7871,106.5234,106.9629,106.7871,106.3477,105.9082,105.8203,104.3262,103.4473,103.3594,103.5352,103.4473,104.2383,104.0625,103.3594,103.0078,102.4805,101.8652,102.041,101.7773,101.3379,101.25,100.9863,100.8105,100.5469,100.0195,99.4922,100.1074,100.1953,99.9316,99.2285,99.0527,98.9648,98.7891,98.5254,98.6133,98.3496,98.3496,97.4707,97.8223,97.8223,97.207],"lat":[42.8027,42.583,42.6709,42.4951,42.2314,42.1436,41.8799,41.792,41.8799,41.6602,41.5723,41.9238,42.4512,42.4512,42.7588,43.3301,43.6816,43.8135,44.3848,45,45.0879,44.7363,44.9561,45.3955,45.4395,45.7031,45.9668,46.2744,46.3623,46.582,46.5381,46.7578,46.7139,46.7578,46.6699,46.626,46.7139,47.1973,47.9883,48.0322,47.6807,47.9004,47.8564,47.6807,47.9004,48.1641,48.252,48.5596,49.834,49.5264,49.9219,50.0977,50.3174,50.3613,50.7568,50.8887,51.0645,51.6797,51.9434,52.1191,52.251,52.3389,52.5146,52.6465,52.6025,52.7344,53.2617,53.3496,53.042,52.5586,52.4268,52.2949,52.2949,52.5146,52.251,52.0752,51.3281,51.2402,51.3721,51.2842,51.3721,51.3721,51.6357,51.6357,51.0205,50.7568,50.5371,50.1416,49.834,49.1748,49.1309,48.1201,48.5156,47.373,46.7139,46.8896,46.9775,46.9775,46.8457,46.8896,46.6699,46.582,46.2305,46.0107,45.7031,45.8789,45.791,46.0107,45.7471,45.7031,45.2637,44.8682,44.2529,44.4727,43.7256,43.5059,43.374,43.0225,42.9785,42.8027,42.7148,42.8467,42.6709,42.7148,42.4512,42.4951,42.0996,41.7041,42.1875,42.3633,42.2754,41.7041,41.6162,41.3086,41.3086,41.748,41.792,42.0996,42.0557,42.2314,42.4072,42.627,42.583,42.4512,42.4072,42.0117,42.0117,41.792,41.9238,41.5723,41.6162,42.0996,42.1436,41.792,41.5723,41.4404,41.2207,41.1328,40.7373,40.5176,40.5176,40.3418,40.3857,40.166,40.2539,39.5947,39.6387,39.4189,39.375,39.5947,39.2871,39.4629,39.2871,39.2432,39.1553,38.3203,38.0127,37.9688,38.0127,37.7051,37.6172,37.8809,38.1006,38.1885,38.3203,38.9795,39.375,39.2871,38.7158,37.793,37.4414,37.8369,38.0127,38.1445,38.3643,38.9795,39.4189,39.3311,39.1113,39.2432,39.1113,38.8916,38.6719,38.7598,39.0234,38.9355,39.4189,39.4189,39.7705,39.8584,40.2539,40.6494,41.001,40.8691,40.6934,40.7813,40.6055,40.7373,40.6494,40.5615,40.9131,41.4844,41.6162,41.748,42.8027]}]],[[{"lng":[89.7363,89.9121,90,90.8789,91.0547,91.0547,90.791,90.7031,91.3184,91.0547,90.5273,90.6152,90.3516,90.1758,92.373,92.373,93.1641,93.1641,93.6914,93.8672,94.3066,94.5703,95.0098,95.4492,95.7129,96.2402,96.416,96.6797,96.6797,97.1191,97.0313,98.1738,98.3496,98.6133,98.7891,99.1406,99.8438,100.1953,100.0195,100.1074,100.459,100.7227,101.1621,101.5137,101.7773,101.9531,102.1289,102.5684,102.4805,102.6563,102.5684,102.832,103.0078,102.9199,102.9199,102.6563,102.832,102.4805,102.3047,102.3926,101.9531,101.9531,102.2168,102.1289,101.6895,100.9863,100.8105,101.25,101.5137,101.6016,101.7773,101.6895,101.7773,101.6016,101.1621,101.25,100.7227,100.7227,100.3711,100.1074,100.1074,99.8438,99.7559,99.2285,99.2285,98.877,98.4375,97.8223,97.6465,97.7344,97.3828,97.4707,97.7344,97.3828,97.4707,97.7344,97.3828,97.2949,96.7676,96.8555,96.5039,96.2402,96.1523,95.9766,95.8008,95.4492,95.3613,95.3613,95.2734,95.1855,95.0098,95.1855,94.6582,94.1309,93.7793,93.5156,92.9883,92.2852,92.1973,91.9336,91.4063,90.7031,90.0879,89.6484,89.8242,89.7363,89.8242,89.5605,89.4727,89.4727,89.7363,89.7363,89.4727,89.3848,89.7363],"lat":[36.0791,36.0791,36.2549,36.0352,36.0791,36.5186,36.6064,36.7822,37.0898,37.4414,37.8369,38.3203,38.2324,38.4961,39.0234,39.1113,39.1992,38.9795,38.9355,38.7158,38.7598,38.3643,38.4082,38.2764,38.3643,38.1006,38.2324,38.1885,38.4521,38.584,39.1992,38.8037,39.0234,38.9355,39.0674,38.9355,38.3643,38.2764,38.4521,38.4961,38.2764,38.2324,37.8369,37.8809,37.6172,37.7051,37.4414,37.1777,36.958,36.8262,36.7383,36.3428,36.2549,36.0791,35.9033,35.7715,35.5957,35.5957,35.4199,35.2002,34.8486,34.6289,34.4092,34.2773,34.1016,34.3652,34.2773,33.6621,33.7061,33.5303,33.5303,33.3105,33.2227,33.1348,33.2227,32.6953,32.6514,32.5195,32.7393,32.6514,32.8711,33.0029,32.7393,32.915,33.0469,33.1787,34.0576,34.1895,34.1016,33.9258,33.8818,33.5742,33.3984,32.8711,32.6953,32.5195,32.5635,32.0801,31.9922,31.6846,31.7285,31.9482,31.5967,31.8164,31.6846,31.8164,31.9922,32.168,32.2119,32.3438,32.2998,32.4316,32.6074,32.4316,32.5635,32.4756,32.7393,32.7393,32.8271,32.8271,33.1348,33.1348,33.4863,34.0137,34.3652,34.6729,34.8486,34.8926,35.2441,35.376,35.4199,35.7715,35.9033,36.0352,36.0791]}]],[[{"lng":[101.7773,101.8652,101.9531,101.8652,102.4805,102.2168,102.9199,103.0957,103.1836,104.1504,104.2383,104.4141,104.3262,104.4141,104.3262,104.4141,105.2051,105.3809,105.3809,105.4688,105.5566,106.084,106.084,106.3477,107.0508,107.1387,107.2266,107.4023,108.0176,108.2813,108.5449,108.3691,108.2813,108.5449,108.1934,107.9297,107.4902,107.4023,107.4902,107.0508,106.7871,106.6113,106.2598,105.8203,105.6445,105.5566,105.7324,105.293,105.4688,105.7324,105.8203,106.2598,106.3477,105.9961,105.6445,105.9082,106.1719,106.3477,105.6445,105.5566,105.293,105.2051,105.0293,104.8535,104.4141,104.3262,104.4141,104.4141,104.2383,104.4141,103.8867,103.7988,103.4473,103.4473,102.9199,103.0078,102.6563,102.5684,102.1289,101.8652,101.6016,101.6895,101.4258,101.4258,101.4258,101.1621,101.1621,100.7227,100.3711,100.2832,100.0195,100.1953,99.668,99.4043,99.4043,99.2285,99.1406,98.9648,98.6133,98.877,98.4375,98.1738,97.7344,97.4707,97.3828,97.7344,97.4707,97.3828,97.7344,97.6465,97.8223,98.4375,98.877,99.2285,99.2285,99.7559,99.8438,100.1074,100.1074,100.3711,100.7227,100.7227,101.25,101.1621,101.6016,101.7773,101.6895,101.7773],"lat":[33.5303,33.5742,33.4424,33.0908,33.4424,33.9258,34.3213,34.1895,33.7939,33.6182,33.3984,33.3105,33.2227,33.0469,32.8711,32.7393,32.6074,32.7393,32.8711,32.915,32.7393,32.8711,32.7393,32.6514,32.6953,32.4756,32.4316,32.5195,32.168,32.2559,32.2119,32.168,31.9043,31.6846,31.5088,30.8496,30.8496,30.7617,30.6299,30.0146,30.0146,30.3223,30.1904,30.4541,30.2783,30.1025,29.8828,29.5313,29.3115,29.2676,28.96,28.8721,28.5205,28.7402,28.4326,28.125,28.125,27.8174,27.6416,27.7734,27.7295,27.9932,28.0811,27.9053,27.9492,28.0371,28.125,28.2568,28.4326,28.6084,28.6523,28.3008,28.125,27.7734,27.29,26.3672,26.1914,26.3672,26.1035,26.0596,26.2354,26.3672,26.5869,26.8066,26.7188,27.0264,27.1582,27.8613,27.8174,27.7295,28.125,28.3447,28.8281,28.5205,28.1689,28.3008,29.2676,30.7617,31.2012,31.4209,31.8604,32.3438,32.5195,32.6953,32.8711,33.3984,33.5742,33.8818,33.9258,34.1016,34.1895,34.0576,33.1787,33.0469,32.915,32.7393,33.0029,32.8711,32.6514,32.7393,32.5195,32.6514,32.6953,33.2227,33.1348,33.2227,33.3105,33.5303]}]],[[{"lng":[121.4648,123.6621,124.8926,125.0684,125.5957,125.6836,126.123,126.0352,126.2109,126.3867,126.3867,126.5625,126.4746,126.9141,126.8262,127.002,126.9141,127.2656,127.3535,127.6172,127.5293,127.793,128.7598,129.1113,129.4629,130.2539,130.6934,130.5176,130.8691,130.6934,131.0449,132.5391,132.627,133.0664,133.5059,134.209,135.0879,134.7363,134.5605,134.7363,134.5605,134.3848,134.209,134.209,133.8574,133.9453,133.5059,133.418,133.2422,133.0664,132.8906,131.9238,131.5723,131.0449,131.3086,131.2207,131.3086,130.8691,130.5176,130.3418,129.9902,129.9023,129.8145,129.2871,129.1992,128.8477,128.4961,128.4082,128.0566,128.0566,127.7051,127.5293,127.0898,127.002,127.0898,126.9141,126.5625,126.0352,125.7715,125.6836,125.0684,124.8926,124.3652,124.0137,123.9258,123.2227,123.0469,123.5742,123.5742,123.5742,123.4863,123.3984,123.3984,123.0469,122.4316,124.2773,124.4531,124.8047,125.2441,125.1563,125.332,125.7715,125.7715,126.0352,125.332,125.0684,124.8926,124.541,124.3652,123.6621,123.3105,122.959,122.6074,122.6953,122.168,121.9922,121.7285,121.6406,121.2012,121.8164,121.4648],"lat":[53.3496,53.5693,53.0859,53.2178,53.0859,52.9102,52.7783,52.6025,52.5146,52.2949,52.207,52.1631,51.9434,51.3721,51.2842,51.3281,51.1084,50.7568,50.2734,50.2295,49.8779,49.6143,49.5703,49.3506,49.4385,48.8672,48.8672,48.6475,48.2959,48.1201,47.6807,47.7246,47.9443,48.1201,48.1201,48.3838,48.4277,48.252,47.9883,47.6807,47.4609,47.4609,47.2852,47.1533,46.5381,46.2744,45.835,45.5713,45.5273,45.1318,45.0439,45.3516,45.0439,44.8682,44.0771,43.7256,43.4619,43.418,43.6377,43.9893,43.8574,44.0332,43.9014,43.8135,43.5938,43.5498,44.165,44.4727,44.3408,44.1211,44.1211,44.6045,44.6045,44.7803,45,45.1318,45.2637,45.1758,45.3076,45.5273,45.3955,45.5273,45.4395,45.7471,46.2305,46.2305,46.582,46.6699,46.8896,46.8457,46.9775,46.9775,46.8896,46.7139,47.373,48.5156,48.1201,49.1309,49.1748,49.834,50.1416,50.5371,50.7568,51.0205,51.6357,51.6357,51.3721,51.3721,51.2842,51.3721,51.2402,51.3281,52.0752,52.251,52.5146,52.2949,52.2949,52.4268,52.5586,53.042,53.3496]}]],[[{"lng":[96.416,97.207,97.8223,97.8223,97.4707,98.3496,98.3496,98.6133,98.5254,98.7891,98.9648,99.0527,99.2285,99.9316,100.1953,100.1074,99.4922,100.0195,100.5469,100.8105,100.9863,101.25,101.3379,101.7773,102.041,101.8652,102.4805,103.0078,103.3594,104.0625,104.2383,103.4473,103.5352,103.3594,103.4473,104.3262,104.5898,104.5898,104.8535,105.293,105.2051,105.4688,105.293,105.3809,105.7324,105.8203,105.9961,105.9082,105.9961,106.084,106.2598,106.3477,106.5234,106.4355,106.6992,106.9629,106.875,106.5234,106.5234,106.4355,106.6113,106.6113,107.3145,107.3145,108.7207,108.6328,108.5449,108.6328,108.5449,107.7539,107.7539,107.8418,107.666,107.2266,106.9629,106.6113,106.5234,106.3477,106.6992,106.5234,106.6113,106.4355,106.5234,105.9961,105.7324,105.9961,105.9082,105.4688,105.3809,105.3809,105.2051,104.4141,104.3262,104.4141,104.3262,104.4141,104.2383,104.1504,103.1836,103.0957,102.9199,102.2168,102.4805,101.8652,101.9531,101.8652,101.7773,101.6016,101.5137,101.25,100.8105,100.9863,101.6895,102.1289,102.2168,101.9531,101.9531,102.3926,102.3047,102.4805,102.832,102.6563,102.9199,102.9199,103.0078,102.832,102.5684,102.6563,102.4805,102.5684,102.1289,101.9531,101.7773,101.5137,101.1621,100.7227,100.459,100.1074,100.0195,100.1953,99.8438,99.1406,98.7891,98.6133,98.3496,98.1738,97.0313,97.1191,96.6797,96.6797,96.416,96.2402,95.7129,95.4492,95.0098,94.5703,94.3066,93.8672,93.6914,93.1641,93.1641,92.373,92.373,92.6367,93.0762,93.8672,94.043,94.5703,95.1855,95.2734,95.9766,96.2402,96.0645,95.9766,96.416],"lat":[42.7148,42.8027,41.748,41.6162,41.4844,40.9131,40.5615,40.6494,40.7373,40.6055,40.7813,40.6934,40.8691,41.001,40.6494,40.2539,39.8584,39.7705,39.4189,39.4189,38.9355,39.0234,38.7598,38.6719,38.8916,39.1113,39.2432,39.1113,39.3311,39.4189,38.9795,38.3643,38.1445,38.0127,37.8369,37.4414,37.4414,37.2217,37.2217,36.8262,36.6943,36.123,35.9912,35.7715,35.7275,35.5518,35.4639,35.4199,35.4199,35.376,35.4199,35.2441,35.332,35.6836,35.6836,35.8154,36.123,36.2549,36.4746,36.5625,36.7822,37.0898,37.0898,36.9141,36.3428,35.9912,35.8594,35.5518,35.2881,35.2881,35.1123,35.0244,34.9365,34.8926,35.0684,35.0684,34.7607,34.585,34.3213,34.2773,34.1455,33.9258,33.5303,33.6182,33.3984,33.1787,33.0029,32.915,32.8711,32.7393,32.6074,32.7393,32.8711,33.0469,33.2227,33.3105,33.3984,33.6182,33.7939,34.1895,34.3213,33.9258,33.4424,33.0908,33.4424,33.5742,33.5303,33.5303,33.7061,33.6621,34.2773,34.3652,34.1016,34.2773,34.4092,34.6289,34.8486,35.2002,35.4199,35.5957,35.5957,35.7715,35.9033,36.0791,36.2549,36.3428,36.7383,36.8262,36.958,37.1777,37.4414,37.7051,37.6172,37.8809,37.8369,38.2324,38.2764,38.4961,38.4521,38.2764,38.3643,38.9355,39.0674,38.9355,39.0234,38.8037,39.1992,38.584,38.4521,38.1885,38.2324,38.1006,38.3643,38.2764,38.4082,38.3643,38.7598,38.7158,38.9355,38.9795,39.1992,39.1113,39.3311,39.6387,40.6494,40.6934,41.0889,41.4844,41.792,41.6162,41.9238,42.2314,42.3193,42.4951,42.7148]}]],[[{"lng":[98.1738,98.2617,98.3496,98.7012,98.7891,98.6133,98.7012,98.7891,98.7891,98.9648,98.9648,99.1406,99.2285,99.4043,99.4043,99.668,100.1953,100.0195,100.2832,100.3711,100.7227,101.1621,101.1621,101.4258,101.4258,101.4258,101.6895,101.6016,101.8652,102.1289,102.5684,102.6563,103.0078,102.9199,103.4473,103.4473,103.7988,103.8867,104.4141,104.2383,104.4141,104.4141,104.3262,104.4141,104.8535,105.0293,105.2051,105.293,105.2051,104.5898,104.4141,104.1504,103.8867,103.623,103.7109,103.7109,103.8867,104.4141,104.6777,104.3262,104.8535,104.5898,104.6777,104.502,104.6777,104.7656,105.0293,105.2051,105.4688,105.5566,105.9961,106.1719,106.1719,105.6445,105.5566,105.293,104.8535,104.7656,104.3262,104.1504,103.9746,103.623,103.5352,103.3594,103.0957,102.4805,102.3047,101.8652,101.7773,101.6016,101.8652,101.7773,101.6016,101.25,101.1621,100.6348,100.1074,99.9316,99.2285,99.4043,99.3164,99.4922,98.877,98.7012,98.877,98.1738,97.7344,97.5586,97.7344,97.6465,97.5586,97.5586,97.7344,97.8223,98.1738,98.1738,98.3496,98.5254,98.7012,98.6133,98.7012,98.7891,98.7012,98.5254,98.3496,98.1738],"lat":[28.125,28.3887,28.125,28.2129,28.3447,28.5205,28.916,29.0039,28.8721,28.8281,29.1357,29.2676,28.3008,28.1689,28.5205,28.8281,28.3447,28.125,27.7295,27.8174,27.8613,27.1582,27.0264,26.7188,26.8066,26.5869,26.3672,26.2354,26.0596,26.1035,26.3672,26.1914,26.3672,27.29,27.7734,28.125,28.3008,28.6523,28.6084,28.4326,28.2568,28.125,28.0371,27.9492,27.9053,28.0811,27.9932,27.7295,27.3779,27.334,27.4658,27.2461,27.4219,27.0264,26.9824,26.7627,26.543,26.6748,26.4111,25.708,25.2246,25.0488,24.9609,24.7412,24.3457,24.4775,24.4336,24.082,24.0381,24.126,24.126,23.8184,23.5547,23.4229,23.2031,23.3789,23.1592,22.8516,22.6758,22.8076,22.5439,22.7637,22.5879,22.8076,22.4561,22.7637,22.4121,22.3682,22.5,22.1924,21.6211,21.1377,21.2256,21.1816,21.7529,21.4453,21.4893,22.0605,22.1484,22.5879,22.7197,23.0713,23.2031,23.9502,24.126,24.082,23.8623,23.9063,24.126,24.4336,24.4336,24.7412,24.8291,25.2686,25.4004,25.6201,25.5762,25.8398,25.8838,26.0596,26.1475,26.5869,27.5098,27.6416,27.5098,28.125]}]],[[{"lng":[104.502,104.6777,105.2051,105.9961,106.1719,106.1719,106.875,107.0508,106.9629,107.2266,107.4902,107.7539,107.8418,108.1055,108.1934,108.3691,108.6328,108.6328,109.0723,108.9844,109.3359,109.5117,109.7754,109.9512,110.2148,110.5664,111.1816,111.2695,111.2695,111.4453,111.0059,111.0938,111.3574,111.5332,111.709,112.0605,111.8848,112.0605,111.8848,111.8848,111.7969,111.6211,111.6211,111.3574,111.4453,111.2695,110.7422,110.7422,110.6543,110.3027,110.3027,109.9512,109.8633,109.7754,109.7754,109.5996,109.1602,109.248,109.0723,109.0723,108.7207,108.6328,108.2813,107.8418,107.4023,107.0508,107.0508,106.6992,106.6113,106.7871,106.6992,105.9082,105.5566,105.5566,105.6445,106.1719,106.1719,105.9961,105.5566,105.4688,105.2051,105.0293,104.7656,104.6777,104.502],"lat":[24.7412,24.6094,24.9609,24.6533,24.7852,24.9609,25.1807,25.2686,25.4883,25.6201,25.2246,25.2246,25.1367,25.2246,25.4443,25.5322,25.3125,25.5762,25.5322,25.752,25.708,26.0156,25.8838,26.1914,25.9717,26.3232,26.3232,26.2354,25.8838,25.8398,25.0049,24.9609,25.1367,24.6533,24.7852,24.7412,24.6533,24.3457,24.2139,23.9941,23.8184,23.8184,23.6865,23.4668,23.0273,22.8076,22.5439,22.2803,22.1484,22.1484,21.8848,21.8408,21.665,21.6211,21.4014,21.4453,21.3574,20.874,20.9619,21.5332,21.5332,21.665,21.4893,21.6211,21.6211,21.7969,21.9287,22.0166,22.4121,22.7637,22.8955,22.9395,23.0713,23.2031,23.4229,23.5547,23.8184,24.126,24.126,24.0381,24.082,24.4336,24.4775,24.3457,24.7412]}]],[[{"lng":[109.248,109.248,109.5117,109.6875,109.7754,110.4785,110.6543,110.4785,110.8301,111.7969,112.2363,112.5,112.6758,112.9395,113.0273,112.9395,113.0273,113.5547,113.5547,113.7305,113.6426,113.7305,113.9063,114.1699,114.082,114.2578,113.7305,113.6426,113.6426,113.8184,113.7305,113.9063,113.9063,114.082,113.9941,114.2578,113.9941,113.9063,113.6426,113.2031,112.8516,113.0273,113.0273,112.8516,112.5879,112.2363,112.1484,112.0605,111.709,111.5332,111.3574,111.0938,111.0059,111.4453,111.2695,111.2695,111.1816,110.5664,110.2148,109.9512,109.7754,109.5117,109.4238,109.248,109.4238,109.3359,109.5117,109.5117,109.3359,108.8965,108.8086,109.4238,109.3359,109.3359,109.248],"lat":[28.4766,29.1357,29.6191,29.6191,29.751,29.6631,29.751,30.0146,30.1465,29.9268,29.5313,29.6191,29.5752,29.7949,29.751,29.4873,29.4434,29.8389,29.707,29.5752,29.3115,29.0918,29.0479,28.8281,28.5645,28.3447,27.9492,27.5977,27.3779,27.29,27.1143,26.9385,26.6309,26.5869,26.1914,26.1475,26.0596,25.4443,25.3125,25.5322,25.3564,25.2246,24.9609,24.917,25.1367,25.1807,24.873,24.7412,24.7852,24.6533,25.1367,24.9609,25.0049,25.8398,25.8838,26.2354,26.3232,26.3232,25.9717,26.1914,25.8838,26.0156,26.2793,26.3232,26.5869,26.7188,26.8066,27.0264,27.1582,27.0264,27.1143,27.5977,27.9053,28.2568,28.4766]}]],[[{"lng":[105.4688,105.9082,105.9961,105.7324,105.9961,106.5234,106.4355,106.6113,106.5234,106.6992,106.3477,106.5234,106.6113,106.9629,107.2266,107.666,107.8418,107.7539,107.7539,108.5449,108.6328,108.5449,108.6328,108.7207,107.3145,107.3145,107.3145,107.666,108.1934,108.7207,108.8086,108.8965,109.0723,108.9844,109.9512,109.8633,110.2148,110.127,110.6543,111.0938,111.0938,111.1816,110.918,110.8301,110.4785,110.4785,110.8301,110.3906,110.4785,110.5664,110.2148,110.2148,110.3906,110.4785,110.6543,110.6543,111.0059,111.0059,110.7422,110.5664,110.3027,109.5996,109.4238,109.7754,109.7754,110.127,110.127,109.6875,109.5117,109.5996,109.248,109.0723,108.5449,108.2813,108.0176,107.4023,107.2266,107.1387,107.0508,106.3477,106.084,106.084,105.5566,105.4688],"lat":[32.915,33.0029,33.1787,33.3984,33.6182,33.5303,33.9258,34.1455,34.2773,34.3213,34.585,34.7607,35.0684,35.0684,34.8926,34.9365,35.0244,35.1123,35.2881,35.2881,35.5518,35.8594,35.9912,36.3428,36.9141,37.0898,37.6172,37.8809,37.6172,37.7051,38.0127,37.9688,38.0127,38.3203,39.1553,39.2432,39.2871,39.4629,39.2871,39.5947,39.375,39.2432,38.7158,38.4961,38.1885,37.9688,37.6611,37.002,36.123,35.6396,34.8926,34.6729,34.585,34.2334,34.1455,33.8379,33.5303,33.2666,33.1348,33.2666,33.1787,33.2666,33.1348,33.0469,32.915,32.7393,32.6074,32.6074,32.4316,31.7285,31.7285,31.9482,32.2119,32.2559,32.168,32.5195,32.4316,32.4756,32.6953,32.6514,32.7393,32.8711,32.7393,32.915]}]],[[{"lng":[109.7754,109.7754,109.8633,109.9512,110.3027,110.3027,110.6543,110.7422,110.7422,111.2695,111.4453,111.3574,111.6211,111.6211,111.7969,111.8848,111.8848,112.0605,111.8848,112.0605,112.1484,112.2363,112.5879,112.8516,113.0273,113.0273,112.8516,113.2031,113.6426,113.9063,113.9941,114.6094,114.7852,114.6973,114.4336,114.1699,114.4336,115.4004,115.8398,115.752,115.9277,116.2793,116.3672,116.543,116.7188,116.9824,116.9824,117.1582,117.334,116.8945,116.6309,116.543,115.9277,115.6641,115.5762,115.0488,114.6094,114.3457,113.9941,113.8184,114.3457,114.4336,114.082,113.9941,113.5547,113.1152,112.9395,112.4121,112.2363,111.5332,111.2695,110.7422,110.6543,110.7422,110.4785,110.6543,110.5664,110.3906,110.0391,109.8633,109.8633,109.5996,109.7754,109.7754],"lat":[21.4014,21.6211,21.665,21.8408,21.8848,22.1484,22.1484,22.2803,22.5439,22.8076,23.0273,23.4668,23.6865,23.8184,23.8184,23.9941,24.2139,24.3457,24.6533,24.7412,24.873,25.1807,25.1367,24.917,24.9609,25.2246,25.3564,25.5322,25.3125,25.4443,25.2686,25.4004,25.2686,25.1367,24.9609,24.6973,24.5215,24.7852,24.5654,24.7852,24.917,24.7852,24.873,24.6094,24.6533,24.1699,23.9063,23.5547,23.2471,23.3789,23.1152,22.8516,22.7197,22.7637,22.6318,22.6758,22.3682,22.5439,22.5,22.1924,22.1484,22.0166,21.9287,21.7969,22.0166,21.8408,21.5771,21.4453,21.5332,21.4893,21.3574,21.3574,21.2256,20.918,20.874,20.2588,20.2588,20.127,20.127,20.127,20.3027,20.918,21.4014,21.4014]}],[{"lng":[113.5986,113.6096,113.5547,113.5437,113.5767,113.5986],"lat":[22.1649,22.1265,22.11,22.2034,22.2034,22.1649]}]],[[{"lng":[123.2227,123.9258,124.0137,124.3652,124.8926,125.0684,125.6836,125.7715,126.0352,126.5625,126.9141,127.0898,127.002,127.0898,127.5293,127.7051,128.0566,128.0566,128.4082,128.4961,128.8477,129.1992,129.2871,129.8145,129.9023,129.9902,130.3418,130.5176,130.8691,131.3086,131.3086,131.1328,130.4297,130.6055,130.6055,130.2539,130.2539,130.166,129.9023,129.7266,129.375,128.9355,128.0566,128.3203,128.1445,127.0898,127.1777,126.9141,126.6504,126.4746,126.123,125.6836,125.5957,125.7715,125.332,125.332,125.4199,125.332,124.8926,124.8926,124.7168,124.4531,124.2773,123.8379,123.6621,123.3105,123.4863,123.1348,122.3438,122.0801,122.2559,121.9043,121.7285,121.8164,122.2559,122.4316,122.6953,122.7832,123.2227],"lat":[46.2305,46.2305,45.7471,45.4395,45.5273,45.3955,45.5273,45.3076,45.1758,45.2637,45.1318,45,44.7803,44.6045,44.6045,44.1211,44.1211,44.3408,44.4727,44.165,43.5498,43.5938,43.8135,43.9014,44.0332,43.8574,43.9893,43.6377,43.418,43.4619,43.3301,42.9346,42.7148,42.6709,42.4512,42.7588,42.8906,42.9785,43.0225,42.4951,42.4512,42.0117,42.0117,41.5723,41.3525,41.5283,41.5723,41.792,41.6602,41.3965,40.957,40.8691,40.9131,41.2207,41.6602,41.9678,42.0996,42.1436,42.8027,43.0664,43.0664,42.8467,43.2422,43.4619,43.374,43.5059,43.7256,44.4727,44.2529,44.8682,45.2637,45.7031,45.7471,46.0107,45.791,45.8789,45.7031,46.0107,46.2305]}]],[[{"lng":[114.5215,114.3457,113.9941,114.5215,114.3457,114.2578,114.082,113.9063,113.9941,113.9063,114.2578,114.1699,114.5215,114.873,114.9609,115.2246,115.9277,116.0156,116.2793,116.8066,116.8945,117.334,117.5098,117.7734,118.0371,117.9492,118.125,118.3008,118.3008,118.125,118.3887,119.2676,118.8281,119.2676,119.5313,119.707,119.8828,119.5313,119.4434,118.916,118.4766,118.125,118.0371,118.0371,117.8613,117.9492,117.6855,117.5098,117.5098,117.6855,117.6855,117.4219,117.2461,117.4219,116.9824,116.6309,116.3672,116.4551,116.1914,116.1035,115.752,115.9277,115.4004,115.4883,115.752,116.1914,116.3672,116.543,116.8066,116.8945,116.7188,116.7188,117.2461,117.5977,117.9492,117.4219,116.8066,116.4551,116.2793,116.2793,116.0156,115.752,115.3125,115.4883,115.3125,115.1367,114.9609,114.873,113.7305,113.4668,113.7305,113.7305,114.1699,113.9941,113.8184,113.5547,113.5547,113.8184,113.8184,113.9063,114.3457,114.5215],"lat":[39.5068,39.8584,39.9902,40.3418,40.3857,40.6055,40.7373,41.1328,41.2207,41.4404,41.5723,41.792,42.1436,42.0996,41.6162,41.5723,41.9238,41.792,42.0117,42.0117,42.4072,42.4512,42.583,42.627,42.4072,42.2314,42.0557,42.0996,41.792,41.748,41.3086,41.3086,40.8252,40.5176,40.5615,40.1221,39.9463,39.6826,39.4189,39.0674,38.9355,39.0234,39.1992,39.2432,39.4189,39.5947,39.5947,39.7705,39.9902,39.9902,40.0781,40.21,40.5176,40.6494,40.6934,41.0449,40.9131,40.7813,40.7813,40.6055,40.5615,40.2539,39.9463,39.6387,39.5068,39.5947,39.4629,39.5947,39.5947,39.1113,38.9355,38.8037,38.54,38.6279,38.3203,37.8369,37.8369,37.4854,37.5732,37.3535,37.3535,36.9141,36.5186,36.167,36.0791,36.2109,36.0791,36.123,36.3428,36.6504,36.8701,37.1338,37.6611,37.7051,38.1445,38.2764,38.54,38.8037,38.9355,39.0234,39.0674,39.5068]}],[{"lng":[117.2461,117.1582,117.1582,116.8945,116.8945,116.8066,117.2461],"lat":[40.0781,39.8145,39.6387,39.6826,39.8145,39.9902,40.0781]}]],[[{"lng":[110.2148,110.127,109.6875,109.7754,109.5996,109.5117,109.6875,110.127,110.127,109.7754,109.7754,109.4238,109.5996,110.3027,110.5664,110.7422,111.0059,111.5332,112.3242,113.2031,113.4668,113.7305,113.8184,113.9941,114.1699,114.5215,114.6094,114.7852,115.1367,115.2246,115.4004,115.5762,116.0156,115.752,116.1035,116.1035,115.9277,115.4883,114.873,114.2578,113.9063,113.7305,113.6426,113.7305,113.5547,113.5547,113.0273,112.9395,113.0273,112.9395,112.6758,112.5,112.2363,111.7969,110.8301,110.4785,110.6543,110.4785,109.7754,109.6875,109.5117,109.248,109.0723,108.9844,108.6328,108.457,108.5449,108.457,108.6328,108.8086,109.0723,109.1602,109.248,109.4238,109.8633,110.0391,110.2148],"lat":[31.1572,31.377,31.5527,31.6846,31.7285,32.4316,32.6074,32.6074,32.7393,32.915,33.0469,33.1348,33.2666,33.1787,33.2666,33.1348,33.2666,32.6074,32.3438,32.4316,32.2998,32.4316,31.8604,31.7725,31.8604,31.7725,31.5527,31.4648,31.5967,31.4209,31.4209,31.2012,31.0254,30.6738,30.1904,29.8389,29.707,29.7949,29.3994,29.3555,29.0479,29.0918,29.3115,29.5752,29.707,29.8389,29.4434,29.4873,29.751,29.7949,29.5752,29.6191,29.5313,29.9268,30.1465,30.0146,29.751,29.6631,29.751,29.6191,29.6191,29.1357,29.3555,29.3115,29.8389,29.7949,30.2344,30.4102,30.5859,30.498,30.6299,30.542,30.6299,30.542,30.8936,30.8057,31.1572]}]],[[{"lng":[104.1504,104.4141,104.5898,105.2051,105.293,105.5566,105.6445,106.3477,106.1719,105.9082,105.6445,105.9961,106.3477,106.5234,106.4355,106.5234,106.6113,106.6113,106.6992,106.875,107.4023,107.4023,107.5781,107.8418,107.8418,108.2813,108.3691,108.5449,108.5449,108.7207,108.7207,109.0723,109.248,109.3359,109.3359,109.4238,108.8086,108.8965,109.3359,109.5117,109.5117,109.3359,109.4238,109.248,109.4238,109.5117,109.3359,108.9844,109.0723,108.6328,108.6328,108.3691,108.1934,108.1055,107.8418,107.7539,107.4902,107.2266,106.9629,107.0508,106.875,106.1719,106.1719,105.9961,105.2051,104.6777,104.502,104.6777,104.5898,104.8535,104.3262,104.6777,104.4141,103.8867,103.7109,103.7109,103.623,103.8867,104.1504],"lat":[27.2461,27.4658,27.334,27.3779,27.7295,27.7734,27.6416,27.8174,28.125,28.125,28.4326,28.7402,28.5205,28.5645,28.7842,28.7842,28.6523,28.5205,28.4766,28.7842,28.8721,29.1797,29.2236,29.1357,29.0039,29.0918,28.6523,28.6523,28.3887,28.4766,28.2129,28.2129,28.4766,28.2568,27.9053,27.5977,27.1143,27.0264,27.1582,27.0264,26.8066,26.7188,26.5869,26.3232,26.2793,26.0156,25.708,25.752,25.5322,25.5762,25.3125,25.5322,25.4443,25.2246,25.1367,25.2246,25.2246,25.6201,25.4883,25.2686,25.1807,24.9609,24.7852,24.6533,24.9609,24.6094,24.7412,24.9609,25.0488,25.2246,25.708,26.4111,26.6748,26.543,26.7627,26.9824,27.0264,27.4219,27.2461]}]],[[{"lng":[115.4883,115.3125,115.752,116.0156,116.2793,116.2793,116.4551,116.8066,117.4219,117.9492,118.125,118.916,119.3555,119.0039,119.0039,119.3555,119.707,119.8828,120.498,120.5859,120.9375,121.0254,121.2012,121.9043,122.168,122.2559,122.6074,122.6953,122.6074,122.4316,121.8164,121.7285,121.1133,121.1133,121.377,120.7617,120.9375,120.6738,119.707,119.9707,119.3555,119.2676,118.916,118.7402,118.4766,118.3887,118.2129,118.125,117.9492,117.5977,117.334,117.2461,116.8066,116.4551,116.3672,116.1914,115.5762,115.4004,114.7852,115.0488,115.2246,115.4883,116.1035,115.3125,115.4883],"lat":[36.167,36.5186,36.9141,37.3535,37.3535,37.5732,37.4854,37.8369,37.8369,38.3203,38.1445,38.1445,37.6611,37.5293,37.3535,37.1338,37.1338,37.3975,37.8369,38.1445,38.4521,37.8369,37.6611,37.4854,37.6172,37.4854,37.4854,37.3535,36.9141,36.7822,36.8701,36.6943,36.6064,36.4307,36.2549,36.167,35.8594,36.0352,35.4639,34.9805,35.0244,35.1123,35.0244,34.7168,34.6729,34.4092,34.4092,34.6289,34.6729,34.4531,34.585,34.4531,34.9365,34.8926,34.6289,34.585,34.585,34.8486,35.0684,35.376,35.4199,35.7275,36.0791,35.8154,36.167]}]],[[{"lng":[114.2578,114.082,114.1699,113.9063,114.2578,114.873,115.4883,115.9277,116.1035,116.2793,116.7188,116.8945,116.7188,116.7188,117.1582,117.0703,117.1582,117.5098,118.0371,118.2129,118.0371,118.0371,118.3887,118.4766,118.4766,118.3008,117.7734,117.5098,116.9824,117.1582,117.0703,116.543,116.6309,116.3672,116.4551,116.1914,116.0156,115.8398,115.9277,115.752,115.8398,115.4004,114.4336,114.1699,114.4336,114.6973,114.7852,114.6094,113.9941,113.9063,113.9941,114.2578,113.9941,114.082,113.9063,113.9063,113.7305,113.8184,113.6426,113.6426,113.7305,114.2578],"lat":[28.3447,28.5645,28.8281,29.0479,29.3555,29.3994,29.7949,29.707,29.8389,29.7949,30.0586,29.9268,29.751,29.6191,29.707,29.8389,29.9268,29.6191,29.5752,29.3994,29.1797,29.0479,28.7842,28.3447,28.3008,28.0811,27.8174,27.9932,27.6416,27.29,27.1143,26.8066,26.4551,26.2354,26.1035,25.8838,25.2686,25.2246,24.917,24.7852,24.5654,24.7852,24.5215,24.6973,24.9609,25.1367,25.2686,25.4004,25.2686,25.4443,26.0596,26.1475,26.1914,26.5869,26.6309,26.9385,27.1143,27.29,27.3779,27.5977,27.9492,28.3447]}]],[[{"lng":[110.3906,110.8301,111.1816,111.5332,111.7969,112.0605,112.0605,112.7637,113.1152,113.6426,113.7305,114.873,114.9609,115.1367,115.3125,115.4883,115.3125,116.1035,115.4883,115.2246,115.0488,114.7852,115.4004,115.5762,116.1914,116.1914,116.543,116.6309,116.1914,116.0156,115.6641,115.5762,115.5762,115.4004,115.3125,114.873,114.873,115.1367,115.2246,115.5762,115.8398,115.9277,115.4883,115.4004,115.2246,115.1367,114.7852,114.6094,114.5215,114.1699,113.9941,113.8184,113.7305,113.4668,113.2031,112.3242,111.5332,111.0059,111.0059,110.6543,110.6543,110.4785,110.3906],"lat":[34.585,34.6289,34.8047,34.8486,35.0684,35.0684,35.2881,35.2002,35.332,35.6836,36.3428,36.123,36.0791,36.2109,36.0791,36.167,35.8154,36.0791,35.7275,35.4199,35.376,35.0684,34.8486,34.585,34.585,34.4092,34.2773,33.9258,33.7061,33.9697,34.0576,33.9258,33.6621,33.5303,33.1787,33.1348,33.0029,32.8711,32.6074,32.4316,32.5195,31.7725,31.6846,31.4209,31.4209,31.5967,31.4648,31.5527,31.7725,31.8604,31.7725,31.8604,32.4316,32.2998,32.4316,32.3438,32.6074,33.2666,33.5303,33.8379,34.1455,34.2334,34.585]}]],[[{"lng":[119.2676,119.4434,119.2676,119.3555,119.5313,119.8828,120.1465,120.498,121.4648,121.7285,121.9922,122.3438,122.3438,122.7832,123.1348,123.3105,123.5742,123.6621,123.8379,124.2773,124.4531,124.7168,124.8926,124.8926,125.332,125.4199,125.332,125.332,125.7715,125.5957,125.6836,124.541,124.1016,123.3984,123.1348,123.1348,122.0801,121.5527,121.1133,120.9375,121.377,121.2012,122.0801,121.9922,121.7285,121.2012,120.5859,119.8828,119.707,119.5313,119.2676,118.8281,119.2676],"lat":[41.3086,41.6162,41.7041,42.2754,42.3633,42.1875,41.7041,42.0996,42.4951,42.4512,42.7148,42.6709,42.8467,42.7148,42.8027,42.9785,43.0225,43.374,43.4619,43.2422,42.8467,43.0664,43.0664,42.8027,42.1436,42.0996,41.9678,41.6602,41.2207,40.9131,40.8691,40.21,39.6826,39.6826,39.4189,39.0234,39.0234,38.7158,38.6719,38.9795,39.1992,39.5508,40.3857,40.6934,40.8252,40.8252,40.21,39.9463,40.1221,40.5615,40.5176,40.8252,41.3086]}]],[[{"lng":[110.918,111.1816,111.0938,111.3574,111.4453,111.9727,112.3242,112.7637,113.2031,113.5547,113.8184,114.082,114.082,114.2578,114.3457,114.5215,113.9941,114.3457,114.5215,114.3457,113.9063,113.8184,113.8184,113.5547,113.5547,113.8184,113.9941,114.1699,113.7305,113.7305,113.4668,113.7305,113.6426,113.1152,112.7637,112.0605,112.0605,111.7969,111.5332,111.1816,110.8301,110.3906,110.2148,110.2148,110.5664,110.4785,110.3906,110.8301,110.4785,110.4785,110.8301,110.918],"lat":[38.7158,39.2432,39.375,39.4189,39.6387,39.5947,40.2539,40.166,40.3857,40.3418,40.5176,40.5176,40.7373,40.6055,40.3857,40.3418,39.9902,39.8584,39.5068,39.0674,39.0234,38.9355,38.8037,38.54,38.2764,38.1445,37.7051,37.6611,37.1338,36.8701,36.6504,36.3428,35.6836,35.332,35.2002,35.2881,35.0684,35.0684,34.8486,34.8047,34.6289,34.585,34.6729,34.8926,35.6396,36.123,37.002,37.6611,37.9688,38.1885,38.4961,38.7158]}]],[[{"lng":[116.6309,116.543,116.1914,116.1914,116.3672,116.8945,117.1582,117.5977,117.7734,118.125,117.9492,118.0371,118.2129,118.3008,118.7402,118.916,119.1797,119.1797,118.5645,118.6523,118.4766,118.3887,118.916,118.7402,118.8281,119.3555,119.4434,119.6191,119.6191,119.4434,119.2676,119.3555,118.916,118.916,118.7402,118.2129,118.0371,117.5098,117.1582,117.0703,117.1582,116.7188,116.7188,116.8945,116.7188,116.2793,116.1035,116.1035,115.752,116.0156,115.5762,115.4004,115.4883,115.9277,115.8398,115.5762,115.2246,115.1367,114.873,114.873,115.3125,115.4004,115.5762,115.5762,115.6641,116.0156,116.1914,116.6309],"lat":[33.9258,34.2773,34.4092,34.585,34.6289,34.4092,34.0576,34.0137,33.7061,33.75,33.2227,33.1348,33.2227,32.7832,32.7393,32.959,32.8271,32.4756,32.5635,32.2119,32.168,31.9482,31.5527,31.377,31.2451,31.2891,31.1572,31.1133,31.0693,30.6738,30.6299,30.4102,30.3223,29.9707,29.707,29.3994,29.5752,29.6191,29.9268,29.8389,29.707,29.6191,29.751,29.9268,30.0586,29.7949,29.8389,30.1904,30.6738,31.0254,31.2012,31.4209,31.6846,31.7725,32.5195,32.4316,32.6074,32.8711,33.0029,33.1348,33.1787,33.5303,33.6621,33.9258,34.0576,33.9697,33.7061,33.9258]}]],[[{"lng":[118.4766,118.8281,118.7402,118.916,119.2676,119.6191,119.7949,120.2344,120.4102,120.7617,120.6738,120.2344,120.2344,120.4102,120.498,120.2344,120.4102,120.0586,119.9707,119.7949,119.9707,119.7949,119.5313,119.4434,119.2676,118.916,118.6523,118.4766,118.4766,118.2129,118.2129,117.8613,117.7734,117.5098,117.1582,116.9824,116.9824,116.7188,116.543,116.3672,116.2793,115.9277,115.8398,116.0156,116.1914,116.4551,116.3672,116.6309,116.543,117.0703,117.1582,116.9824,117.5098,117.7734,118.3008,118.4766],"lat":[28.3008,28.2568,28.0371,27.4658,27.4219,27.6855,27.29,27.4219,27.1582,27.0264,26.8945,26.8506,26.7188,26.6748,26.3672,26.2793,26.1475,26.1914,25.9277,25.9277,25.4004,25.2686,25.1367,25.0049,25.0928,24.8291,24.5215,24.5215,24.4336,24.3457,24.1699,23.9941,23.7744,23.5986,23.5547,23.9063,24.1699,24.6533,24.6094,24.873,24.7852,24.917,25.2246,25.2686,25.8838,26.1035,26.2354,26.4551,26.8066,27.1143,27.29,27.6416,27.9932,27.8174,28.0811,28.3008]}]],[[{"lng":[118.2129,118.7402,118.916,118.916,119.3555,119.2676,119.4434,119.6191,119.6191,119.9707,120.498,120.9375,121.2891,121.9922,122.6953,122.8711,122.959,122.6074,122.6074,122.168,122.3438,121.9922,121.9922,121.7285,121.7285,121.4648,121.5527,121.2891,121.1133,120.6738,120.6738,120.9375,120.7617,120.4102,120.2344,119.7949,119.6191,119.2676,118.916,118.7402,118.8281,118.4766,118.4766,118.3887,118.0371,118.0371,118.2129],"lat":[29.3994,29.707,29.9707,30.3223,30.4102,30.6299,30.6738,31.0693,31.1133,31.1572,30.8057,31.0254,30.6738,30.8057,30.8936,30.7178,30.1465,30.1025,29.9268,29.5313,28.8721,28.8721,28.4326,28.3447,28.2129,28.2129,28.0371,27.9492,27.4219,27.334,27.1582,27.0264,27.0264,27.1582,27.4219,27.29,27.6855,27.4219,27.4658,28.0371,28.2568,28.3008,28.3447,28.7842,29.0479,29.1797,29.3994]}]],[[{"lng":[116.3672,116.4551,116.8066,117.2461,117.334,117.5977,117.9492,118.125,118.2129,118.3887,118.4766,118.7402,118.916,119.2676,119.3555,119.3555,119.707,120.3223,120.9375,121.0254,121.377,121.4648,121.9043,121.9922,121.9922,121.2012,121.1133,121.377,121.2012,120.9375,120.498,119.9707,119.6191,119.4434,119.3555,118.8281,118.7402,118.916,118.3887,118.4766,118.6523,118.5645,119.1797,119.1797,118.916,118.7402,118.3008,118.2129,118.0371,117.9492,118.125,117.7734,117.5977,117.1582,116.8945,116.3672],"lat":[34.6289,34.8926,34.9365,34.4531,34.585,34.4531,34.6729,34.6289,34.4092,34.4092,34.6729,34.7168,35.0244,35.1123,35.0244,34.8486,34.585,34.3652,33.0469,32.6514,32.4756,32.168,31.9922,31.6846,31.5967,31.8604,31.7285,31.5088,31.4648,31.0254,30.8057,31.1572,31.1133,31.1572,31.2891,31.2451,31.377,31.5527,31.9482,32.168,32.2119,32.5635,32.4756,32.8271,32.959,32.7393,32.7832,33.2227,33.1348,33.2227,33.75,33.7061,34.0137,34.0576,34.4092,34.6289]}]],[[{"lng":[108.5449,108.2813,108.3691,108.5449,109.0723,109.248,109.5996,109.7754,109.6875,110.127,110.2148,110.0391,109.8633,109.4238,109.248,109.1602,109.0723,108.8086,108.6328,108.457,108.5449,108.457,108.6328,108.9844,109.0723,109.248,109.248,109.0723,108.7207,108.7207,108.5449,108.5449,108.3691,108.2813,107.8418,107.8418,107.5781,107.4023,107.4023,106.875,106.6992,106.6113,106.6113,106.5234,106.4355,106.5234,106.3477,106.2598,105.8203,105.7324,105.4688,105.293,105.7324,105.5566,105.6445,105.8203,106.2598,106.6113,106.7871,107.0508,107.4902,107.4023,107.4902,107.9297,108.1934,108.5449],"lat":[31.6846,31.9043,32.168,32.2119,31.9482,31.7285,31.7285,31.6846,31.5527,31.377,31.1572,30.8057,30.8936,30.542,30.6299,30.542,30.6299,30.498,30.5859,30.4102,30.2344,29.7949,29.8389,29.3115,29.3555,29.1357,28.4766,28.2129,28.2129,28.4766,28.3887,28.6523,28.6523,29.0918,29.0039,29.1357,29.2236,29.1797,28.8721,28.7842,28.4766,28.5205,28.6523,28.7842,28.7842,28.5645,28.5205,28.8721,28.96,29.2676,29.3115,29.5313,29.8828,30.1025,30.2783,30.4541,30.1904,30.3223,30.0146,30.0146,30.6299,30.7617,30.8496,30.8496,31.5088,31.6846]}]],[[{"lng":[104.3262,105.8203,105.9082,106.3477,106.7871,106.9629,106.5234,106.7871,107.3145,107.666,107.3145,107.3145,106.6113,106.6113,106.4355,106.5234,106.5234,106.875,106.9629,106.6992,106.4355,106.5234,106.3477,106.2598,106.084,105.9961,106.084,105.9961,105.8203,105.7324,105.3809,105.293,105.4688,105.2051,105.293,104.8535,104.5898,104.5898,104.3262],"lat":[37.4414,37.793,38.7158,39.2871,39.375,38.9795,38.3203,38.1885,38.1006,37.8809,37.6172,37.0898,37.0898,36.7822,36.5625,36.4746,36.2549,36.123,35.8154,35.6836,35.6836,35.332,35.2441,35.4199,35.376,35.4199,35.4639,35.4639,35.5518,35.7275,35.7715,35.9912,36.123,36.6943,36.8262,37.2217,37.2217,37.4414,37.4414]}]],[[{"lng":[108.6328,109.0723,109.248,109.5996,110.0391,110.3906,110.5664,110.6543,111.0938,111.2695,110.6543,110.5664,110.2148,110.0391,109.8633,109.6875,108.9844,108.6328,108.6328],"lat":[19.3799,19.6436,19.9512,20.0391,20.127,20.127,20.2588,20.2588,19.9512,19.9951,19.1602,18.6768,18.5889,18.3691,18.3691,18.1055,18.2813,18.457,19.3799]}]],[[{"lng":[121.9043,121.9922,121.8164,121.9043,121.6406,121.377,121.0254,120.8496,120.7617,120.6738,120.2344,120.0586,120.1465,121.0254,121.5527,121.9043],"lat":[25.0488,25.0049,24.7412,24.5654,24.0381,23.1152,22.6758,22.0605,21.9287,22.3242,22.5879,23.0713,23.6865,25.0488,25.3125,25.0488]}]],[[{"lng":[117.4219,117.334,117.2461,116.8066,116.8945,116.8945,116.8066,116.543,116.3672,116.1914,115.752,115.4883,115.4004,115.9277,115.752,116.1035,116.1914,116.4551,116.3672,116.6309,116.9824,117.4219,117.2461,117.4219],"lat":[40.21,40.1221,40.0781,39.9902,39.8145,39.6826,39.5947,39.5947,39.4629,39.5947,39.5068,39.6387,39.9463,40.2539,40.5615,40.6055,40.7813,40.7813,40.9131,41.0449,40.6934,40.6494,40.5176,40.21]}]],[[{"lng":[116.8066,116.8945,117.1582,117.1582,117.2461,117.334,117.4219,117.6855,117.6855,117.5098,117.5098,117.6855,117.9492,117.8613,118.0371,118.0371,117.8613,117.5977,117.2461,116.7188,116.7188,116.8945,116.8066],"lat":[39.5947,39.6826,39.6387,39.8145,40.0781,40.1221,40.21,40.0781,39.9902,39.9902,39.7705,39.5947,39.5947,39.4189,39.2432,39.1992,39.1113,38.6279,38.54,38.8037,38.9355,39.1113,39.5947]}]],[[{"lng":[120.9375,121.2012,121.377,121.1133,121.2012,121.9922,121.9043,121.9922,121.2891,120.9375],"lat":[31.0254,31.4648,31.5088,31.7285,31.8604,31.5967,31.1572,30.8057,30.6738,31.0254]}]],[[{"lng":[114.6094,114.5215,114.3457,113.9063,113.8184,113.9063,114.1699,114.3457,114.4336,114.4336,114.6094],"lat":[22.4121,22.1484,22.1484,22.1484,22.1924,22.4121,22.5439,22.5439,22.5439,22.4121,22.4121]}]],[[{"lng":[113.5986,113.6096,113.5547,113.5437,113.5767,113.5986],"lat":[22.1649,22.1265,22.11,22.2034,22.2034,22.1649]}]]],null,null,{"interactive":true,"className":"","stroke":true,"color":["#FECFBC","#FFF5F0","#FED4C1","#FFF2EB","#E73428","#FDC1A9","#FED1BE","#FC9879","#FC9170","#FA6647","#FDAD91","#67000D","#FED4C1","#F44E37","#FC7D5C","#FDB094","#BC141A","#FD9E7F","#C1161B","#FDA587","#FCB99F","#FC7454","#FDA88A","#FB6B4B","#E43227","#FDC0A8","#FFF0E9","#FFECE3","#FED5C3","#FED9C8","#FFE7DC","#FED2BF","#FFF0E8","#808080"],"weight":1,"opacity":0.5,"fill":true,"fillColor":["#FECFBC","#FFF5F0","#FED4C1","#FFF2EB","#E73428","#FDC1A9","#FED1BE","#FC9879","#FC9170","#FA6647","#FDAD91","#67000D","#FED4C1","#F44E37","#FC7D5C","#FDB094","#BC141A","#FD9E7F","#C1161B","#FDA587","#FCB99F","#FC7454","#FDA88A","#FB6B4B","#E43227","#FDC0A8","#FFF0E9","#FFECE3","#FED5C3","#FED9C8","#FFE7DC","#FED2BF","#FFF0E8","#808080"],"fillOpacity":0.7,"smoothFactor":1,"noClip":false},["新疆维吾尔自治区: 25852345","西藏自治区: 3648100","内蒙古自治区: 24049155","青海省: 5923957","四川省: 83674866","黑龙江省: 31850088","甘肃省: 25019831","云南省: 47209277","广西壮族自治区: 50126804","湖南省: 66444864","陕西省: 39528999","广东省: 126012510","吉林省: 24073453","河北省: 74610235","湖北省: 57752557","贵州省: 38562148","山东省: 101527453","江西省: 45188635","河南省: 99365519","辽宁省: 42591407","山西省: 34915616","安徽省: 61027171","福建省: 41540086","浙江省: 64567588","江苏省: 84748016","重庆市: 32054159","宁夏回族自治区: 7202654","海南省: 10081232","台湾省: 23561236","北京市: 21893095","天津市: 13866009","上海市: 24870895","香港特别行政区: 7474200",null],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLegend","args":[{"colors":["#FFF5F0 , #FEDDCF 13.3632810389884%, #FDAC8F 29.7079028125907%, #FC7757 46.052524586193%, #EF3B2C 62.3971463597953%, #BF151B 78.7417681333976%, #7F0411 95.0863899069999%, #67000D "],"labels":["20,000,000","40,000,000","60,000,000","80,000,000","100,000,000","120,000,000"],"na_color":"#808080","na_label":"NA","opacity":1,"position":"bottomright","type":"numeric","title":"Population","extra":{"p_1":0.133632810389884,"p_n":0.950863899069999},"layerId":null,"className":"info legend","group":null}]}],"limits":{"lat":[18.1055,53.5693],"lng":[73.4766,135.0879]}},"evals":[],"jsHooks":[]}</script>
<hr />
</div>
<div id="raster-data" class="section level1">
<h1>Raster data</h1>
<p><strong>Raster</strong> files have a much more compact data structure than vectors. Because of their regular structure, the coordinates do not need to be recorded for each pixel or cell in the rectangular extent. A raster is defined by:</p>
<ul>
<li><p>CRS (coordinate reference system)</p></li>
<li><p>Coordinates of its origin</p></li>
<li><p>A distance or cell size in each direction</p></li>
<li><p>A dimension or numbers of cells in each direction</p></li>
<li><p>An array of cell values</p></li>
</ul>
<p>Given this structure, coordinates for any cell can be computed and don’t need to be stored.</p>
<p>The <code>raster</code> package is a major extension of spatial data classes to access large rasters and in particular, to process very large files. It includes <code>RasterLayer</code> and functions for converting among different classes and operators for computations on the raster data.</p>
<p>We can use <code>raster()</code> to read in raster files. Download this <a href="https://zhu-group.github.io/ese335/download/wc2.1_10m_wind_11.tif">tiff file</a> (<code>wc2.1_10m_wind_11.tif</code>, ~ 2.4MB), which is the mean wind speed (m s<sup>-1</sup>) in Nov. from 1970-2000 provided by the <a href="https://worldclim.org/data/worldclim21.html">WorldClim</a>. The data is at a resolution of <code>10</code> minutes (~ <code>340</code> km<sup>2</sup>).</p>
<p>In R, we can load it as:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="co"># Read the tiff file</span></span>
<span id="cb49-2"><a href="#cb49-2"></a>Wind_Nov &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="st">&quot;D://wc2.1_10m_wind_11.tif&quot;</span>)</span>
<span id="cb49-3"><a href="#cb49-3"></a></span>
<span id="cb49-4"><a href="#cb49-4"></a><span class="co"># Look at the raster attributes</span></span>
<span id="cb49-5"><a href="#cb49-5"></a>Wind_Nov</span></code></pre></div>
<pre><code>## class      : RasterLayer 
## dimensions : 1080, 2160, 2332800  (nrow, ncol, ncell)
## resolution : 0.1666667, 0.1666667  (x, y)
## extent     : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
## crs        : +proj=longlat +datum=WGS84 +no_defs 
## source     : D:/wc2.1_10m_wind_11.tif 
## names      : wc2.1_10m_wind_11 
## values     : 0.40025, 15.78051  (min, max)</code></pre>
<p>We can plot it using <code>plot()</code> or <code>image()</code> function:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="co"># Quick plot using plot()</span></span>
<span id="cb51-2"><a href="#cb51-2"></a><span class="kw">plot</span>(Wind_Nov, <span class="dt">main=</span><span class="st">&quot;Wind speed in Nov.&quot;</span>)</span></code></pre></div>
<p><img src="S20_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="co"># Set color</span></span>
<span id="cb52-2"><a href="#cb52-2"></a>col &lt;-<span class="st"> </span><span class="kw">terrain.colors</span>(<span class="dv">30</span>)</span>
<span id="cb52-3"><a href="#cb52-3"></a></span>
<span id="cb52-4"><a href="#cb52-4"></a><span class="co"># Quick using image()</span></span>
<span id="cb52-5"><a href="#cb52-5"></a><span class="kw">image</span>(Wind_Nov,  <span class="dt">main=</span><span class="st">&quot;Wind speed in Nov.&quot;</span>, <span class="dt">col=</span>col)</span>
<span id="cb52-6"><a href="#cb52-6"></a></span>
<span id="cb52-7"><a href="#cb52-7"></a><span class="co"># Add contour lines</span></span>
<span id="cb52-8"><a href="#cb52-8"></a><span class="kw">contour</span>(Wind_Nov, <span class="dt">add=</span>T, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="S20_files/figure-html/unnamed-chunk-13-2.png" width="672" /></p>
<p>Or with <code>ggplot()</code>, we can make a better map:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="co"># Convert the raster to a date.frame</span></span>
<span id="cb53-2"><a href="#cb53-2"></a>Wind_Nov_df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(Wind_Nov, <span class="dt">xy =</span> <span class="ot">TRUE</span>) </span>
<span id="cb53-3"><a href="#cb53-3"></a></span>
<span id="cb53-4"><a href="#cb53-4"></a><span class="co"># Check the data structure</span></span>
<span id="cb53-5"><a href="#cb53-5"></a><span class="kw">str</span>(Wind_Nov_df)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    2332800 obs. of  3 variables:
##  $ x                : num  -180 -180 -180 -179 -179 ...
##  $ y                : num  89.9 89.9 89.9 89.9 89.9 ...
##  $ wc2.1_10m_wind_11: num  NA NA NA NA NA NA NA NA NA NA ...</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="co"># Making plot</span></span>
<span id="cb55-2"><a href="#cb55-2"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb55-3"><a href="#cb55-3"></a><span class="st">  </span><span class="kw">geom_raster</span>(<span class="dt">data =</span> Wind_Nov_df,  </span>
<span id="cb55-4"><a href="#cb55-4"></a>              <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> wc2<span class="fl">.1</span>_10m_wind_<span class="dv">11</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb55-5"><a href="#cb55-5"></a><span class="st">  </span><span class="co"># Change labels</span></span>
<span id="cb55-6"><a href="#cb55-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Latitude&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Longitude&quot;</span>) <span class="op">+</span></span>
<span id="cb55-7"><a href="#cb55-7"></a><span class="st">  </span><span class="co"># Change theme</span></span>
<span id="cb55-8"><a href="#cb55-8"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></span>
<span id="cb55-9"><a href="#cb55-9"></a><span class="st">  </span><span class="kw">coord_equal</span>() <span class="op">+</span></span>
<span id="cb55-10"><a href="#cb55-10"></a><span class="st">  </span><span class="co"># Change legend</span></span>
<span id="cb55-11"><a href="#cb55-11"></a><span class="st">  </span><span class="kw">scale_fill_gradient</span>( <span class="st">&quot;Wind speed (m/s)&quot;</span>, <span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">20</span>),</span>
<span id="cb55-12"><a href="#cb55-12"></a>                       <span class="dt">low =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb55-13"><a href="#cb55-13"></a>                       <span class="dt">high =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb55-14"><a href="#cb55-14"></a>                       <span class="dt">n.breaks =</span> <span class="dv">10</span>,</span>
<span id="cb55-15"><a href="#cb55-15"></a>                       <span class="dt">space =</span> <span class="st">&quot;Lab&quot;</span>,</span>
<span id="cb55-16"><a href="#cb55-16"></a>                       <span class="dt">na.value =</span> <span class="st">&quot;grey50&quot;</span>,</span>
<span id="cb55-17"><a href="#cb55-17"></a>                       <span class="dt">guide =</span> <span class="st">&quot;colourbar&quot;</span>,</span>
<span id="cb55-18"><a href="#cb55-18"></a>                       <span class="dt">aesthetics =</span> <span class="st">&quot;fill&quot;</span>) <span class="op">+</span></span>
<span id="cb55-19"><a href="#cb55-19"></a><span class="st">  </span><span class="co"># Adjust the theme</span></span>
<span id="cb55-20"><a href="#cb55-20"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>),</span>
<span id="cb55-21"><a href="#cb55-21"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>, <span class="dt">angle=</span><span class="dv">90</span>),</span>
<span id="cb55-22"><a href="#cb55-22"></a>        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>),</span>
<span id="cb55-23"><a href="#cb55-23"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>),</span>
<span id="cb55-24"><a href="#cb55-24"></a>        <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb55-25"><a href="#cb55-25"></a>        <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb55-26"><a href="#cb55-26"></a>        <span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb55-27"><a href="#cb55-27"></a>        <span class="dt">legend.key =</span> <span class="kw">element_blank</span>()</span>
<span id="cb55-28"><a href="#cb55-28"></a>  ) <span class="op">+</span></span>
<span id="cb55-29"><a href="#cb55-29"></a><span class="st">  </span><span class="co"># Add a title</span></span>
<span id="cb55-30"><a href="#cb55-30"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Wind Speed in Nov.&quot;</span>) </span></code></pre></div>
<p><img src="S20_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>You can also use <code>crop()</code> function to select an area of interest:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="co"># Define the crop extent</span></span>
<span id="cb56-2"><a href="#cb56-2"></a>Crop_box &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">100</span>,<span class="dv">125</span>,<span class="dv">15</span>,<span class="dv">30</span>)</span>
<span id="cb56-3"><a href="#cb56-3"></a></span>
<span id="cb56-4"><a href="#cb56-4"></a><span class="co"># Crop the raster</span></span>
<span id="cb56-5"><a href="#cb56-5"></a>Wind_Nov_crop &lt;-<span class="st"> </span><span class="kw">crop</span>(Wind_Nov, Crop_box)</span>
<span id="cb56-6"><a href="#cb56-6"></a></span>
<span id="cb56-7"><a href="#cb56-7"></a><span class="co"># Plot cropped DEM</span></span>
<span id="cb56-8"><a href="#cb56-8"></a><span class="kw">plot</span>(Wind_Nov_crop, <span class="dt">main=</span><span class="st">&quot;Wind speed in Nov.&quot;</span>)</span></code></pre></div>
<p><img src="S20_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<hr />
</div>
<div id="adding-features-to-a-base-map" class="section level1">
<h1>Adding features to a base map</h1>
<div id="add-points" class="section level2">
<h2>Add points</h2>
<p>Suppose we want to plot site locations on a city scale, and we want to add a base map that shows road, terrain, and built-up areas. This can be done with the <code>ggmap()</code> package:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="co"># Site information</span></span>
<span id="cb57-2"><a href="#cb57-2"></a>Site_name &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;SUSTech&quot;</span>, <span class="st">&quot;Longhua&quot;</span>, <span class="st">&quot;Xichong&quot;</span>, <span class="st">&quot;Baoan&quot;</span>, <span class="st">&quot;Kuiyong&quot;</span>)</span>
<span id="cb57-3"><a href="#cb57-3"></a>Site_lon  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">114.06667</span>,<span class="fl">114.02200</span>,<span class="fl">114.56111</span>,<span class="fl">113.89606</span>,<span class="fl">114.42824</span>)</span>
<span id="cb57-4"><a href="#cb57-4"></a>Site_lat  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">22.61667</span>,<span class="fl">22.72882</span>,<span class="fl">22.48077</span>,<span class="fl">22.53965</span>,<span class="fl">22.63427</span>)</span>
<span id="cb57-5"><a href="#cb57-5"></a>Site_type &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Urban&quot;</span>, <span class="st">&quot;Urban&quot;</span>, <span class="st">&quot;Background&quot;</span>, <span class="st">&quot;Urban&quot;</span>, <span class="st">&quot;Rural&quot;</span>)</span>
<span id="cb57-6"><a href="#cb57-6"></a>  </span>
<span id="cb57-7"><a href="#cb57-7"></a><span class="co"># Make a data frame</span></span>
<span id="cb57-8"><a href="#cb57-8"></a>Site_data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">name=</span>Site_name, <span class="dt">lon=</span>Site_lon, <span class="dt">lat=</span>Site_lat, <span class="dt">type=</span>Site_type)</span>
<span id="cb57-9"><a href="#cb57-9"></a></span>
<span id="cb57-10"><a href="#cb57-10"></a><span class="co"># Get the lat and lon range</span></span>
<span id="cb57-11"><a href="#cb57-11"></a>Mapbox    &lt;-<span class="st"> </span><span class="kw">make_bbox</span>(<span class="dt">lon =</span> Site_data<span class="op">$</span>lon, <span class="dt">lat =</span> Site_data<span class="op">$</span>lat, <span class="dt">f =</span> <span class="fl">.1</span>)</span>
<span id="cb57-12"><a href="#cb57-12"></a></span>
<span id="cb57-13"><a href="#cb57-13"></a><span class="co"># Pull the base map, ***you may need a VPN to download the base map ***</span></span>
<span id="cb57-14"><a href="#cb57-14"></a><span class="co"># The keyword zoom defines the map resolution</span></span>
<span id="cb57-15"><a href="#cb57-15"></a>Base_map  &lt;-<span class="st"> </span><span class="kw">get_map</span>(<span class="dt">location=</span>Mapbox, <span class="dt">zoom=</span><span class="dv">10</span>, <span class="dt">maptype=</span><span class="st">&quot;terrain-background&quot;</span>)</span></code></pre></div>
<pre><code>## maptype = &quot;terrain-background&quot; is only available with source = &quot;stamen&quot;.</code></pre>
<pre><code>## resetting to source = &quot;stamen&quot;...</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/10/835/445.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/10/836/445.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/10/837/445.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/10/838/445.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/10/835/446.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/10/836/446.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/10/837/446.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/10/838/446.png</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="co"># Plot</span></span>
<span id="cb68-2"><a href="#cb68-2"></a><span class="kw">ggmap</span>(Base_map) <span class="op">+</span><span class="st"> </span></span>
<span id="cb68-3"><a href="#cb68-3"></a><span class="st">  </span><span class="co"># Add sites</span></span>
<span id="cb68-4"><a href="#cb68-4"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data=</span>Site_data, <span class="kw">aes</span>(<span class="dt">x=</span>lon, <span class="dt">y=</span>lat, <span class="dt">fill=</span>type, <span class="dt">shape=</span>type), </span>
<span id="cb68-5"><a href="#cb68-5"></a>             <span class="dt">color=</span><span class="st">&quot;white&quot;</span>, <span class="dt">cex=</span><span class="fl">5.5</span>) <span class="op">+</span><span class="st"> </span><span class="co"># plot the points</span></span>
<span id="cb68-6"><a href="#cb68-6"></a><span class="st">  </span><span class="co"># Change color</span></span>
<span id="cb68-7"><a href="#cb68-7"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), </span>
<span id="cb68-8"><a href="#cb68-8"></a>                    <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Background&quot;</span>, <span class="st">&quot;Rural&quot;</span>,<span class="st">&quot;Urban&quot;</span>), <span class="dt">name=</span><span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb68-9"><a href="#cb68-9"></a><span class="st">  </span><span class="co"># Change shape</span></span>
<span id="cb68-10"><a href="#cb68-10"></a><span class="st">  </span><span class="kw">scale_shape_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">21</span>,<span class="dv">22</span>,<span class="dv">24</span>), </span>
<span id="cb68-11"><a href="#cb68-11"></a>                     <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Background&quot;</span>, <span class="st">&quot;Rural&quot;</span>,<span class="st">&quot;Urban&quot;</span>), <span class="dt">name=</span><span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb68-12"><a href="#cb68-12"></a><span class="st">  </span><span class="co"># Change labels and title</span></span>
<span id="cb68-13"><a href="#cb68-13"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Latitude&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Longitude&quot;</span>, <span class="dt">title=</span><span class="st">&quot;Monitoring sites&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># label the axes</span></span>
<span id="cb68-14"><a href="#cb68-14"></a><span class="st">  </span><span class="co"># Change theme</span></span>
<span id="cb68-15"><a href="#cb68-15"></a><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb68-16"><a href="#cb68-16"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>, </span>
<span id="cb68-17"><a href="#cb68-17"></a>        <span class="dt">legend.key  =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>), </span>
<span id="cb68-18"><a href="#cb68-18"></a>        <span class="dt">axis.text   =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="kw">rel</span>(<span class="fl">0.75</span>)), </span>
<span id="cb68-19"><a href="#cb68-19"></a>        <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">45</span>, <span class="dt">vjust=</span><span class="fl">0.5</span>)) </span></code></pre></div>
<p><img src="S20_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
<div id="add-a-path" class="section level2">
<h2>Add a path</h2>
<p>Download the <a href="https://zhu-group.github.io/ese335/download/Mangkhut.txt">track of Typhoon Mangkhut</a>, and read via:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="co"># Read the data</span></span>
<span id="cb69-2"><a href="#cb69-2"></a>Mangkhut_data       &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;D://Mangkhut.txt&quot;</span>)</span>
<span id="cb69-3"><a href="#cb69-3"></a></span>
<span id="cb69-4"><a href="#cb69-4"></a><span class="co"># Get path and max wind speed</span></span>
<span id="cb69-5"><a href="#cb69-5"></a>Mangkhut_lat        &lt;-<span class="st"> </span>Mangkhut_data<span class="op">$</span>V4<span class="op">*</span><span class="fl">0.1</span></span>
<span id="cb69-6"><a href="#cb69-6"></a>Mangkhut_lon        &lt;-<span class="st"> </span>Mangkhut_data<span class="op">$</span>V5<span class="op">*</span><span class="fl">0.1</span></span>
<span id="cb69-7"><a href="#cb69-7"></a>Mangkhut_pressure   &lt;-<span class="st"> </span>Mangkhut_data<span class="op">$</span>V6</span>
<span id="cb69-8"><a href="#cb69-8"></a>Mangkhut_max_speed  &lt;-<span class="st"> </span>Mangkhut_data<span class="op">$</span>V7<span class="op">*</span><span class="fl">0.514</span></span></code></pre></div>
<p>let’s plot the max wind speed on the map:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="co"># Make a data frame for ggplot</span></span>
<span id="cb70-2"><a href="#cb70-2"></a>Mangkhut_data_new &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">lat=</span>Mangkhut_lat,<span class="dt">lon=</span>Mangkhut_lon,</span>
<span id="cb70-3"><a href="#cb70-3"></a>                                <span class="dt">pressure=</span>Mangkhut_pressure, <span class="dt">speed=</span>Mangkhut_max_speed)</span>
<span id="cb70-4"><a href="#cb70-4"></a></span>
<span id="cb70-5"><a href="#cb70-5"></a><span class="co"># Get the domain</span></span>
<span id="cb70-6"><a href="#cb70-6"></a>Domain            &lt;-<span class="st"> </span><span class="kw">make_bbox</span>(<span class="dt">lon =</span> Mangkhut_data_new<span class="op">$</span>lon, </span>
<span id="cb70-7"><a href="#cb70-7"></a>                               <span class="dt">lat =</span> Mangkhut_data_new<span class="op">$</span>lat, <span class="dt">f =</span> <span class="fl">.1</span>)</span>
<span id="cb70-8"><a href="#cb70-8"></a></span>
<span id="cb70-9"><a href="#cb70-9"></a><span class="co"># Get the base map</span></span>
<span id="cb70-10"><a href="#cb70-10"></a>Base_map          &lt;-<span class="st"> </span><span class="kw">get_map</span>(<span class="dt">location=</span>Domain, <span class="dt">zoom=</span><span class="dv">5</span>, </span>
<span id="cb70-11"><a href="#cb70-11"></a>                             <span class="dt">maptype=</span><span class="st">&quot;terrain-background&quot;</span>)</span></code></pre></div>
<pre><code>## maptype = &quot;terrain-background&quot; is only available with source = &quot;stamen&quot;.</code></pre>
<pre><code>## resetting to source = &quot;stamen&quot;...</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/5/25/13.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/5/26/13.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/5/27/13.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/5/28/13.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/5/29/13.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/5/30/13.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/5/31/13.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/5/25/14.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/5/26/14.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/5/27/14.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/5/28/14.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/5/29/14.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/5/30/14.png</code></pre>
<pre><code>## Source : http://tile.stamen.com/terrain/5/31/14.png</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a><span class="co"># Plot base map</span></span>
<span id="cb87-2"><a href="#cb87-2"></a>Map1              &lt;-<span class="st"> </span><span class="kw">ggmap</span>(Base_map)</span>
<span id="cb87-3"><a href="#cb87-3"></a></span>
<span id="cb87-4"><a href="#cb87-4"></a><span class="co"># Plot the path</span></span>
<span id="cb87-5"><a href="#cb87-5"></a>Map1 <span class="op">+</span><span class="st"> </span></span>
<span id="cb87-6"><a href="#cb87-6"></a><span class="st">  </span><span class="co"># Plot the track </span></span>
<span id="cb87-7"><a href="#cb87-7"></a><span class="st">  </span><span class="kw">geom_path</span>(<span class="dt">data =</span> Mangkhut_data_new, </span>
<span id="cb87-8"><a href="#cb87-8"></a>            <span class="kw">aes</span>(<span class="dt">color=</span>speed), <span class="dt">size=</span><span class="fl">1.5</span>, </span>
<span id="cb87-9"><a href="#cb87-9"></a>            <span class="dt">lineend =</span> <span class="st">&quot;round&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb87-10"><a href="#cb87-10"></a><span class="st">  </span><span class="co"># Set the color</span></span>
<span id="cb87-11"><a href="#cb87-11"></a><span class="st">  </span><span class="kw">scale_colour_gradient</span>(<span class="st">&quot;Max Wind Speed (m/s)&quot;</span>, <span class="dt">low =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb87-12"><a href="#cb87-12"></a>                        <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">60</span>, <span class="dt">by =</span> <span class="dv">10</span>)) <span class="op">+</span></span>
<span id="cb87-13"><a href="#cb87-13"></a><span class="st">  </span><span class="co"># Change labels</span></span>
<span id="cb87-14"><a href="#cb87-14"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Latitude&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Longitude&quot;</span>, <span class="dt">title=</span><span class="st">&quot;Typhoon Mangkhut Track&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># label the axes</span></span>
<span id="cb87-15"><a href="#cb87-15"></a><span class="st">  </span><span class="kw">theme_bw</span>() </span></code></pre></div>
<p><img src="S20_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<hr />
</div>
</div>
<div id="in-class-exercises" class="section level1">
<h1>In-class exercises</h1>
<div id="exercise-1" class="section level2">
<h2>Exercise #1</h2>
<p>Plot wind speed in Nov. near your hometown (a <code>10</code> degree by <code>10</code> degree domain) using the <code>Wind_Nov</code> object.</p>
</div>
<div id="exercise-2" class="section level2">
<h2>Exercise #2</h2>
<p>Plot a map of your home city (zoom=15), and add a few points to the map.</p>
<hr />
</div>
</div>
<div id="further-reading" class="section level1">
<h1>Further reading</h1>
<ul>
<li><p><a href="https://cengel.github.io/rspatial/2_spDataTypes.nb.html">Introduction to Spatial Data Types in R</a></p></li>
<li><p><a href="https://cengel.github.io/rspatial/">Introduction to Mapping and Spatial Analysis with R</a></p></li>
<li><p><a href="https://cran.r-project.org/web/views/Spatial.html">CRAN Task View: Analysis of Spatial Data</a></p></li>
<li><p><a href="https://hautahi.com/rmaps">Mapping Spatial Data in R</a></p></li>
<li><p><a href="https://www.neonscience.org/resources/learning-hub/tutorials/raster-data-r">Raster Data in R - The Basics</a></p></li>
<li><p><a href="https://cfss.uchicago.edu/notes/raster-maps-with-ggmap/">Drawing raster maps with ggmap</a></p></li>
<li><p>Roger S. Bivand, Edzer J. Pebesma, Virgilio Gómez-Rubio, Applied Spatial Data Analysis with R.</p></li>
</ul>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = false;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>

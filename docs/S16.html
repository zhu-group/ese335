<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Section 16 Multiple linear regression</title>

<script src="site_libs/header-attrs-2.24/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Environmental Data Analysis</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Syllabus.html">
    <span class="fa fa-bell-o"></span>
     
    Syllabus
  </a>
</li>
<li>
  <a href="Schedule.html">
    <span class="fa fa-calendar"></span>
     
    Schedule
  </a>
</li>
<li>
  <a href="Resource.html">
    <span class="fa fa-wrench"></span>
     
    Resource
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-laptop"></span>
     
    Assignments
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="A01.html">Assignment 01</a>
    </li>
    <li>
      <a href="A02.html">Assignment 02</a>
    </li>
    <li>
      <a href="A03.html">Assignment 03</a>
    </li>
    <li>
      <a href="A04.html">Assignment 04</a>
    </li>
    <li>
      <a href="A05.html">Assignment 05</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Section 16 Multiple linear regression</h1>

</div>


<hr />
<div id="prerequisites" class="section level1">
<h1>Prerequisites</h1>
<p>Load the libraries with R:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(GGally)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;GGally&#39;是用R版本4.3.3 来建造的</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;GGally&#39;:
##   method from   
##   +.gg   ggplot2</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">library</span>(olsrr)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;olsrr&#39;是用R版本4.3.3 来建造的</code></pre>
<pre><code>## 
## 载入程辑包：&#39;olsrr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:datasets&#39;:
## 
##     rivers</code></pre>
<hr />
</div>
<div id="section-example-surface-ozone-and-meteorological-factors"
class="section level1">
<h1>Section example: Surface ozone and meteorological factors</h1>
<p><img src="figs/ozone.jpg" alt="drawing" width="700"/></p>
<p><a
href="https://www.climatecentral.org/climate-matters/ozone-pollution-the-good-the-bad-and-the-dirty">Photo
source</a></p>
<p>Ozone (O<sub>3</sub>) occurs both in the Earth’s upper atmosphere and
at ground level. <strong>Ozone can be good or bad</strong>, depending on
where it is found. Called stratospheric ozone, good ozone occurs
naturally in the upper atmosphere, where it forms a protective layer
that shields us from the sun’s harmful ultraviolet rays. Ozone at ground
level, however, is a harmful air pollutant, because of its effects on
people and the environment, and it is the main ingredient in smog. Check
<a
href="https://www.epa.gov/ground-level-ozone-pollution/ground-level-ozone-basics">ozone
facts from EPA</a> for more.</p>
<p>Ozone is produced when nitrogen oxides and volatile organic compounds
react. Meteorological conditions also govern ozone levels. Here we use
observations to examine the relationship between ozone and several
meteorological factors, including solar radiation, wind speed,
temperature, and surface pressure. The data set is <a
href="https://zhu-group.github.io/ese335/download/ozone_data.csv">available
here</a>.</p>
<p>Load the observations via:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># Read ozone and meteorological data</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>Ozone_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">&quot;ozone_data.csv&quot;</span>, <span class="at">header=</span>T)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co"># Check the data</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="fu">str</span>(Ozone_data)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    111 obs. of  7 variables:
##  $ Solar.Rad  : int  190 118 149 313 299 99 19 256 290 274 ...
##  $ Wind.Speed : num  7.4 8 12.6 11.5 8.6 13.8 20.1 9.7 9.2 10.9 ...
##  $ Temperature: int  67 72 74 62 65 59 61 69 66 68 ...
##  $ Pressure   : num  1004 995 999 997 996 ...
##  $ Ozone      : int  41 36 12 18 23 19 8 16 11 14 ...
##  $ Month      : int  5 5 5 5 5 5 5 5 5 5 ...
##  $ Day        : int  1 2 3 4 7 8 9 12 13 14 ...</code></pre>
<hr />
</div>
<div id="multiple-linear-regression-basics" class="section level1">
<h1>Multiple linear regression basics</h1>
<div id="the-model" class="section level2">
<h2>The model</h2>
<p>You can consider the multiple linear regression as an extended simple
linear regression. But now, we have <strong>more than one independent
variables</strong> (<em>X<sub>1</sub></em>,<em>X<sub>2</sub></em>, …,
<em>X<sub>k</sub></em>) and <strong>one dependent variable</strong>
(<em>Y</em>). The multiple linear regression model goes as follow:</p>
<p><span class="math display">\[Y= \beta_0 + \beta_1 X_1 + \beta_2 X_2 +
... + \beta_k X_k + \epsilon \]</span> Here the coefficient (e.g., <span
class="math inline">\(\beta_k\)</span>) is interpreted as the estimated
mean change in the dependent variable <em>Y</em> corresponding to one
unit change in the independent variable (i.e., <span
class="math inline">\(X_k\)</span>), <strong>when all other variables
remain the same</strong>.</p>
<p>The assumptions are the same as those of simple linear regression -
existence, independence of <em>Y</em>, linearity, homoscedasticity, and
normality of residuals. In fact, the complexity of multiple linear
regression is not from the model fitting, but rather from the selection
of independent variables. The ideal is to have enough (not more)
independent variables to be correlated with the dependent variable, but
not with each other.</p>
</div>
<div id="multicollinearity" class="section level2">
<h2>Multicollinearity</h2>
<p>Since we are dealing with more than one independent variables in
multiple linear regression, it is very likely that one independent
variable correlates with another variable. For example, you will find
temperature correlates significantly (<em>r</em>=<code>-0.46</code>)
with wind speed in the section example.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Plot scatter plots</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="fu">ggpairs</span>(Ozone_data,<span class="at">columns=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span></code></pre></div>
<p><img src="figs/ozone_plot.png" alt="drawing" width="800"/></p>
<p><em>Multicollinearity</em> in a multiple regression model indicates
that collinear independent variables are related in some fashion. In
other words, multicollinearity can exist when two independent variables
are highly correlated. It can also happen if an independent variable is
computed from other variables in the data set or if two independent
variables provide similar and repetitive results (called redundant
variable).</p>
</div>
<div id="overfitting" class="section level2">
<h2>Overfitting</h2>
<p><em>Overfitting</em> means the model contains more parameters than
can be justified by the data. In this case, your model begins to
describe the random error in the data rather than the relationships
between variables. For example, pressure is not significantly correlated
with ozone in the section example. This means pressure may bring not
much new additional information (called irrelevant variable).
Overfitting can produce misleading R<sup>2</sup>, regression
coefficients, and p-values.</p>
<hr />
</div>
</div>
<div id="variable-selection" class="section level1">
<h1>Variable selection</h1>
<p>Variable selection in multiple regression is the
<strong>hardest</strong> part of model building. The purpose of variable
selection to identify the <strong>best</strong> subset of predictors
among many variables to include in a model. The issue is how to find the
necessary variables among the complete set of variables by deleting both
irrelevant variables (variables not affecting the dependent variable),
and redundant variables (variables not adding anything to the dependent
variable). Many variable selection methods exist. Each provides a
solution to one of the most important problems in statistics. Check <a
href="https://advstats.psychstat.org/book/mregression/selection.php">Variable
Selection in Multiple Regression</a> and Ch. 12 (<em>Strategies for
variable Selection</em>) of [RS] for more.</p>
<p>The general theme of the variable selection is to examine certain
subsets and select the best subset, which either maximizes or minimizes
an <strong>appropriate criterion</strong>. More specifically, a model
selection method usually should include the following three
components:</p>
<ul>
<li><p>Select a test statistic</p></li>
<li><p>Select a criterion for the selected test statistic</p></li>
<li><p>Make a decision on removing/keeping a variable</p></li>
</ul>
<div id="statistic-for-variable-selection" class="section level2">
<h2>Statistic for variable selection</h2>
<div id="p-value" class="section level3">
<h3>P-value</h3>
<p>If a predictor is significant, it can be included in a regression
model.</p>
</div>
<div id="r2-or-adjusted-r2" class="section level3">
<h3>R<sup>2</sup> or adjusted R<sup>2</sup></h3>
<p>If a predictor can contribute significantly to the overall
R<sup>2</sup> or adjusted R<sup>2</sup>, it should be considered to be
included in the model.</p>
</div>
<div id="mallows-cp" class="section level3">
<h3>Mallows’ Cp</h3>
<p>This one is widely used in variable selection.</p>
<p><span class="math display">\[C_p = \frac {SSE_p} {MSE_k} - n + 2(p+1)
\]</span> where <em>SSE<sub>p</sub></em> is the sum of squared errors
for the model with <em>p</em> independent variables and
<em>MSE<sub>k</sub></em> is the mean squared residuals for the model
with all <em>k</em> independent variables, <em>n</em> is sample size. We
look for a subset of variables with <span class="math inline">\(C_p \le
p+1\)</span>, where <em>p</em> is the number of independent variables.
If <em>C<sub>p</sub></em> is much bigger than <em>p+1</em>, this
indicates a bad fit.</p>
</div>
<div id="aic" class="section level3">
<h3>AIC</h3>
<p>Akaike Information Criterion (AIC) measures a trade-off between the
goodness of model fit (<em>SSE</em>) and model complexity (<em>p</em>).
With more independent variables in a regression model, <em>SSE</em>
typically would become smaller or at least the same, and therefore the
first part of AIC becomes smaller. However, with independent variables,
the model would become more complex, and therefore the second part of
AIC becomes bigger.</p>
<p><span class="math display">\[AIC = n \mathrm {ln}(\frac {SSE} {n}) +
2p\]</span></p>
</div>
<div id="bic" class="section level3">
<h3>BIC</h3>
<p>Bayesian information criteria (BIC) is a variant of AIC with a
stronger penalty for including additional variables in the model. The
<strong>lower</strong> the BIC, the better the model.</p>
<p><span class="math display">\[BIC = n \mathrm {ln}(\frac {SSE} {n}) +
p \mathrm {ln}(n)\]</span></p>
</div>
<div id="occams-razor" class="section level3">
<h3>Occam’s razor</h3>
<p>If all the above statistics are close, and it’s hard to choose from
two models, use the one with <em>fewer</em> independent variables.</p>
</div>
</div>
<div id="all-possible-subsets-approach" class="section level2">
<h2>All possible subsets approach</h2>
<p>The basic idea of the all possible subsets approach is to run
<strong>every possible</strong> combination of independent variables to
find the best subset to meet some pre-defined objective criteria. In R,
you can use the <code>ols_step_all_possible</code> function from
<code>olsrr</code> package to test all possible subsets of the set of
potential independent variables.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Fit the full model, where all independent variables are included </span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>full_model  <span class="ot">&lt;-</span> <span class="fu">lm</span>(Ozone <span class="sc">~</span> Solar.Rad <span class="sc">+</span> Wind.Speed <span class="sc">+</span> Temperature <span class="sc">+</span> Pressure, <span class="at">data =</span> Ozone_data)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co"># Test all possible subsets</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>output      <span class="ot">&lt;-</span> <span class="fu">ols_step_all_possible</span>(full_model)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co"># Print results from all possible subsets</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>output</span></code></pre></div>
<pre><code>##    Index N                                Predictors   R-Square Adj. R-Square Mallow&#39;s Cp
## 3      1 1                               Temperature 0.48796010   0.483262487  0.47265244
## 2      2 1                                Wind.Speed 0.37515206   0.369419506  0.34538506
## 1      3 1                                 Solar.Rad 0.12134194   0.113280852  0.09466873
## 4      4 1                                  Pressure 0.01386988   0.004822813 -0.02855280
## 8      5 2                    Wind.Speed Temperature 0.58137796   0.573625704  0.55266125
## 6      6 2                     Solar.Rad Temperature 0.51031674   0.501248530  0.48921976
## 10     7 2                      Temperature Pressure 0.50295658   0.493752075  0.47379229
## 5      8 2                      Solar.Rad Wind.Speed 0.44949359   0.439299032  0.41460819
## 9      9 2                       Wind.Speed Pressure 0.37516124   0.363590154  0.32877850
## 7     10 2                        Solar.Rad Pressure 0.13531809   0.119305459  0.08749387
## 11    11 3          Solar.Rad Wind.Speed Temperature 0.60589460   0.594844916  0.57275819
## 14    12 3           Wind.Speed Temperature Pressure 0.58421695   0.572559484  0.54099944
## 13    13 3            Solar.Rad Temperature Pressure 0.52528716   0.511977451  0.49089734
## 12    14 3             Solar.Rad Wind.Speed Pressure 0.44951263   0.434078406  0.39956084
## 15    15 4 Solar.Rad Wind.Speed Temperature Pressure 0.60863144   0.593862815  0.56171795</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Plot results from all possible subsets</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">plot</span>(output)</span></code></pre></div>
<p><img src="S16_files/figure-html/unnamed-chunk-4-1.png" width="672" /><img src="S16_files/figure-html/unnamed-chunk-4-2.png" width="672" /></p>
</div>
<div id="all-best-subsets-approach" class="section level2">
<h2>All best subsets approach</h2>
<p>This approach selects the best-fitted model as a certain number of
variables are included. We can then select the overall best model by
comparing the statistics among those models.</p>
<p>In R, you can print the best fitted models with the
<code>ols_step_best_subset()</code> function:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">ols_step_best_subset</span>(full_model)</span></code></pre></div>
<pre><code>##                 Best Subsets Regression                 
## --------------------------------------------------------
## Model Index    Predictors
## --------------------------------------------------------
##      1         Temperature                               
##      2         Wind.Speed Temperature                    
##      3         Solar.Rad Wind.Speed Temperature          
##      4         Solar.Rad Wind.Speed Temperature Pressure 
## --------------------------------------------------------
## 
##                                                        Subsets Regression Summary                                                       
## ----------------------------------------------------------------------------------------------------------------------------------------
##                        Adj.        Pred                                                                                                  
## Model    R-Square    R-Square    R-Square     C(p)         AIC         SBIC         SBC          MSEP         FPE        HSP       APC  
## ----------------------------------------------------------------------------------------------------------------------------------------
##   1        0.4880      0.4833      0.4727    31.6832    1023.7751    707.8926    1031.9037    63511.9852    582.4878    5.2979    0.5308 
##   2        0.5814      0.5736      0.5527     8.3815    1003.4160    688.2847    1014.2541    52409.9744    484.8800    4.4123    0.4419 
##   3        0.6059      0.5948      0.5728     3.7413     998.7171    684.0287    1012.2648    49806.0569    464.7908    4.2323    0.4236 
##   4        0.6086      0.5939      0.5617     5.0000     999.9436    685.4065    1016.2008    49931.2312    469.9690    4.2830    0.4283 
## ----------------------------------------------------------------------------------------------------------------------------------------
## AIC: Akaike Information Criteria 
##  SBIC: Sawa&#39;s Bayesian Information Criteria 
##  SBC: Schwarz Bayesian Criteria 
##  MSEP: Estimated error of prediction, assuming multivariate normality 
##  FPE: Final Prediction Error 
##  HSP: Hocking&#39;s Sp 
##  APC: Amemiya Prediction Criteria</code></pre>
<p>In this case, we will choose model <code>#3</code> as it has the
highest adjusted R<sup>2</sup>, lowest AIC, and a <span
class="math inline">\(C_p \le 3+1\)</span>.</p>
</div>
<div id="auto-selection" class="section level2">
<h2>Auto selection</h2>
<div id="backward-elimination" class="section level3">
<h3>Backward elimination</h3>
<p>Backward elimination begins with a model which includes all candidate
variables (so-called full model). Variables are then deleted from the
model one by one until all the variables remaining in the model are
significant and exceed certain criteria. At each step, the variable
showing the smallest improvement to the model is deleted. Once a
variable is deleted, it cannot come back to the model.</p>
<p>Backward elimination works well if you have a modest-sized set of
potential variables from which you wish to eliminate a few – i.e. if
you’re fine-tuning some prior selection of variables–you should
generally go backward.</p>
<p>In R, this is done with the <code>ols_step_backward_aic()</code>
function:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">ols_step_backward_aic</span>(full_model, <span class="at">details=</span>F)</span></code></pre></div>
<pre><code>## 
## 
##                               Stepwise Summary                              
## --------------------------------------------------------------------------
## Step    Variable        AIC        SBC        SBIC        R2       Adj. R2 
## --------------------------------------------------------------------------
##  0      Full Model    999.944    1016.201    685.406    0.60863    0.59386 
##  1      Pressure      998.717    1012.265    684.009    0.60589    0.59484 
## --------------------------------------------------------------------------
## 
## Final Model Output 
## ------------------
## 
##                           Model Summary                           
## -----------------------------------------------------------------
## R                        0.778       RMSE                 20.796 
## R-Squared                0.606       MSE                 448.624 
## Adj. R-Squared           0.595       Coef. Var            50.312 
## Pred R-Squared           0.573       AIC                 998.717 
## MAE                     15.468       SBC                1012.265 
## -----------------------------------------------------------------
##  RMSE: Root Mean Square Error 
##  MSE: Mean Square Error 
##  MAE: Mean Absolute Error 
##  AIC: Akaike Information Criteria 
##  SBC: Schwarz Bayesian Criteria 
## 
##                                  ANOVA                                  
## -----------------------------------------------------------------------
##                   Sum of                                               
##                  Squares         DF    Mean Square      F         Sig. 
## -----------------------------------------------------------------------
## Regression     73799.119          3      24599.706    54.834    0.0000 
## Residual       48002.790        107        448.624                     
## Total         121801.910        110                                    
## -----------------------------------------------------------------------
## 
##                                     Parameter Estimates                                      
## --------------------------------------------------------------------------------------------
##       model       Beta    Std. Error    Std. Beta      t        Sig        lower      upper 
## --------------------------------------------------------------------------------------------
## (Intercept)    -64.342        23.055                 -2.791    0.006    -110.045    -18.639 
##   Solar.Rad      0.060         0.023        0.164     2.580    0.011       0.014      0.106 
##  Wind.Speed     -3.334         0.654       -0.356    -5.094    0.000      -4.631     -2.036 
## Temperature      1.652         0.254        0.473     6.516    0.000       1.149      2.155 
## --------------------------------------------------------------------------------------------</code></pre>
<p>Here we remove the pressure variable from the full model.</p>
</div>
<div id="forward-selection" class="section level3">
<h3>Forward selection</h3>
<p>Forward selection begins with a model which includes no predictors
(the intercept-only model, so-called null model). Variables are then
added to the model one by one until no remaining variables improve the
model by a certain criterion. At each step, the variable showing the
biggest improvement to the model is added. Once a variable is in the
model, it remains there.</p>
<p>Forward selection works well if you have a very large set of
candidate predictors from which you wish to extract a few.</p>
<p>In R, this is done with the <code>ols_step_forward_aic()</code>
function:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">ols_step_forward_aic</span>(full_model, <span class="at">details=</span>F)</span></code></pre></div>
<pre><code>## 
## 
##                                Stepwise Summary                               
## ----------------------------------------------------------------------------
## Step    Variable         AIC         SBC        SBIC        R2       Adj. R2 
## ----------------------------------------------------------------------------
##  0      Base Model     1096.073    1101.492    779.192    0.00000    0.00000 
##  1      Temperature    1023.775    1031.904    707.893    0.48796    0.48326 
##  2      Wind.Speed     1003.416    1014.254    688.285    0.58138    0.57363 
##  3      Solar.Rad       998.717    1012.265    684.029    0.60589    0.59484 
## ----------------------------------------------------------------------------
## 
## Final Model Output 
## ------------------
## 
##                           Model Summary                           
## -----------------------------------------------------------------
## R                        0.778       RMSE                 20.796 
## R-Squared                0.606       MSE                 448.624 
## Adj. R-Squared           0.595       Coef. Var            50.312 
## Pred R-Squared           0.573       AIC                 998.717 
## MAE                     15.468       SBC                1012.265 
## -----------------------------------------------------------------
##  RMSE: Root Mean Square Error 
##  MSE: Mean Square Error 
##  MAE: Mean Absolute Error 
##  AIC: Akaike Information Criteria 
##  SBC: Schwarz Bayesian Criteria 
## 
##                                  ANOVA                                  
## -----------------------------------------------------------------------
##                   Sum of                                               
##                  Squares         DF    Mean Square      F         Sig. 
## -----------------------------------------------------------------------
## Regression     73799.119          3      24599.706    54.834    0.0000 
## Residual       48002.790        107        448.624                     
## Total         121801.910        110                                    
## -----------------------------------------------------------------------
## 
##                                     Parameter Estimates                                      
## --------------------------------------------------------------------------------------------
##       model       Beta    Std. Error    Std. Beta      t        Sig        lower      upper 
## --------------------------------------------------------------------------------------------
## (Intercept)    -64.342        23.055                 -2.791    0.006    -110.045    -18.639 
## Temperature      1.652         0.254        0.473     6.516    0.000       1.149      2.155 
##  Wind.Speed     -3.334         0.654       -0.356    -5.094    0.000      -4.631     -2.036 
##   Solar.Rad      0.060         0.023        0.164     2.580    0.011       0.014      0.106 
## --------------------------------------------------------------------------------------------</code></pre>
<p>Here we include temperature, wind speed, and solar radiation one by
one, each at a step.</p>
</div>
<div id="stepwise-regression" class="section level3">
<h3>Stepwise regression</h3>
<p>Stepwise regression is a combination of both backward elimination and
forward selection methods. The stepwise method is a modification of the
forward selection approach and differs in that variables already in the
model do not necessarily stay. As in forward selection, stepwise
regression adds one variable to the model at a time. After a variable is
added, however, stepwise regression checks all the variables already
included again to see whether there is a need to delete any variable
that does not provide an improvement to the model based on a certain
criterion.</p>
<p>In R, this is done with the <code>ols_step_both_aic()</code>
function:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">ols_step_both_aic</span>(full_model, <span class="at">details=</span>F)</span></code></pre></div>
<pre><code>## 
## 
##                                  Stepwise Summary                                 
## --------------------------------------------------------------------------------
## Step    Variable             AIC         SBC        SBIC        R2       Adj. R2 
## --------------------------------------------------------------------------------
##  0      Base Model         1096.073    1101.492    779.192    0.00000    0.00000 
##  1      Temperature (+)    1023.775    1031.904    707.893    0.48796    0.48326 
##  2      Wind.Speed (+)     1003.416    1014.254    688.285    0.58138    0.57363 
##  3      Solar.Rad (+)       998.717    1012.265    684.029    0.60589    0.59484 
## --------------------------------------------------------------------------------
## 
## Final Model Output 
## ------------------
## 
##                           Model Summary                           
## -----------------------------------------------------------------
## R                        0.778       RMSE                 20.796 
## R-Squared                0.606       MSE                 448.624 
## Adj. R-Squared           0.595       Coef. Var            50.312 
## Pred R-Squared           0.573       AIC                 998.717 
## MAE                     15.468       SBC                1012.265 
## -----------------------------------------------------------------
##  RMSE: Root Mean Square Error 
##  MSE: Mean Square Error 
##  MAE: Mean Absolute Error 
##  AIC: Akaike Information Criteria 
##  SBC: Schwarz Bayesian Criteria 
## 
##                                  ANOVA                                  
## -----------------------------------------------------------------------
##                   Sum of                                               
##                  Squares         DF    Mean Square      F         Sig. 
## -----------------------------------------------------------------------
## Regression     73799.119          3      24599.706    54.834    0.0000 
## Residual       48002.790        107        448.624                     
## Total         121801.910        110                                    
## -----------------------------------------------------------------------
## 
##                                     Parameter Estimates                                      
## --------------------------------------------------------------------------------------------
##       model       Beta    Std. Error    Std. Beta      t        Sig        lower      upper 
## --------------------------------------------------------------------------------------------
## (Intercept)    -64.342        23.055                 -2.791    0.006    -110.045    -18.639 
## Temperature      1.652         0.254        0.473     6.516    0.000       1.149      2.155 
##  Wind.Speed     -3.334         0.654       -0.356    -5.094    0.000      -4.631     -2.036 
##   Solar.Rad      0.060         0.023        0.164     2.580    0.011       0.014      0.106 
## --------------------------------------------------------------------------------------------</code></pre>
<p>The final model includes temperature, wind speed, and solar
radiation.</p>
<hr />
</div>
</div>
</div>
<div id="making-predictions-with-the-model" class="section level1">
<h1>Making predictions with the model</h1>
<p>Once the best model is selected, we can use it to predict mean and
individual response. Here the R functions are the same as we saw in the
simple linear regression.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># Best model</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(Ozone <span class="sc">~</span> Solar.Rad <span class="sc">+</span> Wind.Speed <span class="sc">+</span> Temperature , <span class="at">data =</span> Ozone_data)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="fu">summary</span>(reg)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Ozone ~ Solar.Rad + Wind.Speed + Temperature, data = Ozone_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -40.485 -14.219  -3.551  10.097  95.619 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -64.34208   23.05472  -2.791  0.00623 ** 
## Solar.Rad     0.05982    0.02319   2.580  0.01124 *  
## Wind.Speed   -3.33359    0.65441  -5.094 1.52e-06 ***
## Temperature   1.65209    0.25353   6.516 2.42e-09 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 21.18 on 107 degrees of freedom
## Multiple R-squared:  0.6059, Adjusted R-squared:  0.5948 
## F-statistic: 54.83 on 3 and 107 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="co"># Make confidence band</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="fu">predict</span>(reg, <span class="at">interval=</span><span class="st">&quot;confidence&quot;</span>, <span class="at">level=</span><span class="fl">0.95</span>)</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="co"># Make prediction band</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="fu">predict</span>(reg, <span class="at">interval=</span><span class="st">&quot;prediction&quot;</span>, <span class="at">level=</span><span class="fl">0.95</span>)</span></code></pre></div>
<hr />
<div id="procedure-of-the-multiple-linear-regression"
class="section level2">
<h2>Procedure of the multiple linear regression</h2>
</div>
<div id="check-data" class="section level2">
<h2>1 Check data</h2>
<ul>
<li><p>Statistical test: independence of Y and possible
outliers</p></li>
<li><p>Visual checking: high correlation between dependent variable and
independent variable, low correlation among independent variables. The
goal is to remove irrelevant and redundant variables.</p></li>
</ul>
</div>
<div id="write-down-h0-and-h1" class="section level2">
<h2>2 Write down H0 and H1</h2>
<p>For multiple linear regression, H0 could be different depending your
questions. For example, if the goal is to determine whether there is a
linear relationship, H0 is then:</p>
<p><span class="math display">\[\beta_1 = \beta_2 = ... = \beta_k =
0\]</span> Here we test the overall model. If the goal is to test a
specific slope, H0 would be:</p>
<p><span class="math display">\[\beta_i = 0\]</span></p>
<p>Here we test the change with and without such specific slope.</p>
</div>
<div id="find-the-best-model" class="section level2">
<h2>3 Find the best model</h2>
<p>The rule is to find a model with higher adjusted R<sup>2</sup>, lower
AIC, and a <span class="math inline">\(C_p \le p+1\)</span> (<em>p</em>
being the number of independent variables included in the model).</p>
</div>
<div id="check-residuals" class="section level2">
<h2>4 Check residuals</h2>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="fu">plot</span>(reg)</span></code></pre></div>
<p><img src="S16_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p>Here in the residuals vs. fitted plot, we see a roughly horizontal
line is expected (linearity checked). In the Scale-location plot, we
also see a roughly horizontal line (homoscedasticity checked). Finally,
the residuals are following a normal distribution by examining the
normal Q-Q plot (normality checked).</p>
</div>
<div id="report-the-results" class="section level2">
<h2>5 Report the results</h2>
<ul>
<li><p>A brief description of the variables you used</p></li>
<li><p>Report the slope, intercept, R<sup>2</sup>, and adjusted
R<sup>2</sup></p></li>
<li><p>Report predictions if necessary</p></li>
</ul>
<hr />
</div>
</div>
<div id="in-class-exercises" class="section level1">
<h1>In-class exercises</h1>
<div id="exercise-1" class="section level2">
<h2>Exercise #1</h2>
<p>In this exercise, we will learn the concept of
<em>cross-validation</em> and how to use it to test the model. The goal
of cross-validation is to test the model’s ability to predict new data
that was not used in estimating it, in order to flag problems like
overfitting or selection bias and to give an insight on how the model
will generalize to an independent dataset (i.e., an unknown dataset, for
instance from a real problem).</p>
<p>One round of cross-validation involves <strong>partitioning a sample
of data into complementary subsets</strong>, performing the analysis on
one subset (called the training set), and validating the analysis on the
other subset (called the validation set). To reduce variability, in most
methods, multiple rounds of cross-validation are performed using
different partitions, and the validation results are combined (e.g.,
averaged) over the rounds to give an estimate of the model’s predictive
performance.</p>
<p>We will use the CPU performance data from the MASS package.</p>
<p><strong>1.1</strong> Load the data <code>cpus</code> in the
<code>MASS</code> package by:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a><span class="fu">data</span>(cpus)</span></code></pre></div>
<p><strong>1.2</strong> Use <code>85%</code> of the data points to form
a training set, and the rest data points as the validation set</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>fraction        <span class="ot">&lt;-</span> <span class="fl">0.85</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>sample_index    <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(cpus),<span class="fu">nrow</span>(cpus)<span class="sc">*</span>fraction)</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>cpus_training   <span class="ot">&lt;-</span> cpus[sample_index,]</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>cpus_validation <span class="ot">&lt;-</span> cpus[<span class="sc">-</span>sample_index,]</span></code></pre></div>
<p><strong>1.3</strong> Use the <code>ggpairs()</code> function to check
the linear relationship between dependent variable <code>perf</code> and
each independent variable (<code>syct</code>, <code>mmin</code>,
<code>mmax</code>, <code>cach</code>, <code>chmin</code>,
<code>chmax</code>) in <code>cpus_training</code>.</p>
<p><strong>1.4</strong> Fit a regression model between dependent
variable <code>perf</code> and all independent variables
(<code>syct</code>, <code>mmin</code>, <code>mmax</code>,
<code>cach</code>, <code>chmin</code>, <code>chmax</code>). What is the
adjusted R<sup>2</sup>? Which independent variable(s) has an
insignificant slope?</p>
<p><strong>1.5</strong> Use the all possible subsets approach to find
the best model. Please justify your selection.</p>
<p><strong>1.6</strong> Use the all best subsets approach to find the
best model. Please justify your selection.</p>
<p><strong>1.7</strong> Use backward elimination approach to find the
best model.</p>
<p><strong>1.8</strong> Use forward selection approach to find the best
model.</p>
<p><strong>1.9</strong> Use stepwise regression approach to find the
best model.</p>
<p><strong>1.10</strong> Give your best linear model based on results
from step <code>5-9</code>.</p>
<p><strong>1.11</strong> Apply the best linear model model_from step
<code>10</code> to <code>cpus_validation</code> subset, get the
individual prediction of CPU performance (<code>perf</code>) using the
<code>predict()</code> function. Compare predicted CPU performance with
actual values in <code>cpus_validation</code> in terms of Pearson
correlation coefficient and relative mean bias.</p>
<p><strong>1.12</strong> Use the linear model model_from step
<code>10</code>, repeat step <code>2</code> and <code>11</code> for
<code>50</code> times. Each time, you will end up with different
<code>cpus_training</code>, <code>cpus_validation</code>, Pearson
correlation coefficient, and relative mean bias. Report the mean Pearson
correlation coefficient and mean relative mean bias. Based on the
cross-validation result, is the model a reliable one?</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = false;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>

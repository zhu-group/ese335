<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Section 05 Data wrangling and quick plots</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/spacelab.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 52px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h2 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h3 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h4 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h5 {
  padding-top: 57px;
  margin-top: -57px;
}
.section h6 {
  padding-top: 57px;
  margin-top: -57px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Environmental Data Analysis</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Syllabus.html">
    <span class="fa fa-bell-o"></span>
     
    Syllabus
  </a>
</li>
<li>
  <a href="Schedule.html">
    <span class="fa fa-calendar"></span>
     
    Schedule
  </a>
</li>
<li>
  <a href="Resource.html">
    <span class="fa fa-wrench"></span>
     
    Resource
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-laptop"></span>
     
    Assignments
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="download/Assignment_01.pdf">Assignment 01</a>
    </li>
    <li>
      <a href="download/Assignment_02.pdf">Assignment 02</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Section 05 Data wrangling and quick plots</h1>

</div>


<hr />
<div id="prerequisites" class="section level1">
<h1>Prerequisites</h1>
<p>Install the following packages:</p>
<ul>
<li><code>tidyr</code></li>
<li><code>dplyr</code></li>
<li><code>ggplot2</code></li>
</ul>
<p>Load the libraries with R:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(tidyr)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(dplyr)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">library</span>(ggplot2)</span></code></pre></div>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 4.0.4</code></pre>
<hr />
</div>
<div id="section-example-weather-data-from-baoan-airport" class="section level1">
<h1>Section Example: weather data from BaoAn airport</h1>
<p>Environment data, expecially raw observations, are really messy. Here we take a look at hourly weather data measured at BaoAn International Airport during the past 10 years. The data set is from <a href="https://www.ncei.noaa.gov/metadata/geoportal/rest/metadata/item/gov.noaa.ncdc%3AC00532/html">NOAA Integrated Surface Dataset</a>.</p>
<p>Download the file <a href="https://zhu-group.github.io/ese335/download/2281305.zip">2281305.zip</a>, where the number <code>2281305</code> is the site ID.</p>
<p>Extract the zip file, you should see a file named <code>2281305.csv</code>.</p>
<p>Open the file, you see many columns and even more lines, with no clear meaning and definitions. This is very often you would encounter when work with environmental data. As Hadley Wickham puts it, “Tidy datasets are all alike, but every messy dataset is messy in its own way.”</p>
<hr />
<p><em>The notes below are modified from the excellent <a href="http://swcarpentry.github.io/r-novice-gapminder/">Dataframe Manipulation</a> and freely available on the Software Carpentry website.</em></p>
<hr />
</div>
<div id="tidy-data" class="section level1">
<h1>Tidy data</h1>
<p>In this section, we will learn a consistent way to organize the data in R, called <strong>tidy data</strong>. Getting the data into this format requires some upfront work, but that work pays off in the long term. Once you have tidy data and the tools provided by the <code>tidyr</code>, <code>dplyr</code> and <code>ggplot2</code> packages, you will spend much less time munging/wrangling data from one representation to another, allowing you to spend more time on the analytic questions at hand.</p>
<div id="tibble" class="section level2">
<h2>Tibble</h2>
<p>For now, we will use <code>tibble</code> instead of R’s traditional <code>data.frame</code>. Tibble is a data frame, but they tweak some older behaviors to make life a little easier.</p>
<p>Let’s use <code>Keeling_Data</code> as an example:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>Keeling_Data &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file =</span> <span class="st">&quot;co2_mm_mlo.csv&quot;</span>, <span class="dt">header =</span> T)</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="kw">head</span>(Keeling_Data)</span></code></pre></div>
<pre><code>##   year  month decimal_date    co2 quality
## 1 1958  March     1958.208 315.71       1
## 2 1958  April     1958.292 317.45       1
## 3 1958    May     1958.375 317.50       1
## 4 1958   June     1958.458 -99.99       0
## 5 1958   July     1958.542 315.86       1
## 6 1958 August     1958.625 314.93       1</code></pre>
<p>You can coerce a <code>data.frame</code> to a <code>tibble</code> using the <code>as_tibble()</code> function:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>Keeling_Data_tbl &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(Keeling_Data)</span>
<span id="cb9-2"><a href="#cb9-2"></a>Keeling_Data_tbl</span></code></pre></div>
<pre><code>## # A tibble: 754 x 5
##     year month     decimal_date   co2 quality
##    &lt;int&gt; &lt;chr&gt;            &lt;dbl&gt; &lt;dbl&gt;   &lt;int&gt;
##  1  1958 March            1958.  316.       1
##  2  1958 April            1958.  317.       1
##  3  1958 May              1958.  318.       1
##  4  1958 June             1958. -100.       0
##  5  1958 July             1959.  316.       1
##  6  1958 August           1959.  315.       1
##  7  1958 September        1959.  313.       1
##  8  1958 October          1959. -100.       0
##  9  1958 November         1959.  313.       1
## 10  1958 December         1959.  315.       1
## # ... with 744 more rows</code></pre>
</div>
<div id="tidy-dataset" class="section level2">
<h2>Tidy dataset</h2>
<p>There are three inter-related rules which make a dataset tidy:</p>
<ul>
<li>Each variable must have its own column;</li>
<li>Each observation must have its own row;</li>
<li>Each value must have its own cell;</li>
</ul>
<p>These three rules are interrelated because it’s impossible to only satisfy two of the three.</p>
<p>That interrelationship leads to an even simpler set of practical instructions:</p>
<ul>
<li>Put each dataset in a tibble</li>
<li>Put each variable in a column</li>
</ul>
<p>Why ensure that your data is tidy? There are two main advantages:</p>
<ul>
<li><p>There’s a general advantage to picking one consistent way of storing data. If you have <strong>a consistent data structure</strong>, it’s easier to learn the tools that work with it because they have an <strong>underlying uniformity</strong>. If you ensure that your data is tidy, you’ll spend less time fighting with the tools and more time working on your analysis.</p></li>
<li><p>There’s a specific advantage to placing variables in columns because it allows R’s <strong>vectorized nature</strong> to shine. That makes transforming tidy data feel particularly natural. <code>tidyr</code>, <code>dplyr</code>, and <code>ggplot2</code> are designed to work with tidy data.</p></li>
</ul>
<hr />
</div>
</div>
<div id="the-dplyr-package" class="section level1">
<h1>The <code>dplyr</code> package</h1>
<p>The <code>dplyr</code> package provides a number of very useful functions for manipulating dataframes in a way that will reduce the self-repetition, reduce the probability of making errors, and probably even save you some typing. As an added bonus, you might even find the dplyr grammar easier to read.</p>
<p>Here we’re going to cover commonly used functions as well as using pipes <code>%&gt;%</code> to combine them.</p>
<div id="using-select" class="section level2">
<h2>Using <code>select()</code></h2>
<p>Use the <code>select()</code> function to keep only the variables (columns) you select.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">select</span>(Keeling_Data_tbl,year,co2,quality)</span></code></pre></div>
<pre><code>## # A tibble: 754 x 3
##     year   co2 quality
##    &lt;int&gt; &lt;dbl&gt;   &lt;int&gt;
##  1  1958  316.       1
##  2  1958  317.       1
##  3  1958  318.       1
##  4  1958 -100.       0
##  5  1958  316.       1
##  6  1958  315.       1
##  7  1958  313.       1
##  8  1958 -100.       0
##  9  1958  313.       1
## 10  1958  315.       1
## # ... with 744 more rows</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">select</span>(Keeling_Data_tbl,co2)</span></code></pre></div>
<pre><code>## # A tibble: 754 x 1
##      co2
##    &lt;dbl&gt;
##  1  316.
##  2  317.
##  3  318.
##  4 -100.
##  5  316.
##  6  315.
##  7  313.
##  8 -100.
##  9  313.
## 10  315.
## # ... with 744 more rows</code></pre>
</div>
<div id="the-pipe-symbol" class="section level2">
<h2>The pipe symbol <code>%&gt;%</code></h2>
<p>Above we used ‘normal’ grammar, but the strengths of <code>dplyr</code> and <code>tidyr</code> lie in combining several functions using <strong>pipes</strong>. Since the pipes grammar is unlike anything we’ve seen in R before, let’s repeat what we’ve done above using pipes.</p>
<p><code>x %&gt;% f(y)</code> is the same as <code>f(x, y)</code></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>Keeling_Data_tbl <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="st">  </span><span class="kw">select</span>(year,co2,quality)</span></code></pre></div>
<pre><code>## # A tibble: 754 x 3
##     year   co2 quality
##    &lt;int&gt; &lt;dbl&gt;   &lt;int&gt;
##  1  1958  316.       1
##  2  1958  317.       1
##  3  1958  318.       1
##  4  1958 -100.       0
##  5  1958  316.       1
##  6  1958  315.       1
##  7  1958  313.       1
##  8  1958 -100.       0
##  9  1958  313.       1
## 10  1958  315.       1
## # ... with 744 more rows</code></pre>
<p>The above lines mean we first call the <code>Keeling_Data_tbl</code> tibble and pass it on, using the <strong>pipe symbol</strong> <code>%&gt;%</code>, to the next step, which is the <code>select()</code> function. In this case, we don’t specify which <strong>data object</strong> we use in the <code>select()</code> function since in gets that from the previous pipe. The <code>select()</code> function then takes what it gets from the pipe, in this case the <code>Keeling_Data_tbl</code> tibble, as its <strong>first argument</strong>. By using pipe, we can take output of the previous step as input for the next one, so that we can avoid defining and calling unnecessary temporary variables. You will start to see the power of pipe later.</p>
</div>
<div id="using-filter" class="section level2">
<h2>Using <code>filter()</code></h2>
<p>Use <code>filter()</code> to get values (rows):</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>Keeling_Data_tbl <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="st">  </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">2000</span>)</span></code></pre></div>
<pre><code>## # A tibble: 12 x 5
##     year month     decimal_date   co2 quality
##    &lt;int&gt; &lt;chr&gt;            &lt;dbl&gt; &lt;dbl&gt;   &lt;int&gt;
##  1  2000 January          2000.  369.       1
##  2  2000 February         2000.  370.       1
##  3  2000 March            2000.  371.       1
##  4  2000 April            2000.  372.       1
##  5  2000 May              2000.  372.       1
##  6  2000 June             2000.  372.       1
##  7  2000 July             2001.  370.       1
##  8  2000 August           2001.  368.       1
##  9  2000 September        2001.  367        1
## 10  2000 October          2001.  367.       1
## 11  2000 November         2001.  368.       1
## 12  2000 December         2001.  370.       1</code></pre>
<p>If we now want to move forward with the above tibble, but only with <code>quality == 1</code> , we can combine <code>select()</code> and <code>filter()</code> functions:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>Keeling_Data_tbl <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="st">  </span><span class="kw">select</span>(year,co2,quality) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="st">  </span><span class="kw">filter</span>(quality <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## # A tibble: 747 x 3
##     year   co2 quality
##    &lt;int&gt; &lt;dbl&gt;   &lt;int&gt;
##  1  1958  316.       1
##  2  1958  317.       1
##  3  1958  318.       1
##  4  1958  316.       1
##  5  1958  315.       1
##  6  1958  313.       1
##  7  1958  313.       1
##  8  1958  315.       1
##  9  1959  316.       1
## 10  1959  316.       1
## # ... with 737 more rows</code></pre>
<p>You see here we have used the pipe twice, and the scripts become really clean and easy to follow.</p>
</div>
<div id="using-group_by-and-summarize" class="section level2">
<h2>Using <code>group_by()</code> and <code>summarize()</code></h2>
<p>Now try to group monthly data using the <code>group_by()</code> function, notice how the output tibble changes:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>Keeling_Data_tbl <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="st">  </span><span class="kw">select</span>(year,month,co2,quality) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="st">  </span><span class="kw">filter</span>(quality <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="st">  </span><span class="kw">group_by</span>(month)</span></code></pre></div>
<pre><code>## # A tibble: 747 x 4
## # Groups:   month [12]
##     year month       co2 quality
##    &lt;int&gt; &lt;chr&gt;     &lt;dbl&gt;   &lt;int&gt;
##  1  1958 March      316.       1
##  2  1958 April      317.       1
##  3  1958 May        318.       1
##  4  1958 July       316.       1
##  5  1958 August     315.       1
##  6  1958 September  313.       1
##  7  1958 November   313.       1
##  8  1958 December   315.       1
##  9  1959 January    316.       1
## 10  1959 February   316.       1
## # ... with 737 more rows</code></pre>
<p>The <code>group_by()</code> function is much more exciting in conjunction with the <code>summarize()</code> function. This will allow us to create new variable(s) by using functions that repeat for each of the continent-specific data frames. That is to say, using the <code>group_by()</code> function, we <strong>split our original dataframe into multiple pieces</strong>, then we can run functions (<em>e.g.</em>, <code>mean()</code> or <code>sd()</code>) within <code>summarize()</code>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>Keeling_Data_tbl <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="st">  </span><span class="kw">select</span>(year,month,co2,quality) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="st">  </span><span class="kw">filter</span>(quality <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="st">  </span><span class="kw">group_by</span>(month) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">monthly_mean =</span> <span class="kw">mean</span>(co2))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 12 x 2
##    month     monthly_mean
##    &lt;chr&gt;            &lt;dbl&gt;
##  1 April             359.
##  2 August            354.
##  3 December          356.
##  4 February          357.
##  5 January           356.
##  6 July              356.
##  7 June              359.
##  8 March             357.
##  9 May               358.
## 10 November          354.
## 11 October           353.
## 12 September         353.</code></pre>
<p>Here we create a new variable (column) <code>monthly_mean</code>, and append it to the groups (<code>month</code> in this case). Now, we get a so-called <em>monthly climatology</em>.</p>
<p>You can also use <code>arrange()</code> and <code>desc()</code> to sort the data:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>Keeling_Data_tbl <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="st">  </span><span class="kw">select</span>(year,month,co2,quality) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="st">  </span><span class="kw">filter</span>(quality <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="st">  </span><span class="kw">group_by</span>(month) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">monthly_mean =</span> <span class="kw">mean</span>(co2)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="st">  </span><span class="kw">arrange</span>(monthly_mean)</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 12 x 2
##    month     monthly_mean
##    &lt;chr&gt;            &lt;dbl&gt;
##  1 September         353.
##  2 October           353.
##  3 November          354.
##  4 August            354.
##  5 January           356.
##  6 December          356.
##  7 July              356.
##  8 February          357.
##  9 March             357.
## 10 May               358.
## 11 June              359.
## 12 April             359.</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>Keeling_Data_tbl <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="st">  </span><span class="kw">select</span>(year,month,co2,quality) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="st">  </span><span class="kw">filter</span>(quality <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb29-4"><a href="#cb29-4"></a><span class="st">  </span><span class="kw">group_by</span>(month) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb29-5"><a href="#cb29-5"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">monthly_mean =</span> <span class="kw">mean</span>(co2)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb29-6"><a href="#cb29-6"></a><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(monthly_mean))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 12 x 2
##    month     monthly_mean
##    &lt;chr&gt;            &lt;dbl&gt;
##  1 April             359.
##  2 June              359.
##  3 May               358.
##  4 March             357.
##  5 February          357.
##  6 July              356.
##  7 December          356.
##  8 January           356.
##  9 August            354.
## 10 November          354.
## 11 October           353.
## 12 September         353.</code></pre>
<p>Let’s add more statistics to the monthly climatology:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>Keeling_Data_tbl <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="st">  </span><span class="kw">select</span>(year,month,co2,quality) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="st">  </span><span class="kw">filter</span>(quality <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-4"><a href="#cb32-4"></a><span class="st">  </span><span class="kw">group_by</span>(month) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-5"><a href="#cb32-5"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">monthly_mean =</span> <span class="kw">mean</span>(co2), <span class="dt">monthly_sd =</span> <span class="kw">sd</span>(co2),</span>
<span id="cb32-6"><a href="#cb32-6"></a>            <span class="dt">monthly_min =</span> <span class="kw">min</span>(co2), <span class="dt">monthly_max =</span> <span class="kw">max</span>(co2),</span>
<span id="cb32-7"><a href="#cb32-7"></a>            <span class="dt">monthly_se =</span> <span class="kw">sd</span>(co2)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">n</span>()))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 12 x 6
##    month     monthly_mean monthly_sd monthly_min monthly_max monthly_se
##    &lt;chr&gt;            &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;
##  1 April             359.       29.4        317.        416.       3.76
##  2 August            354.       29.0        315.        413.       3.66
##  3 December          356.       29.6        315.        414.       3.76
##  4 February          357.       28.8        316.        414.       3.69
##  5 January           356.       29.0        316.        413.       3.68
##  6 July              356.       29.1        316.        414.       3.67
##  7 June              359.       29.0        318.        416.       3.69
##  8 March             357.       29.1        316.        415.       3.69
##  9 May               358.       29.4        318.        417.       3.70
## 10 November          354.       29.4        313.        413.       3.71
## 11 October           353.       29.1        313.        411.       3.69
## 12 September         353.       29.1        313.        411.       3.67</code></pre>
<p>Here we call the <code>n()</code> to get the size of a vector.</p>
</div>
<div id="using-mutate" class="section level2">
<h2>Using <code>mutate()</code></h2>
<p>We can also create new variables (columns) using the <code>mutate()</code> function. Here we create a new column <code>co2_ppb</code> by simply scaling <code>co2</code> by a factor of <code>1000</code>.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>Keeling_Data_tbl <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">co2_ppb =</span> co2 <span class="op">*</span><span class="st"> </span><span class="fl">1e3</span>)</span></code></pre></div>
<pre><code>## # A tibble: 754 x 6
##     year month     decimal_date   co2 quality co2_ppb
##    &lt;int&gt; &lt;chr&gt;            &lt;dbl&gt; &lt;dbl&gt;   &lt;int&gt;   &lt;dbl&gt;
##  1  1958 March            1958.  316.       1  315710
##  2  1958 April            1958.  317.       1  317450
##  3  1958 May              1958.  318.       1  317500
##  4  1958 June             1958. -100.       0  -99990
##  5  1958 July             1959.  316.       1  315860
##  6  1958 August           1959.  315.       1  314930
##  7  1958 September        1959.  313.       1  313200
##  8  1958 October          1959. -100.       0  -99990
##  9  1958 November         1959.  313.       1  313330
## 10  1958 December         1959.  315.       1  314670
## # ... with 744 more rows</code></pre>
<p>When creating new variables, we can hook this with a logical condition. A simple combination of <code>mutate()</code> and <code>ifelse()</code> facilitates filtering right where it is needed: in the moment of creating something new. This easy-to-read statement is a fast and powerful way of discarding certain data or for updating values depending on this given condition.</p>
<p>Let’s create a new variable <code>co2_new</code>, it is equal to <code>co2</code> when <code>quality==1</code>, otherwise it’s <code>NA</code>:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>Keeling_Data_tbl <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">co2_ppb =</span> co2 <span class="op">*</span><span class="st"> </span><span class="fl">1e3</span>, <span class="dt">co2_new =</span> <span class="kw">ifelse</span>(quality<span class="op">==</span><span class="dv">1</span>, co2, <span class="ot">NA</span>))</span></code></pre></div>
<pre><code>## # A tibble: 754 x 7
##     year month     decimal_date   co2 quality co2_ppb co2_new
##    &lt;int&gt; &lt;chr&gt;            &lt;dbl&gt; &lt;dbl&gt;   &lt;int&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1  1958 March            1958.  316.       1  315710    316.
##  2  1958 April            1958.  317.       1  317450    317.
##  3  1958 May              1958.  318.       1  317500    318.
##  4  1958 June             1958. -100.       0  -99990     NA 
##  5  1958 July             1959.  316.       1  315860    316.
##  6  1958 August           1959.  315.       1  314930    315.
##  7  1958 September        1959.  313.       1  313200    313.
##  8  1958 October          1959. -100.       0  -99990     NA 
##  9  1958 November         1959.  313.       1  313330    313.
## 10  1958 December         1959.  315.       1  314670    315.
## # ... with 744 more rows</code></pre>
</div>
<div id="combining-dplyr-and-ggplot2" class="section level2">
<h2>Combining <code>dplyr</code> and <code>ggplot2</code></h2>
<p>Just as we used <code>%&gt;%</code> to pipe data along a chain of <code>dplyr</code> functions we can use it to pass data to <code>ggplot()</code>. Because <code>%&gt;%</code> replaces <strong>the first argument</strong> in a function we don’t need to specify the <code>data = argument</code> in the <code>ggplot()</code> function.</p>
<p>By combining <code>dplyr</code> and <code>ggplot2</code> functions, we can make figures without creating any new variables or modifying the data.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>Keeling_Data_tbl <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">co2_new =</span> <span class="kw">ifelse</span>(quality<span class="op">==</span><span class="dv">1</span>, co2, <span class="ot">NA</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="st">  </span><span class="co"># Make the plot</span></span>
<span id="cb39-4"><a href="#cb39-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>decimal_date, <span class="dt">y=</span>co2_new)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb39-5"><a href="#cb39-5"></a><span class="st">  </span><span class="kw">geom_line</span>()</span></code></pre></div>
<p><img src="S05_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>As you will see, this is much easier than what we have done in <a href="https://zhu-group.github.io/ese335/S02.html#Loading_a_csv_file">Section 1</a>. This is the power of a tidy dataset and its related functions!</p>
<p>Let’s plot CO<sub>2</sub> of the same month as a function of <code>decimal_date</code>, with the <code>color</code> option:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>Keeling_Data_tbl <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">co2_new =</span> <span class="kw">ifelse</span>(quality<span class="op">==</span><span class="dv">1</span>, co2, <span class="ot">NA</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb40-3"><a href="#cb40-3"></a><span class="st">  </span><span class="co"># Make the plot</span></span>
<span id="cb40-4"><a href="#cb40-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>decimal_date, <span class="dt">y=</span>co2_new, <span class="dt">color=</span>month)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb40-5"><a href="#cb40-5"></a><span class="st">  </span><span class="kw">geom_line</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 2 row(s) containing missing values (geom_path).</code></pre>
<p><img src="S05_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Or plot the same data but in panels (facets), with the <code>facet_wrap</code> function:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>Keeling_Data_tbl <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">co2_new =</span> <span class="kw">ifelse</span>(quality<span class="op">==</span><span class="dv">1</span>, co2, <span class="ot">NA</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb42-3"><a href="#cb42-3"></a><span class="st">  </span><span class="co"># Make the plot</span></span>
<span id="cb42-4"><a href="#cb42-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>decimal_date, <span class="dt">y=</span>co2_new, <span class="dt">color=</span>month)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb42-5"><a href="#cb42-5"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb42-6"><a href="#cb42-6"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>month)</span></code></pre></div>
<pre><code>## Warning: Removed 2 row(s) containing missing values (geom_path).</code></pre>
<p><img src="S05_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>OK, that is enough for data wrangling We will learn more about <code>ggplot2</code> in future sections.</p>
<hr />
</div>
</div>
<div id="quick-plots" class="section level1">
<h1>Quick plots</h1>
<p>Now think about what will you do when get a new dataset before analyzing it?</p>
<p>Normally, we would like to do two things - to take a quick look at the statics and to plot the patterns.</p>
<p>R has many built-in functions for a large number of summary statistics. For example, <code>mean()</code>, <code>median()</code>, <code>range()</code>, <code>max()</code>, <code>min()</code>, <code>sd()</code>, <code>var()</code>, <code>IQR()</code>, and <code>summary()</code>. We have used some of those functions in <a href="https://zhu-group.github.io/ese335/S02.html">Section 02</a>. Make sure you understand how to use them and always pay attentions to <code>NA</code> values.</p>
<p>Our next task is to visualize the data. Often, a proper visualization can illuminate features of the data that can inform further analysis. We will learn three basic types of plots in this section.</p>
<div id="histograms" class="section level2">
<h2>Histograms</h2>
<p>When visualizing a single numerical variable, a histogram will be our go-to tool, which can be created in R using the <code>hist()</code> function.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="co"># Add a new column to the original tibble</span></span>
<span id="cb44-2"><a href="#cb44-2"></a>Keeling_Data_tbl &lt;-<span class="st"> </span>Keeling_Data_tbl <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb44-3"><a href="#cb44-3"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">co2_new =</span> <span class="kw">ifelse</span>(quality<span class="op">==</span><span class="dv">1</span>, co2, <span class="ot">NA</span>))</span>
<span id="cb44-4"><a href="#cb44-4"></a></span>
<span id="cb44-5"><a href="#cb44-5"></a><span class="co"># Notice we use pull() to get a vector from a tibble</span></span>
<span id="cb44-6"><a href="#cb44-6"></a>Month_CO2 &lt;-<span class="st"> </span>Keeling_Data_tbl <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb44-7"><a href="#cb44-7"></a><span class="st">  </span><span class="kw">pull</span>(co2_new)</span>
<span id="cb44-8"><a href="#cb44-8"></a></span>
<span id="cb44-9"><a href="#cb44-9"></a><span class="co"># plot hist</span></span>
<span id="cb44-10"><a href="#cb44-10"></a><span class="kw">hist</span>(Month_CO2)</span></code></pre></div>
<p><img src="S05_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>The histogram function has a number of parameters which can be changed to make our plot look much nicer. Use the <code>?</code> operator to read the documentation for the <code>hist()</code> to see a full list of these parameters.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="kw">hist</span>(Month_CO2,</span>
<span id="cb45-2"><a href="#cb45-2"></a>     <span class="dt">xlab =</span> <span class="st">&quot;Monthly CO2 mixing ratios (ppm)&quot;</span>,</span>
<span id="cb45-3"><a href="#cb45-3"></a>     <span class="dt">main =</span> <span class="st">&quot;Histogram of Monthly CO2&quot;</span>,</span>
<span id="cb45-4"><a href="#cb45-4"></a>     <span class="dt">breaks =</span> <span class="dv">20</span>,</span>
<span id="cb45-5"><a href="#cb45-5"></a>     <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb45-6"><a href="#cb45-6"></a>     <span class="dt">border =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb45-7"><a href="#cb45-7"></a><span class="kw">box</span>(<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</span></code></pre></div>
<p><img src="S05_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>By default R will attempt to intelligently guess a good number of <code>breaks</code>, but as we can see here, it is sometimes useful to modify this yourself.</p>
</div>
<div id="boxplots" class="section level2">
<h2>Boxplots</h2>
<p>To visualize the relationship between a numerical and categorical variable, we will use a <code>boxplot</code>. A boxplot is usful in checking the center, spread, and skewness of a sample.</p>
<p>In the <code>Keeling_Data_tbl</code> dataset, the <code>month</code> is a categorical variable. First, note that we can use a single boxplot as an alternative to a histogram for visualizing a single numerical variable. To do so in R, we use the <code>boxplot()</code> function.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="kw">boxplot</span>(Month_CO2)</span></code></pre></div>
<p><img src="S05_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>Or try to plot the raw data:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="kw">boxplot</span>(Keeling_Data<span class="op">$</span>co2)</span></code></pre></div>
<p><img src="S05_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>However, more often, we will use boxplots to compare a numerical variable for different values of a categorical variable.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="kw">boxplot</span>(co2_new <span class="op">~</span><span class="st"> </span>month, <span class="dt">data=</span>Keeling_Data_tbl)</span></code></pre></div>
<p><img src="S05_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>Here we used the <code>boxplot()</code> command to create side-by-side boxplots. However, since we are now dealing with two variables, the syntax has changed. The R syntax <code>co2_new ~ month, data = Keeling_Data_tbl</code> reads “Plot the <code>co2_new</code> variable against the <code>month</code> variable using the <code>Keeling_Data_tbl</code> dataset.” We see the use of a <code>~</code> (which specifies a formula) and also a <code>data = argument</code>. This will be a syntax that is common to many functions we will use later.</p>
<p>Again, <code>boxplot()</code> has a number of additional arguments which have the ability to make our plot more visually appealing.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="kw">boxplot</span>(co2_new <span class="op">~</span><span class="st"> </span>month, <span class="dt">data=</span>Keeling_Data_tbl,</span>
<span id="cb49-2"><a href="#cb49-2"></a><span class="dt">xlab =</span> <span class="st">&quot;Month&quot;</span>,</span>
<span id="cb49-3"><a href="#cb49-3"></a><span class="dt">ylab =</span> <span class="st">&quot;CO2 (ppm)&quot;</span>,</span>
<span id="cb49-4"><a href="#cb49-4"></a><span class="dt">main =</span> <span class="st">&quot;Monthly CO2&quot;</span>,</span>
<span id="cb49-5"><a href="#cb49-5"></a><span class="dt">cex =</span> <span class="dv">2</span>,</span>
<span id="cb49-6"><a href="#cb49-6"></a><span class="dt">col =</span> <span class="st">&quot;orange&quot;</span>,</span>
<span id="cb49-7"><a href="#cb49-7"></a><span class="dt">border =</span> <span class="st">&quot;darkgreen&quot;</span>)</span></code></pre></div>
<p><img src="S05_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
</div>
<div id="scatterplots" class="section level2">
<h2>Scatterplots</h2>
<p>Lastly, to visualize the relationship between two numeric variables, we will use a scatterplot. This can be done with the <code>plot()</code> function and the <code>~</code> syntax we just used with a boxplot. (The function <code>plot()</code> can also be used more generally; see the documentation for details.)</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="kw">plot</span>(co2_new <span class="op">~</span><span class="st"> </span>year, <span class="dt">data=</span>Keeling_Data_tbl)</span></code></pre></div>
<p><img src="S05_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="kw">plot</span>(co2_new <span class="op">~</span><span class="st"> </span>year, <span class="dt">data=</span>Keeling_Data_tbl,</span>
<span id="cb51-2"><a href="#cb51-2"></a><span class="dt">xlab =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb51-3"><a href="#cb51-3"></a><span class="dt">ylab =</span> <span class="st">&quot;CO2 (ppm)&quot;</span>,</span>
<span id="cb51-4"><a href="#cb51-4"></a><span class="dt">main =</span> <span class="st">&quot;CO2 vs Year&quot;</span>,</span>
<span id="cb51-5"><a href="#cb51-5"></a><span class="dt">pch =</span> <span class="st">&quot;+&quot;</span>,</span>
<span id="cb51-6"><a href="#cb51-6"></a><span class="dt">cex =</span> <span class="dv">2</span>,</span>
<span id="cb51-7"><a href="#cb51-7"></a><span class="dt">col =</span> <span class="st">&quot;navy&quot;</span>)</span></code></pre></div>
<p><img src="S05_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<hr />
</div>
</div>
<div id="in-class-exercises" class="section level1">
<h1>In-class exercises</h1>
<div id="exercise-1" class="section level2">
<h2>Exercise #1</h2>
<p>Give the following observations:</p>
<p><code>1, 1, 6, 13, 13, 14, 14, 14, 16, 17, 18, 18, 19, 19, 20, 21, 22</code>.</p>
<p>Make a boxplot with R. What is the IQR? Can you explain why <code>1</code> is marked as outliers?</p>
</div>
<div id="exercise-2" class="section level2">
<h2>Exercise #2</h2>
<p>Use <code>Keeling_Data</code>, compute the annual mean of CO<sub>2</sub> since 1959, plot your results.</p>
<hr />
</div>
</div>
<div id="further-reading" class="section level1">
<h1>Further reading</h1>
<ul>
<li><a href="https://rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf">Data Wrangling with dplyr and tidyr Cheat Sheet</a></li>
<li><a href="http://swcarpentry.github.io/r-novice-gapminder/13-dplyr/index.html">Dataframe Manipulation with dplyr</a></li>
<li><a href="http://swcarpentry.github.io/r-novice-gapminder/14-tidyr/index.html">Dataframe Manipulation with tidyr</a></li>
<li><a href="https://r4ds.had.co.nz/">R for Data Science</a>, see chapter 10 and 12.</li>
<li><a href="https://rstudio.com/resources/webinars/data-wrangling-with-r-and-rstudio/">Data wrangling with R</a>, with a video</li>
</ul>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = false;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
